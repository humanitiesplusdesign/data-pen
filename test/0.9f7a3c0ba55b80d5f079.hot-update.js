webpackHotUpdate(0,{

/***/ "./app/components/construct-view/palette-component/palette-component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3__ = __webpack_require__(\"./app/bower_components/d3/d3.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_d3__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__models_rdf__ = __webpack_require__(\"./app/models/rdf.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_angular__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_angular___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_angular__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__actions_types__ = __webpack_require__(\"./app/actions/types.ts\");\n/* unused harmony export PaletteComponentController */\n/* unused harmony export PaletteComponent */\n\n\n\n\n\n\nvar PaletteComponentController = function () {\n    function PaletteComponentController(fibraService, $element, sparqlItemService, sparqlTreeService, $q, $ngRedux, FileSaver) {\n        this.fibraService = fibraService;\n        this.$element = $element;\n        this.sparqlItemService = sparqlItemService;\n        this.sparqlTreeService = sparqlTreeService;\n        this.$q = $q;\n        this.$ngRedux = $ngRedux;\n        this.FileSaver = FileSaver;\n        this.paletteSearchHeight = 40;\n        this.typeColorScale = __WEBPACK_IMPORTED_MODULE_0_d3__[\"scaleOrdinal\"](__WEBPACK_IMPORTED_MODULE_0_d3__[\"schemeCategory20c\"]);\n        this.labelFilter = '';\n        this.typeItemTree = __WEBPACK_IMPORTED_MODULE_0_d3__[\"map\"]();\n        this.unsubscribe = $ngRedux.connect(this.mapStateToThis, __WEBPACK_IMPORTED_MODULE_3__actions_types__)(this);\n        this.typeItemTree.set('', {\n            label: 'No type defined',\n            items: [],\n            expanded: false\n        });\n        this.query();\n    }\n    PaletteComponentController.prototype.$onDestroy = function () {\n        this.unsubscribe();\n    };\n    PaletteComponentController.prototype.query = function () {\n        var _this = this;\n        return this.typeItemTreePromise = this.sparqlItemService.getAllItems().then(function (items) {\n            return _this.mergeItems(_this.items, items);\n        });\n    };\n    PaletteComponentController.prototype.$postLink = function () {\n        var _this = this;\n        this.divSel = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"](this.$element[0]).select('div.palette');\n        this.nodeDrag = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"](this.$element[0]).select('.palette-node-drag');\n        this.nodeDrag.style('display', 'none');\n        this.nodeDrag.append('circle');\n        this.divSel.style('height', '100%').style('width', '100%');\n        this.tooltip = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"]('body').append('div').style('position', 'absolute').style('z-index', '20').style('background-color', 'gray').style('color', 'white').style('padding', '3px').style('border-radius', '2px').style('visibility', 'hidden');\n        var onChangeFunction = function () {\n            return _this.query().then(_this.build.bind(_this)).then(function () {\n                return 'Done';\n            });\n        };\n        this.fibraService.on('change', onChangeFunction);\n        this.typeItemTreePromise.then(function (itemTree) {\n            _this.build.bind(_this)(itemTree);\n        });\n    };\n    PaletteComponentController.prototype.addItem = function (item, coordinates) {\n        var _this = this;\n        var itemTypeKey = item.typeValue;\n        var itemType = this.types.types.filter(function (t) {\n            return t.id === itemTypeKey;\n        })[0];\n        var chosenTypes = this.types.displayTypes;\n        if (!chosenTypes[0] && itemType) {\n            this.setOrderedTypes([itemType]);\n        } else if (!chosenTypes[1] && itemType && chosenTypes[0] !== itemType) {\n            var newTypes = chosenTypes.concat([]);\n            newTypes.push(itemType);\n            this.setOrderedTypes(newTypes);\n        }\n        return this.fibraService.dispatchAction(this.fibraService.displayItem(item, coordinates)).then(function (state) {\n            _this.fibraService.dispatch('change');\n            return state;\n        });\n    };\n    PaletteComponentController.prototype.createItemLocal = function (label) {\n        var _this = this;\n        var node = __WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"b\" /* DataFactory */].instance.namedNode(label);\n        this.fibraService.dispatchAction(this.fibraService.createItem(node)).then(function () {\n            _this.query().then(function (items) {\n                _this.build.bind(_this)(items);\n            });\n        });\n    };\n    PaletteComponentController.prototype.downloadCSV = function (datum) {\n        var blob = new Blob([__WEBPACK_IMPORTED_MODULE_0_d3__[\"csvFormat\"](datum.value.items.map(function (d) {\n            var sameAs = d.localProperties.filter(function (p) {\n                return p.value === __WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"d\" /* OWL */].sameAs.value;\n            })[0];\n            var prefLabel = d.localProperties.filter(function (p) {\n                return p.value === __WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"a\" /* SKOS */].prefLabel.value;\n            })[0];\n            return _a = {}, _a[__WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"a\" /* SKOS */].prefLabel.value] = prefLabel ? prefLabel.values[0].value.value : '', _a.FibraId = d.value, _a.Match = sameAs ? sameAs.values[0].value.value : '', _a;\n            var _a;\n        }), [__WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"a\" /* SKOS */].prefLabel.value, 'FibraId', 'Match'])], { type: 'application/csv;charset=utf-8' });\n        var filename = datum.value.label + '.csv';\n        this.FileSaver.saveAs(blob, filename);\n    };\n    PaletteComponentController.prototype.build = function (itemTree) {\n        var _this = this;\n        this.updateSizing();\n        console.log(itemTree.entries());\n        var itemTreeFiltered = itemTree.entries().filter(function (d) {\n            return d.key !== '';\n        });\n        var items = itemTreeFiltered.reduce(function (a, b) {\n            return a.concat(b.value.items);\n        }, []);\n        var padding = items.length > 300 ? items.length > 2000 ? 1 : 2 : 4;\n        var paletteHeightLessTypes = this.paletteHeight - itemTreeFiltered.length * 25;\n        var rawRadius = (Math.sqrt(this.paletteWidth * paletteHeightLessTypes / items.length) - padding) / 2;\n        var radius = rawRadius > 8 ? 8 : rawRadius;\n        var xOffset = radius * 2 + padding / 2;\n        var yOffset = radius * 2 + padding / 2;\n        var xDots = Math.floor(this.paletteWidth / xOffset) - 1;\n        // Bring the node drag SVG and the addItem function local\n        var nodeDrag = this.nodeDrag;\n        var addItem = this.addItem.bind(this);\n        var paletteWidth = this.paletteWidth;\n        this.typesD3 = this.divSel.selectAll('div.type').data(itemTreeFiltered, function (d) {\n            return d.key;\n        });\n        this.typesD3.exit().remove();\n        var typesDivsEnter = this.typesD3.enter().append('div').classed('type', true).classed('inverse-icon', true).text(function (d) {\n            return d.value.label;\n        });\n        typesDivsEnter.append('span').classed('glyphicon', true).classed('glyphicon-download', true).on('click', function (d) {\n            return _this.downloadCSV(d);\n        });\n        typesDivsEnter.append('span').classed('glyphicon', true).classed('expand-button', true).on('click', function (d) {\n            d.value.expanded = !d.value.expanded;\n            _this.typeItemTreePromise.then(_this.build.bind(_this));\n        });\n        typesDivsEnter.append('svg').attr('width', '100%');\n        this.typesD3 = typesDivsEnter.merge(this.typesD3);\n        this.typesD3.selectAll('.expand-button').classed('glyphicon-resize-small', function (d) {\n            return d.value.expanded;\n        }).classed('glyphicon-resize-full', function (d) {\n            return !d.value.expanded;\n        });\n        this.typesD3.selectAll('svg').style('display', function (d) {\n            return d.value.expanded ? 'block' : 'none';\n        });\n        var typeSvgs = this.typesD3.select('svg').attr('height', function (d) {\n            return (Math.ceil(d.value.items.length / xDots) + 1) * yOffset;\n        });\n        this.circles = typeSvgs.selectAll('circle.item').data(function (d) {\n            return d.value.items;\n        }, function (d) {\n            return d.value;\n        });\n        this.circles.exit().remove();\n        this.circles = this.circles.enter().append('circle').classed('item', true).attr('r', radius).on('mouseover', function (d, i) {\n            _this.tooltip.style('top', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].pageY - 10 + 'px').style('left', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].pageX + 10 + 'px').style('visibility', 'visible').text(d.label + ' (' + d.typeLabel + ')');\n        }).on('mouseout', function (d, i) {\n            _this.tooltip.style('visibility', 'hidden');\n        }).call(__WEBPACK_IMPORTED_MODULE_0_d3__[\"drag\"]().on('start', function (d) {\n            var thisCircle = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"](this);\n            nodeDrag.style('display', 'block');\n            nodeDrag.select('circle').classed('item', thisCircle.classed('item')).attr('r', thisCircle.attr('r')).attr('fill', thisCircle.attr('fill')).attr('transform', 'translate(8,8)');\n            nodeDrag.style('left', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientX - 8).style('top', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientY - 8);\n        }).on('drag', function (d) {\n            nodeDrag.style('left', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientX - 8).style('top', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientY - 8);\n        }).on('end', function (d) {\n            // If the cursor is on the canvas, display\n            var exploreContainer = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"]('#explorecontainer').node();\n            if (__WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientX > exploreContainer.getBoundingClientRect().left && __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientX < exploreContainer.getBoundingClientRect().right && __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientY > exploreContainer.getBoundingClientRect().top && __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientY < exploreContainer.getBoundingClientRect().bottom) {\n                addItem(__WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"](this).datum(), [__WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientX - exploreContainer.getBoundingClientRect().left, __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientY - exploreContainer.getBoundingClientRect().top]).then(function () {\n                    nodeDrag.style('display', 'none');\n                });\n            } else {\n                nodeDrag.style('display', 'none');\n            }\n        })).merge(this.circles).call(this.update.bind(this));\n        this.circles.transition().attr('fill', function (d) {\n            return _this.typeColorScale(d.typeValue);\n        }).attr('transform', function (d, i) {\n            return 'translate(' + (i % xDots + 1) * xOffset + ',' + (Math.floor(i / xDots) + 1) * yOffset + ')';\n        });\n    };\n    PaletteComponentController.prototype.update = function (circles) {\n        var _this = this;\n        var c = circles ? circles : this.circles;\n        c.classed('displayed', function (d) {\n            return _this.fibraService.getState().construct.itemIndex[d.value] ? true : false;\n        }).classed('filtered', function (d) {\n            return _this.labelFilter && !(d.label.toUpperCase().indexOf(_this.labelFilter.toUpperCase()) !== -1);\n        });\n    };\n    PaletteComponentController.prototype.mapStateToThis = function (state) {\n        return {\n            types: state.types\n        };\n    };\n    PaletteComponentController.prototype.updateSizing = function () {\n        this.paletteWidth = Math.round(window.innerWidth * 0.15); // this.svgSel.node().clientWidth\n        this.paletteHeight = Math.round(window.innerHeight) - this.paletteSearchHeight;\n        this.divSel.style('height', this.paletteHeight + 'px');\n    };\n    PaletteComponentController.prototype.mergeItems = function (oldItems, newItems) {\n        var _this = this;\n        // Wipe old items (bad, but temporary)\n        this.typeItemTree.values().forEach(function (v) {\n            v.items = [];\n        });\n        newItems.forEach(function (item) {\n            var typeProp = item.localProperties.filter(function (p) {\n                return p.value === __WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"c\" /* RDF */].type.value;\n            })[0];\n            if (typeProp && typeProp.values[0]) {\n                item.typeValue = typeProp.values[0].value.value;\n                item.typeLabel = typeProp.values[0].value.label;\n                // Add type to the type map\n                if (!_this.typeItemTree.has(item.typeValue)) {\n                    _this.typeItemTree.set(item.typeValue, {\n                        label: item.typeLabel,\n                        items: [item],\n                        expanded: true\n                    });\n                } else {\n                    _this.typeItemTree.get(item.typeValue).items.push(item);\n                }\n            } else {\n                item.typeValue = '';\n                item.typeLabel = 'No type defined';\n            }\n        });\n        // Sort by label\n        this.typeItemTree.values().forEach(function (v) {\n            v.items.sort(function (a, b) {\n                return a.label === b.label ? 0 : a.label > b.label ? 1 : -1;\n            });\n        });\n        return this.typeItemTree;\n    };\n    return PaletteComponentController;\n}();\n\nvar PaletteComponent = function () {\n    function PaletteComponent() {\n        this.template = __webpack_require__(\"./app/components/construct-view/palette-component/palette-component.pug\")();\n        this.controller = PaletteComponentController;\n    }\n    return PaletteComponent;\n}();\n\n__WEBPACK_IMPORTED_MODULE_2_angular__[\"module\"]('fibra.components.palette', ['fibra.services']).component('palette', new PaletteComponent());//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvY29tcG9uZW50cy9jb25zdHJ1Y3Qtdmlldy9wYWxldHRlLWNvbXBvbmVudC9wYWxldHRlLWNvbXBvbmVudC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hcHAvY29tcG9uZW50cy9jb25zdHJ1Y3Qtdmlldy9wYWxldHRlLWNvbXBvbmVudC9wYWxldHRlLWNvbXBvbmVudC50cz83M2FiIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmltcG9ydCAqIGFzIGQzIGZyb20gJ2QzJztcbmltcG9ydCB7IERhdGFGYWN0b3J5LCBTS09TLCBPV0wsIFJERiB9IGZyb20gJy4uLy4uLy4uL21vZGVscy9yZGYnO1xuaW1wb3J0ICogYXMgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCAqIGFzIFR5cGVBY3Rpb25zIGZyb20gJy4uLy4uLy4uL2FjdGlvbnMvdHlwZXMnO1xudmFyIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQYWxldHRlQ29tcG9uZW50Q29udHJvbGxlcihmaWJyYVNlcnZpY2UsICRlbGVtZW50LCBzcGFycWxJdGVtU2VydmljZSwgc3BhcnFsVHJlZVNlcnZpY2UsICRxLCAkbmdSZWR1eCwgRmlsZVNhdmVyKSB7XG4gICAgICAgIHRoaXMuZmlicmFTZXJ2aWNlID0gZmlicmFTZXJ2aWNlO1xuICAgICAgICB0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuc3BhcnFsSXRlbVNlcnZpY2UgPSBzcGFycWxJdGVtU2VydmljZTtcbiAgICAgICAgdGhpcy5zcGFycWxUcmVlU2VydmljZSA9IHNwYXJxbFRyZWVTZXJ2aWNlO1xuICAgICAgICB0aGlzLiRxID0gJHE7XG4gICAgICAgIHRoaXMuJG5nUmVkdXggPSAkbmdSZWR1eDtcbiAgICAgICAgdGhpcy5GaWxlU2F2ZXIgPSBGaWxlU2F2ZXI7XG4gICAgICAgIHRoaXMucGFsZXR0ZVNlYXJjaEhlaWdodCA9IDQwO1xuICAgICAgICB0aGlzLnR5cGVDb2xvclNjYWxlID0gZDMuc2NhbGVPcmRpbmFsKGQzLnNjaGVtZUNhdGVnb3J5MjBjKTtcbiAgICAgICAgdGhpcy5sYWJlbEZpbHRlciA9ICcnO1xuICAgICAgICB0aGlzLnR5cGVJdGVtVHJlZSA9IGQzLm1hcCgpO1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlID0gJG5nUmVkdXguY29ubmVjdCh0aGlzLm1hcFN0YXRlVG9UaGlzLCBUeXBlQWN0aW9ucykodGhpcyk7XG4gICAgICAgIHRoaXMudHlwZUl0ZW1UcmVlLnNldCgnJywge1xuICAgICAgICAgICAgbGFiZWw6ICdObyB0eXBlIGRlZmluZWQnLFxuICAgICAgICAgICAgaXRlbXM6IFtdLFxuICAgICAgICAgICAgZXhwYW5kZWQ6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnF1ZXJ5KCk7XG4gICAgfVxuICAgIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS4kb25EZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgfTtcbiAgICBQYWxldHRlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUucXVlcnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLnR5cGVJdGVtVHJlZVByb21pc2UgPSB0aGlzLnNwYXJxbEl0ZW1TZXJ2aWNlLmdldEFsbEl0ZW1zKCkudGhlbihmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tZXJnZUl0ZW1zKF90aGlzLml0ZW1zLCBpdGVtcyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLiRwb3N0TGluayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5kaXZTZWwgPSBkMy5zZWxlY3QodGhpcy4kZWxlbWVudFswXSkuc2VsZWN0KCdkaXYucGFsZXR0ZScpO1xuICAgICAgICB0aGlzLm5vZGVEcmFnID0gZDMuc2VsZWN0KHRoaXMuJGVsZW1lbnRbMF0pLnNlbGVjdCgnLnBhbGV0dGUtbm9kZS1kcmFnJyk7XG4gICAgICAgIHRoaXMubm9kZURyYWcuc3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICB0aGlzLm5vZGVEcmFnLmFwcGVuZCgnY2lyY2xlJyk7XG4gICAgICAgIHRoaXMuZGl2U2VsXG4gICAgICAgICAgICAuc3R5bGUoJ2hlaWdodCcsICcxMDAlJylcbiAgICAgICAgICAgIC5zdHlsZSgnd2lkdGgnLCAnMTAwJScpO1xuICAgICAgICB0aGlzLnRvb2x0aXAgPSBkMy5zZWxlY3QoJ2JvZHknKS5hcHBlbmQoJ2RpdicpXG4gICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2Fic29sdXRlJylcbiAgICAgICAgICAgIC5zdHlsZSgnei1pbmRleCcsICcyMCcpXG4gICAgICAgICAgICAuc3R5bGUoJ2JhY2tncm91bmQtY29sb3InLCAnZ3JheScpXG4gICAgICAgICAgICAuc3R5bGUoJ2NvbG9yJywgJ3doaXRlJylcbiAgICAgICAgICAgIC5zdHlsZSgncGFkZGluZycsICczcHgnKVxuICAgICAgICAgICAgLnN0eWxlKCdib3JkZXItcmFkaXVzJywgJzJweCcpXG4gICAgICAgICAgICAuc3R5bGUoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG4gICAgICAgIHZhciBvbkNoYW5nZUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnF1ZXJ5KCkudGhlbihfdGhpcy5idWlsZC5iaW5kKF90aGlzKSkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiAnRG9uZSc7IH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmZpYnJhU2VydmljZS5vbignY2hhbmdlJywgb25DaGFuZ2VGdW5jdGlvbik7XG4gICAgICAgIHRoaXMudHlwZUl0ZW1UcmVlUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChpdGVtVHJlZSkge1xuICAgICAgICAgICAgX3RoaXMuYnVpbGQuYmluZChfdGhpcykoaXRlbVRyZWUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS5hZGRJdGVtID0gZnVuY3Rpb24gKGl0ZW0sIGNvb3JkaW5hdGVzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBpdGVtVHlwZUtleSA9IGl0ZW0udHlwZVZhbHVlO1xuICAgICAgICB2YXIgaXRlbVR5cGUgPSB0aGlzLnR5cGVzLnR5cGVzLmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gdC5pZCA9PT0gaXRlbVR5cGVLZXk7IH0pWzBdO1xuICAgICAgICB2YXIgY2hvc2VuVHlwZXMgPSB0aGlzLnR5cGVzLmRpc3BsYXlUeXBlcztcbiAgICAgICAgaWYgKCFjaG9zZW5UeXBlc1swXSAmJiBpdGVtVHlwZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRPcmRlcmVkVHlwZXMoW2l0ZW1UeXBlXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWNob3NlblR5cGVzWzFdICYmIGl0ZW1UeXBlICYmIChjaG9zZW5UeXBlc1swXSAhPT0gaXRlbVR5cGUpKSB7XG4gICAgICAgICAgICB2YXIgbmV3VHlwZXMgPSBjaG9zZW5UeXBlcy5jb25jYXQoW10pO1xuICAgICAgICAgICAgbmV3VHlwZXMucHVzaChpdGVtVHlwZSk7XG4gICAgICAgICAgICB0aGlzLnNldE9yZGVyZWRUeXBlcyhuZXdUeXBlcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZmlicmFTZXJ2aWNlLmRpc3BhdGNoQWN0aW9uKHRoaXMuZmlicmFTZXJ2aWNlLmRpc3BsYXlJdGVtKGl0ZW0sIGNvb3JkaW5hdGVzKSkudGhlbihmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgICAgIF90aGlzLmZpYnJhU2VydmljZS5kaXNwYXRjaCgnY2hhbmdlJyk7XG4gICAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLmNyZWF0ZUl0ZW1Mb2NhbCA9IGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgbm9kZSA9IERhdGFGYWN0b3J5Lmluc3RhbmNlLm5hbWVkTm9kZShsYWJlbCk7XG4gICAgICAgIHRoaXMuZmlicmFTZXJ2aWNlLmRpc3BhdGNoQWN0aW9uKHRoaXMuZmlicmFTZXJ2aWNlLmNyZWF0ZUl0ZW0obm9kZSkpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMucXVlcnkoKS50aGVuKGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICAgICAgICAgIF90aGlzLmJ1aWxkLmJpbmQoX3RoaXMpKGl0ZW1zKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS5kb3dubG9hZENTViA9IGZ1bmN0aW9uIChkYXR1bSkge1xuICAgICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtkMy5jc3ZGb3JtYXQoZGF0dW0udmFsdWUuaXRlbXMubWFwKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNhbWVBcyA9IGQubG9jYWxQcm9wZXJ0aWVzLmZpbHRlcihmdW5jdGlvbiAocCkgeyByZXR1cm4gcC52YWx1ZSA9PT0gT1dMLnNhbWVBcy52YWx1ZTsgfSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHByZWZMYWJlbCA9IGQubG9jYWxQcm9wZXJ0aWVzLmZpbHRlcihmdW5jdGlvbiAocCkgeyByZXR1cm4gcC52YWx1ZSA9PT0gU0tPUy5wcmVmTGFiZWwudmFsdWU7IH0pWzBdO1xuICAgICAgICAgICAgICAgIHJldHVybiBfYSA9IHt9LFxuICAgICAgICAgICAgICAgICAgICBfYVtTS09TLnByZWZMYWJlbC52YWx1ZV0gPSBwcmVmTGFiZWwgPyBwcmVmTGFiZWwudmFsdWVzWzBdLnZhbHVlLnZhbHVlIDogJycsXG4gICAgICAgICAgICAgICAgICAgIF9hLkZpYnJhSWQgPSBkLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBfYS5NYXRjaCA9IHNhbWVBcyA/IHNhbWVBcy52YWx1ZXNbMF0udmFsdWUudmFsdWUgOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgX2E7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgfSksIFtTS09TLnByZWZMYWJlbC52YWx1ZSwgJ0ZpYnJhSWQnLCAnTWF0Y2gnXSldLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9jc3Y7Y2hhcnNldD11dGYtOCcgfSk7XG4gICAgICAgIHZhciBmaWxlbmFtZSA9IGRhdHVtLnZhbHVlLmxhYmVsICsgJy5jc3YnO1xuICAgICAgICB0aGlzLkZpbGVTYXZlci5zYXZlQXMoYmxvYiwgZmlsZW5hbWUpO1xuICAgIH07XG4gICAgUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLmJ1aWxkID0gZnVuY3Rpb24gKGl0ZW1UcmVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMudXBkYXRlU2l6aW5nKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGl0ZW1UcmVlLmVudHJpZXMoKSk7XG4gICAgICAgIHZhciBpdGVtVHJlZUZpbHRlcmVkID0gaXRlbVRyZWUuZW50cmllcygpLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5rZXkgIT09ICcnOyB9KTtcbiAgICAgICAgdmFyIGl0ZW1zID0gaXRlbVRyZWVGaWx0ZXJlZC5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiBhLmNvbmNhdChiLnZhbHVlLml0ZW1zKTtcbiAgICAgICAgfSwgW10pO1xuICAgICAgICB2YXIgcGFkZGluZyA9IGl0ZW1zLmxlbmd0aCA+IDMwMCA/IGl0ZW1zLmxlbmd0aCA+IDIwMDAgPyAxIDogMiA6IDQ7XG4gICAgICAgIHZhciBwYWxldHRlSGVpZ2h0TGVzc1R5cGVzID0gdGhpcy5wYWxldHRlSGVpZ2h0IC0gKGl0ZW1UcmVlRmlsdGVyZWQubGVuZ3RoICogMjUpO1xuICAgICAgICB2YXIgcmF3UmFkaXVzID0gKE1hdGguc3FydCh0aGlzLnBhbGV0dGVXaWR0aCAqIHBhbGV0dGVIZWlnaHRMZXNzVHlwZXMgLyBpdGVtcy5sZW5ndGgpIC0gcGFkZGluZykgLyAyO1xuICAgICAgICB2YXIgcmFkaXVzID0gcmF3UmFkaXVzID4gOCA/IDggOiByYXdSYWRpdXM7XG4gICAgICAgIHZhciB4T2Zmc2V0ID0gcmFkaXVzICogMiArIHBhZGRpbmcgLyAyO1xuICAgICAgICB2YXIgeU9mZnNldCA9IHJhZGl1cyAqIDIgKyBwYWRkaW5nIC8gMjtcbiAgICAgICAgdmFyIHhEb3RzID0gTWF0aC5mbG9vcigodGhpcy5wYWxldHRlV2lkdGgpIC8geE9mZnNldCkgLSAxO1xuICAgICAgICAvLyBCcmluZyB0aGUgbm9kZSBkcmFnIFNWRyBhbmQgdGhlIGFkZEl0ZW0gZnVuY3Rpb24gbG9jYWxcbiAgICAgICAgdmFyIG5vZGVEcmFnID0gdGhpcy5ub2RlRHJhZztcbiAgICAgICAgdmFyIGFkZEl0ZW0gPSB0aGlzLmFkZEl0ZW0uYmluZCh0aGlzKTtcbiAgICAgICAgdmFyIHBhbGV0dGVXaWR0aCA9IHRoaXMucGFsZXR0ZVdpZHRoO1xuICAgICAgICB0aGlzLnR5cGVzRDMgPSB0aGlzLmRpdlNlbFxuICAgICAgICAgICAgLnNlbGVjdEFsbCgnZGl2LnR5cGUnKVxuICAgICAgICAgICAgLmRhdGEoaXRlbVRyZWVGaWx0ZXJlZCwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQua2V5OyB9KTtcbiAgICAgICAgdGhpcy50eXBlc0QzLmV4aXQoKS5yZW1vdmUoKTtcbiAgICAgICAgdmFyIHR5cGVzRGl2c0VudGVyID0gdGhpcy50eXBlc0QzLmVudGVyKClcbiAgICAgICAgICAgIC5hcHBlbmQoJ2RpdicpXG4gICAgICAgICAgICAuY2xhc3NlZCgndHlwZScsIHRydWUpXG4gICAgICAgICAgICAuY2xhc3NlZCgnaW52ZXJzZS1pY29uJywgdHJ1ZSlcbiAgICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLnZhbHVlLmxhYmVsOyB9KTtcbiAgICAgICAgdHlwZXNEaXZzRW50ZXJcbiAgICAgICAgICAgIC5hcHBlbmQoJ3NwYW4nKVxuICAgICAgICAgICAgLmNsYXNzZWQoJ2dseXBoaWNvbicsIHRydWUpXG4gICAgICAgICAgICAuY2xhc3NlZCgnZ2x5cGhpY29uLWRvd25sb2FkJywgdHJ1ZSlcbiAgICAgICAgICAgIC5vbignY2xpY2snLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gX3RoaXMuZG93bmxvYWRDU1YoZCk7IH0pO1xuICAgICAgICB0eXBlc0RpdnNFbnRlclxuICAgICAgICAgICAgLmFwcGVuZCgnc3BhbicpXG4gICAgICAgICAgICAuY2xhc3NlZCgnZ2x5cGhpY29uJywgdHJ1ZSlcbiAgICAgICAgICAgIC5jbGFzc2VkKCdleHBhbmQtYnV0dG9uJywgdHJ1ZSlcbiAgICAgICAgICAgIC5vbignY2xpY2snLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgZC52YWx1ZS5leHBhbmRlZCA9ICFkLnZhbHVlLmV4cGFuZGVkO1xuICAgICAgICAgICAgX3RoaXMudHlwZUl0ZW1UcmVlUHJvbWlzZS50aGVuKF90aGlzLmJ1aWxkLmJpbmQoX3RoaXMpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHR5cGVzRGl2c0VudGVyXG4gICAgICAgICAgICAuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgJzEwMCUnKTtcbiAgICAgICAgdGhpcy50eXBlc0QzID0gdHlwZXNEaXZzRW50ZXJcbiAgICAgICAgICAgIC5tZXJnZSh0aGlzLnR5cGVzRDMpO1xuICAgICAgICB0aGlzLnR5cGVzRDMuc2VsZWN0QWxsKCcuZXhwYW5kLWJ1dHRvbicpXG4gICAgICAgICAgICAuY2xhc3NlZCgnZ2x5cGhpY29uLXJlc2l6ZS1zbWFsbCcsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLnZhbHVlLmV4cGFuZGVkOyB9KVxuICAgICAgICAgICAgLmNsYXNzZWQoJ2dseXBoaWNvbi1yZXNpemUtZnVsbCcsIGZ1bmN0aW9uIChkKSB7IHJldHVybiAhZC52YWx1ZS5leHBhbmRlZDsgfSk7XG4gICAgICAgIHRoaXMudHlwZXNEMy5zZWxlY3RBbGwoJ3N2ZycpXG4gICAgICAgICAgICAuc3R5bGUoJ2Rpc3BsYXknLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC52YWx1ZS5leHBhbmRlZCA/ICdibG9jaycgOiAnbm9uZSc7IH0pO1xuICAgICAgICB2YXIgdHlwZVN2Z3MgPSB0aGlzLnR5cGVzRDMuc2VsZWN0KCdzdmcnKVxuICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICByZXR1cm4gKE1hdGguY2VpbChkLnZhbHVlLml0ZW1zLmxlbmd0aCAvIHhEb3RzKSArIDEpICogeU9mZnNldDtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY2lyY2xlcyA9IHR5cGVTdmdzXG4gICAgICAgICAgICAuc2VsZWN0QWxsKCdjaXJjbGUuaXRlbScpXG4gICAgICAgICAgICAuZGF0YShmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC52YWx1ZS5pdGVtczsgfSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQudmFsdWU7IH0pO1xuICAgICAgICB0aGlzLmNpcmNsZXMuZXhpdCgpLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLmNpcmNsZXMgPSB0aGlzLmNpcmNsZXMuZW50ZXIoKVxuICAgICAgICAgICAgLmFwcGVuZCgnY2lyY2xlJylcbiAgICAgICAgICAgIC5jbGFzc2VkKCdpdGVtJywgdHJ1ZSlcbiAgICAgICAgICAgIC5hdHRyKCdyJywgcmFkaXVzKVxuICAgICAgICAgICAgLm9uKCdtb3VzZW92ZXInLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgICAgICAgX3RoaXMudG9vbHRpcC5zdHlsZSgndG9wJywgKGQzLmV2ZW50LnBhZ2VZIC0gMTApICsgJ3B4JylcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ2xlZnQnLCAoZDMuZXZlbnQucGFnZVggKyAxMCkgKyAncHgnKVxuICAgICAgICAgICAgICAgIC5zdHlsZSgndmlzaWJpbGl0eScsICd2aXNpYmxlJylcbiAgICAgICAgICAgICAgICAudGV4dChkLmxhYmVsICsgJyAoJyArIGQudHlwZUxhYmVsICsgJyknKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignbW91c2VvdXQnLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgICAgICAgX3RoaXMudG9vbHRpcC5zdHlsZSgndmlzaWJpbGl0eScsICdoaWRkZW4nKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYWxsKGQzLmRyYWcoKVxuICAgICAgICAgICAgLm9uKCdzdGFydCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICB2YXIgdGhpc0NpcmNsZSA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgIG5vZGVEcmFnXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdkaXNwbGF5JywgJ2Jsb2NrJyk7XG4gICAgICAgICAgICBub2RlRHJhZy5zZWxlY3QoJ2NpcmNsZScpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoJ2l0ZW0nLCB0aGlzQ2lyY2xlLmNsYXNzZWQoJ2l0ZW0nKSlcbiAgICAgICAgICAgICAgICAuYXR0cigncicsIHRoaXNDaXJjbGUuYXR0cigncicpKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdmaWxsJywgdGhpc0NpcmNsZS5hdHRyKCdmaWxsJykpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoOCw4KScpO1xuICAgICAgICAgICAgbm9kZURyYWdcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ2xlZnQnLCBkMy5ldmVudC5zb3VyY2VFdmVudC5jbGllbnRYIC0gOClcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ3RvcCcsIGQzLmV2ZW50LnNvdXJjZUV2ZW50LmNsaWVudFkgLSA4KTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignZHJhZycsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICBub2RlRHJhZ1xuICAgICAgICAgICAgICAgIC5zdHlsZSgnbGVmdCcsIGQzLmV2ZW50LnNvdXJjZUV2ZW50LmNsaWVudFggLSA4KVxuICAgICAgICAgICAgICAgIC5zdHlsZSgndG9wJywgZDMuZXZlbnQuc291cmNlRXZlbnQuY2xpZW50WSAtIDgpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLm9uKCdlbmQnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIGN1cnNvciBpcyBvbiB0aGUgY2FudmFzLCBkaXNwbGF5XG4gICAgICAgICAgICB2YXIgZXhwbG9yZUNvbnRhaW5lciA9IGQzLnNlbGVjdCgnI2V4cGxvcmVjb250YWluZXInKS5ub2RlKCk7XG4gICAgICAgICAgICBpZiAoZDMuZXZlbnQuc291cmNlRXZlbnQuY2xpZW50WCA+IGV4cGxvcmVDb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCAmJlxuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnNvdXJjZUV2ZW50LmNsaWVudFggPCBleHBsb3JlQ29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0ICYmXG4gICAgICAgICAgICAgICAgZDMuZXZlbnQuc291cmNlRXZlbnQuY2xpZW50WSA+IGV4cGxvcmVDb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wICYmXG4gICAgICAgICAgICAgICAgZDMuZXZlbnQuc291cmNlRXZlbnQuY2xpZW50WSA8IGV4cGxvcmVDb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tKSB7XG4gICAgICAgICAgICAgICAgYWRkSXRlbShkMy5zZWxlY3QodGhpcykuZGF0dW0oKSwgW1xuICAgICAgICAgICAgICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5jbGllbnRYIC0gZXhwbG9yZUNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0LFxuICAgICAgICAgICAgICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5jbGllbnRZIC0gZXhwbG9yZUNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3BcbiAgICAgICAgICAgICAgICBdKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURyYWcuc3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbm9kZURyYWcuc3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSlcbiAgICAgICAgICAgIC5tZXJnZSh0aGlzLmNpcmNsZXMpXG4gICAgICAgICAgICAuY2FsbCh0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5jaXJjbGVzXG4gICAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAuYXR0cignZmlsbCcsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBfdGhpcy50eXBlQ29sb3JTY2FsZShkLnR5cGVWYWx1ZSk7IH0pXG4gICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgZnVuY3Rpb24gKGQsIGkpIHsgcmV0dXJuICd0cmFuc2xhdGUoJyArICgoaSAlIHhEb3RzKSArIDEpICogeE9mZnNldCArICcsJyArIChNYXRoLmZsb29yKGkgLyB4RG90cykgKyAxKSAqIHlPZmZzZXQgKyAnKSc7IH0pO1xuICAgIH07XG4gICAgUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChjaXJjbGVzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBjID0gY2lyY2xlcyA/IGNpcmNsZXMgOiB0aGlzLmNpcmNsZXM7XG4gICAgICAgIGMuY2xhc3NlZCgnZGlzcGxheWVkJywgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIF90aGlzLmZpYnJhU2VydmljZS5nZXRTdGF0ZSgpLmNvbnN0cnVjdC5pdGVtSW5kZXhbZC52YWx1ZV0gPyB0cnVlIDogZmFsc2U7IH0pXG4gICAgICAgICAgICAuY2xhc3NlZCgnZmlsdGVyZWQnLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gX3RoaXMubGFiZWxGaWx0ZXIgJiYgIShkLmxhYmVsLnRvVXBwZXJDYXNlKCkuaW5kZXhPZihfdGhpcy5sYWJlbEZpbHRlci50b1VwcGVyQ2FzZSgpKSAhPT0gLTEpOyB9KTtcbiAgICB9O1xuICAgIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS5tYXBTdGF0ZVRvVGhpcyA9IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZXM6IHN0YXRlLnR5cGVzXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBQYWxldHRlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUudXBkYXRlU2l6aW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnBhbGV0dGVXaWR0aCA9IE1hdGgucm91bmQod2luZG93LmlubmVyV2lkdGggKiAwLjE1KTsgLy8gdGhpcy5zdmdTZWwubm9kZSgpLmNsaWVudFdpZHRoXG4gICAgICAgIHRoaXMucGFsZXR0ZUhlaWdodCA9IE1hdGgucm91bmQod2luZG93LmlubmVySGVpZ2h0KSAtIHRoaXMucGFsZXR0ZVNlYXJjaEhlaWdodDtcbiAgICAgICAgdGhpcy5kaXZTZWwuc3R5bGUoJ2hlaWdodCcsIHRoaXMucGFsZXR0ZUhlaWdodCArICdweCcpO1xuICAgIH07XG4gICAgUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLm1lcmdlSXRlbXMgPSBmdW5jdGlvbiAob2xkSXRlbXMsIG5ld0l0ZW1zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vIFdpcGUgb2xkIGl0ZW1zIChiYWQsIGJ1dCB0ZW1wb3JhcnkpXG4gICAgICAgIHRoaXMudHlwZUl0ZW1UcmVlLnZhbHVlcygpLmZvckVhY2goZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHYuaXRlbXMgPSBbXTtcbiAgICAgICAgfSk7XG4gICAgICAgIG5ld0l0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIHZhciB0eXBlUHJvcCA9IGl0ZW0ubG9jYWxQcm9wZXJ0aWVzLmZpbHRlcihmdW5jdGlvbiAocCkgeyByZXR1cm4gcC52YWx1ZSA9PT0gUkRGLnR5cGUudmFsdWU7IH0pWzBdO1xuICAgICAgICAgICAgaWYgKHR5cGVQcm9wICYmIHR5cGVQcm9wLnZhbHVlc1swXSkge1xuICAgICAgICAgICAgICAgIGl0ZW0udHlwZVZhbHVlID0gdHlwZVByb3AudmFsdWVzWzBdLnZhbHVlLnZhbHVlO1xuICAgICAgICAgICAgICAgIGl0ZW0udHlwZUxhYmVsID0gdHlwZVByb3AudmFsdWVzWzBdLnZhbHVlLmxhYmVsO1xuICAgICAgICAgICAgICAgIC8vIEFkZCB0eXBlIHRvIHRoZSB0eXBlIG1hcFxuICAgICAgICAgICAgICAgIGlmICghX3RoaXMudHlwZUl0ZW1UcmVlLmhhcyhpdGVtLnR5cGVWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudHlwZUl0ZW1UcmVlLnNldChpdGVtLnR5cGVWYWx1ZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0udHlwZUxhYmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IFtpdGVtXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudHlwZUl0ZW1UcmVlLmdldChpdGVtLnR5cGVWYWx1ZSkuaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpdGVtLnR5cGVWYWx1ZSA9ICcnO1xuICAgICAgICAgICAgICAgIGl0ZW0udHlwZUxhYmVsID0gJ05vIHR5cGUgZGVmaW5lZCc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBTb3J0IGJ5IGxhYmVsXG4gICAgICAgIHRoaXMudHlwZUl0ZW1UcmVlLnZhbHVlcygpLmZvckVhY2goZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHYuaXRlbXMuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYS5sYWJlbCA9PT0gYi5sYWJlbCA/IDAgOiBhLmxhYmVsID4gYi5sYWJlbCA/IDEgOiAtMTsgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlSXRlbVRyZWU7XG4gICAgfTtcbiAgICByZXR1cm4gUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXI7XG59KCkpO1xuZXhwb3J0IHsgUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXIgfTtcbnZhciBQYWxldHRlQ29tcG9uZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQYWxldHRlQ29tcG9uZW50KCkge1xuICAgICAgICB0aGlzLnRlbXBsYXRlID0gcmVxdWlyZSgnLi9wYWxldHRlLWNvbXBvbmVudC5wdWcnKSgpO1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBQYWxldHRlQ29tcG9uZW50Q29udHJvbGxlcjtcbiAgICB9XG4gICAgcmV0dXJuIFBhbGV0dGVDb21wb25lbnQ7XG59KCkpO1xuZXhwb3J0IHsgUGFsZXR0ZUNvbXBvbmVudCB9O1xuYW5ndWxhci5tb2R1bGUoJ2ZpYnJhLmNvbXBvbmVudHMucGFsZXR0ZScsIFsnZmlicmEuc2VydmljZXMnXSlcbiAgICAuY29tcG9uZW50KCdwYWxldHRlJywgbmV3IFBhbGV0dGVDb21wb25lbnQoKSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXBwL2NvbXBvbmVudHMvY29uc3RydWN0LXZpZXcvcGFsZXR0ZS1jb21wb25lbnQvcGFsZXR0ZS1jb21wb25lbnQudHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBUUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBSUE7QUFBQTtBQUNBO0FBSUE7QUFBQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUtBO0FBSUE7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBS0E7QUFHQTtBQUVBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFJQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ "./app/components/index.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_angular__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_angular___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_angular__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__projects_view_projects_view_component__ = __webpack_require__(\"./app/components/projects-view/projects-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__citable_citable_component__ = __webpack_require__(\"./app/components/citable/citable-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__social_auth_callback_component__ = __webpack_require__(\"./app/components/social-auth/callback-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__social_auth_login_component__ = __webpack_require__(\"./app/components/social-auth/login-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__construct_view_construct_view_component__ = __webpack_require__(\"./app/components/construct-view/construct-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__construct_view_explore_component__ = __webpack_require__(\"./app/components/construct-view/explore-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__construct_view_property_popover__ = __webpack_require__(\"./app/components/construct-view/property-popover.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__construct_view_palette_component_palette_component__ = __webpack_require__(\"./app/components/construct-view/palette-component/palette-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__construct_view_explore_verify_component_explore_verify_component__ = __webpack_require__(\"./app/components/construct-view/explore-verify-component/explore-verify-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__construct_view_explore_table_component_explore_table_component__ = __webpack_require__(\"./app/components/construct-view/explore-table-component/explore-table-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__construct_view_explore_type_component_explore_type_component__ = __webpack_require__(\"./app/components/construct-view/explore-type-component/explore-type-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__configure_view_configure_view_component__ = __webpack_require__(\"./app/components/configure-view/configure-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__citable_editor_citable_editor_component__ = __webpack_require__(\"./app/components/citable-editor/citable-editor-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__edit_primary_endpoint_configuration_view_edit_primary_endpoint_configuration_view_component__ = __webpack_require__(\"./app/components/edit-primary-endpoint-configuration-view/edit-primary-endpoint-configuration-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__edit_remote_endpoint_configuration_view_edit_remote_endpoint_configuration_view_component__ = __webpack_require__(\"./app/components/edit-remote-endpoint-configuration-view/edit-remote-endpoint-configuration-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__edit_schema_view_edit_schema_view_component__ = __webpack_require__(\"./app/components/edit-schema-view/edit-schema-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__project_source_configurations_view_project_source_configurations_view_component__ = __webpack_require__(\"./app/components/project-source-configurations-view/project-source-configurations-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__project_sources_view_project_sources_view_component__ = __webpack_require__(\"./app/components/project-sources-view/project-sources-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__type_select_type_select_component__ = __webpack_require__(\"./app/components/type-select/type-select-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__upload_upload_component__ = __webpack_require__(\"./app/components/upload/upload-component.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_angular__[\"module\"]('fibra.components', ['fibra.components.construct-view', 'fibra.components.explore', 'fibra.components.property-popover', 'fibra.components.palette', 'fibra.components.verify', 'fibra.components.explore-table', 'fibra.components.explore-type', 'fibra.components.projects-view', 'fibra.components.citable', 'fibra.components.callback', 'fibra.components.login', 'fibra.components.configure', 'fibra.components.citable-editor', 'fibra.components.edit-primary-endpoint-configuration', 'fibra.components.edit-remote-endpoint-configuration', 'fibra.components.edit-schema-view', 'fibra.components.project-source-configurations-view', 'fibra.components.project-sources-view', 'fibra.components.type-select', 'fibra.components.upload']);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvY29tcG9uZW50cy9pbmRleC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hcHAvY29tcG9uZW50cy9pbmRleC50cz8zMWZkIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmltcG9ydCAqIGFzIGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgJy4vcHJvamVjdHMtdmlldy9wcm9qZWN0cy12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vY2l0YWJsZS9jaXRhYmxlLWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vc29jaWFsLWF1dGgvY2FsbGJhY2stY29tcG9uZW50JztcbmltcG9ydCAnLi9zb2NpYWwtYXV0aC9sb2dpbi1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2NvbnN0cnVjdC12aWV3L2NvbnN0cnVjdC12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vY29uc3RydWN0LXZpZXcvZXhwbG9yZS1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2NvbnN0cnVjdC12aWV3L3Byb3BlcnR5LXBvcG92ZXInO1xuaW1wb3J0ICcuL2NvbnN0cnVjdC12aWV3L3BhbGV0dGUtY29tcG9uZW50L3BhbGV0dGUtY29tcG9uZW50JztcbmltcG9ydCAnLi9jb25zdHJ1Y3Qtdmlldy9leHBsb3JlLXZlcmlmeS1jb21wb25lbnQvZXhwbG9yZS12ZXJpZnktY29tcG9uZW50JztcbmltcG9ydCAnLi9jb25zdHJ1Y3Qtdmlldy9leHBsb3JlLXRhYmxlLWNvbXBvbmVudC9leHBsb3JlLXRhYmxlLWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vY29uc3RydWN0LXZpZXcvZXhwbG9yZS10eXBlLWNvbXBvbmVudC9leHBsb3JlLXR5cGUtY29tcG9uZW50JztcbmltcG9ydCAnLi9jb25maWd1cmUtdmlldy9jb25maWd1cmUtdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2NpdGFibGUtZWRpdG9yL2NpdGFibGUtZWRpdG9yLWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vZWRpdC1wcmltYXJ5LWVuZHBvaW50LWNvbmZpZ3VyYXRpb24tdmlldy9lZGl0LXByaW1hcnktZW5kcG9pbnQtY29uZmlndXJhdGlvbi12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vZWRpdC1yZW1vdGUtZW5kcG9pbnQtY29uZmlndXJhdGlvbi12aWV3L2VkaXQtcmVtb3RlLWVuZHBvaW50LWNvbmZpZ3VyYXRpb24tdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2VkaXQtc2NoZW1hLXZpZXcvZWRpdC1zY2hlbWEtdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL3Byb2plY3Qtc291cmNlLWNvbmZpZ3VyYXRpb25zLXZpZXcvcHJvamVjdC1zb3VyY2UtY29uZmlndXJhdGlvbnMtdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL3Byb2plY3Qtc291cmNlcy12aWV3L3Byb2plY3Qtc291cmNlcy12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vdHlwZS1zZWxlY3QvdHlwZS1zZWxlY3QtY29tcG9uZW50JztcbmltcG9ydCAnLi91cGxvYWQvdXBsb2FkLWNvbXBvbmVudCc7XG5hbmd1bGFyLm1vZHVsZSgnZmlicmEuY29tcG9uZW50cycsIFtcbiAgICAnZmlicmEuY29tcG9uZW50cy5jb25zdHJ1Y3QtdmlldycsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMuZXhwbG9yZScsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMucHJvcGVydHktcG9wb3ZlcicsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMucGFsZXR0ZScsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMudmVyaWZ5JyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5leHBsb3JlLXRhYmxlJyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5leHBsb3JlLXR5cGUnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLnByb2plY3RzLXZpZXcnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmNpdGFibGUnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmNhbGxiYWNrJyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5sb2dpbicsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMuY29uZmlndXJlJyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5jaXRhYmxlLWVkaXRvcicsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMuZWRpdC1wcmltYXJ5LWVuZHBvaW50LWNvbmZpZ3VyYXRpb24nLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmVkaXQtcmVtb3RlLWVuZHBvaW50LWNvbmZpZ3VyYXRpb24nLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmVkaXQtc2NoZW1hLXZpZXcnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLnByb2plY3Qtc291cmNlLWNvbmZpZ3VyYXRpb25zLXZpZXcnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLnByb2plY3Qtc291cmNlcy12aWV3JyxcbiAgICAnZmlicmEuY29tcG9uZW50cy50eXBlLXNlbGVjdCcsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMudXBsb2FkJ1xuXSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXBwL2NvbXBvbmVudHMvaW5kZXgudHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ })

})