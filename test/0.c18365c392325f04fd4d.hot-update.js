webpackHotUpdate(0,{

/***/ "./app/components/index.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_angular__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_angular___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_angular__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__projects_view_projects_view_component__ = __webpack_require__(\"./app/components/projects-view/projects-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__citable_citable_component__ = __webpack_require__(\"./app/components/citable/citable-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__social_auth_callback_component__ = __webpack_require__(\"./app/components/social-auth/callback-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__social_auth_login_component__ = __webpack_require__(\"./app/components/social-auth/login-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__construct_view_construct_view_component__ = __webpack_require__(\"./app/components/construct-view/construct-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__construct_view_explore_component__ = __webpack_require__(\"./app/components/construct-view/explore-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__construct_view_property_popover__ = __webpack_require__(\"./app/components/construct-view/property-popover.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__construct_view_palette_component_palette_component__ = __webpack_require__(\"./app/components/construct-view/palette-component/palette-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__construct_view_explore_verify_component_explore_verify_component__ = __webpack_require__(\"./app/components/construct-view/explore-verify-component/explore-verify-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__construct_view_explore_table_component_explore_table_component__ = __webpack_require__(\"./app/components/construct-view/explore-table-component/explore-table-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__construct_view_explore_type_component_explore_type_component__ = __webpack_require__(\"./app/components/construct-view/explore-type-component/explore-type-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__configure_view_configure_view_component__ = __webpack_require__(\"./app/components/configure-view/configure-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__citable_editor_citable_editor_component__ = __webpack_require__(\"./app/components/citable-editor/citable-editor-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__edit_primary_endpoint_configuration_view_edit_primary_endpoint_configuration_view_component__ = __webpack_require__(\"./app/components/edit-primary-endpoint-configuration-view/edit-primary-endpoint-configuration-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__edit_remote_endpoint_configuration_view_edit_remote_endpoint_configuration_view_component__ = __webpack_require__(\"./app/components/edit-remote-endpoint-configuration-view/edit-remote-endpoint-configuration-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__edit_schema_view_edit_schema_view_component__ = __webpack_require__(\"./app/components/edit-schema-view/edit-schema-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__project_source_configurations_view_project_source_configurations_view_component__ = __webpack_require__(\"./app/components/project-source-configurations-view/project-source-configurations-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__project_sources_view_project_sources_view_component__ = __webpack_require__(\"./app/components/project-sources-view/project-sources-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__type_select_type_select_component__ = __webpack_require__(\"./app/components/type-select/type-select-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__upload_upload_component__ = __webpack_require__(\"./app/components/upload/upload-component.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_angular__[\"module\"]('fibra.components', ['fibra.components.construct-view', 'fibra.components.explore', 'fibra.components.property-popover', 'fibra.components.palette', 'fibra.components.verify', 'fibra.components.explore-table', 'fibra.components.explore-type', 'fibra.components.projects-view', 'fibra.components.citable', 'fibra.components.callback', 'fibra.components.login', 'fibra.components.configure', 'fibra.components.citable-editor', 'fibra.components.edit-primary-endpoint-configuration', 'fibra.components.edit-remote-endpoint-configuration', 'fibra.components.edit-schema-view', 'fibra.components.project-source-configurations-view', 'fibra.components.project-sources-view', 'fibra.components.type-select', 'fibra.components.upload']);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvY29tcG9uZW50cy9pbmRleC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hcHAvY29tcG9uZW50cy9pbmRleC50cz8zMWZkIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmltcG9ydCAqIGFzIGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgJy4vcHJvamVjdHMtdmlldy9wcm9qZWN0cy12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vY2l0YWJsZS9jaXRhYmxlLWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vc29jaWFsLWF1dGgvY2FsbGJhY2stY29tcG9uZW50JztcbmltcG9ydCAnLi9zb2NpYWwtYXV0aC9sb2dpbi1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2NvbnN0cnVjdC12aWV3L2NvbnN0cnVjdC12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vY29uc3RydWN0LXZpZXcvZXhwbG9yZS1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2NvbnN0cnVjdC12aWV3L3Byb3BlcnR5LXBvcG92ZXInO1xuaW1wb3J0ICcuL2NvbnN0cnVjdC12aWV3L3BhbGV0dGUtY29tcG9uZW50L3BhbGV0dGUtY29tcG9uZW50JztcbmltcG9ydCAnLi9jb25zdHJ1Y3Qtdmlldy9leHBsb3JlLXZlcmlmeS1jb21wb25lbnQvZXhwbG9yZS12ZXJpZnktY29tcG9uZW50JztcbmltcG9ydCAnLi9jb25zdHJ1Y3Qtdmlldy9leHBsb3JlLXRhYmxlLWNvbXBvbmVudC9leHBsb3JlLXRhYmxlLWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vY29uc3RydWN0LXZpZXcvZXhwbG9yZS10eXBlLWNvbXBvbmVudC9leHBsb3JlLXR5cGUtY29tcG9uZW50JztcbmltcG9ydCAnLi9jb25maWd1cmUtdmlldy9jb25maWd1cmUtdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2NpdGFibGUtZWRpdG9yL2NpdGFibGUtZWRpdG9yLWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vZWRpdC1wcmltYXJ5LWVuZHBvaW50LWNvbmZpZ3VyYXRpb24tdmlldy9lZGl0LXByaW1hcnktZW5kcG9pbnQtY29uZmlndXJhdGlvbi12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vZWRpdC1yZW1vdGUtZW5kcG9pbnQtY29uZmlndXJhdGlvbi12aWV3L2VkaXQtcmVtb3RlLWVuZHBvaW50LWNvbmZpZ3VyYXRpb24tdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2VkaXQtc2NoZW1hLXZpZXcvZWRpdC1zY2hlbWEtdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL3Byb2plY3Qtc291cmNlLWNvbmZpZ3VyYXRpb25zLXZpZXcvcHJvamVjdC1zb3VyY2UtY29uZmlndXJhdGlvbnMtdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL3Byb2plY3Qtc291cmNlcy12aWV3L3Byb2plY3Qtc291cmNlcy12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vdHlwZS1zZWxlY3QvdHlwZS1zZWxlY3QtY29tcG9uZW50JztcbmltcG9ydCAnLi91cGxvYWQvdXBsb2FkLWNvbXBvbmVudCc7XG5hbmd1bGFyLm1vZHVsZSgnZmlicmEuY29tcG9uZW50cycsIFtcbiAgICAnZmlicmEuY29tcG9uZW50cy5jb25zdHJ1Y3QtdmlldycsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMuZXhwbG9yZScsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMucHJvcGVydHktcG9wb3ZlcicsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMucGFsZXR0ZScsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMudmVyaWZ5JyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5leHBsb3JlLXRhYmxlJyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5leHBsb3JlLXR5cGUnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLnByb2plY3RzLXZpZXcnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmNpdGFibGUnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmNhbGxiYWNrJyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5sb2dpbicsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMuY29uZmlndXJlJyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5jaXRhYmxlLWVkaXRvcicsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMuZWRpdC1wcmltYXJ5LWVuZHBvaW50LWNvbmZpZ3VyYXRpb24nLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmVkaXQtcmVtb3RlLWVuZHBvaW50LWNvbmZpZ3VyYXRpb24nLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmVkaXQtc2NoZW1hLXZpZXcnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLnByb2plY3Qtc291cmNlLWNvbmZpZ3VyYXRpb25zLXZpZXcnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLnByb2plY3Qtc291cmNlcy12aWV3JyxcbiAgICAnZmlicmEuY29tcG9uZW50cy50eXBlLXNlbGVjdCcsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMudXBsb2FkJ1xuXSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXBwL2NvbXBvbmVudHMvaW5kZXgudHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ "./app/components/upload/upload-component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_angular__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_angular___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_angular__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_d3__ = __webpack_require__(\"./app/bower_components/d3/d3.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_d3___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_d3__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_sparql_item_service__ = __webpack_require__(\"./app/services/sparql-item-service.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__models_rdf__ = __webpack_require__(\"./app/models/rdf.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__actions_types__ = __webpack_require__(\"./app/actions/types.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__actions_items__ = __webpack_require__(\"./app/actions/items.ts\");\n/* unused harmony export UploadComponentController */\n/* unused harmony export UploadComponent */\n\n\n\n\n\n\n\n\nvar UploadComponentController = function () {\n    function UploadComponentController(fibraService, $ngRedux, $q, $scope) {\n        this.fibraService = fibraService;\n        this.$ngRedux = $ngRedux;\n        this.$q = $q;\n        this.$scope = $scope;\n        this.classSelect = null;\n        var unsub1 = $ngRedux.connect(this.mapTypesToThis, __WEBPACK_IMPORTED_MODULE_4__actions_types__)(this);\n        var unsub2 = $ngRedux.connect(this.mapItemsToThis, __WEBPACK_IMPORTED_MODULE_5__actions_items__)(this);\n        this.unsubscribe = function () {\n            unsub1();\n            unsub2();\n        };\n        this.fibraService = fibraService;\n        $scope.registerFile = this.registerFile.bind(this);\n    }\n    UploadComponentController.prototype.mapTypesToThis = function (state) {\n        return {\n            types: state.types\n        };\n    };\n    UploadComponentController.prototype.mapItemsToThis = function (state) {\n        return {\n            items: state.items\n        };\n    };\n    UploadComponentController.prototype.registerFile = function (file) {\n        this.fileInput = file;\n    };\n    UploadComponentController.prototype.uploadFile = function () {\n        var _this = this;\n        console.log(this.fileInput, this.types.types.filter(function (t) {\n            return t.id === _this.classSelect;\n        })[0]);\n        var selectedClass = this.types.types.filter(function (t) {\n            return t.id === _this.classSelect;\n        })[0];\n        // Notes: column headers we should handle\n        //  - 'FibraId' - this will be the matching Fibra identifier. In this case we should not createItem\n        //              but rather update an existing item if necessary\n        //  - SKOS.prefLabel.value - Will be the label to use\n        //  - 'Match' - will be the Recon matched value and should go to OWL.sameAs property\n        //  - 'Notes' - will do onto a notes property?\n        // Just uses the first column of the file as labels\n        var reader = new FileReader();\n        reader.onload = function () {\n            var parsedCSV = __WEBPACK_IMPORTED_MODULE_1_d3__[\"csvParse\"](reader.result);\n            var newRows = parsedCSV.filter(function (row) {\n                return !row['FibraId']; // Not an update\n            });\n            var labelColumnKey = parsedCSV.columns[0];\n            console.log(parsedCSV, labelColumnKey);\n            var proms = [newRows.length > 0 ? _this.fibraService.dispatchAction(_this.createItems(newRows.map(function (row) {\n                var node = __WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"b\" /* DataFactory */].instance.namedNode(row[labelColumnKey]);\n                return node;\n            }), selectedClass.id)) : _this.$q.resolve(_this.fibraService.getState()), _this.$q.all(parsedCSV.filter(function (row) {\n                return !!row['FibraId'];\n            }).map(function (row) {\n                if (row['Match'] && !row[__WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"d\" /* OWL */].sameAs.value]) {\n                    row[__WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"d\" /* OWL */].sameAs.value] = row['Match'];\n                    delete row['Match'];\n                }\n                var entries = __WEBPACK_IMPORTED_MODULE_1_d3__[\"entries\"](row);\n                var props = entries.filter(function (entry) {\n                    return entry.key !== 'FibraId' && entry.value && entry.key !== __WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"d\" /* OWL */].sameAs.value && entry.key !== 'Notes' && entry.key !== 'Match';\n                }).map(function (entry) {\n                    return new __WEBPACK_IMPORTED_MODULE_2__services_sparql_item_service__[\"a\" /* PropertyAndValue */](__WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"b\" /* DataFactory */].instance.namedNode(entry.key), entry.value.indexOf('http://') === 0 ? __WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"b\" /* DataFactory */].instance.namedNode(entry.value) : __WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"b\" /* DataFactory */].instance.literal(entry.value));\n                });\n                // Handle OWL.sameAs\n                entries.filter(function (entry) {\n                    return entry.key === __WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"d\" /* OWL */].sameAs.value && entry.value;\n                }).forEach(function (entry) {\n                    return props.push(new __WEBPACK_IMPORTED_MODULE_2__services_sparql_item_service__[\"a\" /* PropertyAndValue */](__WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"d\" /* OWL */].sameAs, __WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"b\" /* DataFactory */].instance.namedNode(entry.value)));\n                });\n                return _this.fibraService.dispatchAction(_this.itemProperty(new __WEBPACK_IMPORTED_MODULE_3__models_rdf__[\"i\" /* NamedNode */](row['FibraId']), props));\n            })).then(function (states) {\n                return states[states.length - 1];\n            })];\n            _this.$q.all(proms).then(function () {\n                _this.fibraService.dispatch('change');\n            });\n        };\n        reader.readAsText(this.fileInput.files[0]);\n        // We need to clear the input so that we pick up future uploads. This is *not*\n        // cross-browser-compatible.\n        this.fileInput.value = null;\n        this.onUpload();\n    };\n    return UploadComponentController;\n}();\n\nvar UploadComponent = function () {\n    function UploadComponent() {\n        this.controller = UploadComponentController; // (new (...args: any[]) => angular.IController) = SelectViewComponentController\n        this.template = __webpack_require__(\"./app/components/upload/upload.pug\")();\n        this.bindings = {\n            onUpload: '&'\n        };\n    }\n    return UploadComponent;\n}();\n\n__WEBPACK_IMPORTED_MODULE_0_angular__[\"module\"]('fibra.components.upload', []).component('upload', new UploadComponent());//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvY29tcG9uZW50cy91cGxvYWQvdXBsb2FkLWNvbXBvbmVudC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hcHAvY29tcG9uZW50cy91cGxvYWQvdXBsb2FkLWNvbXBvbmVudC50cz8xMTE4Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmltcG9ydCAqIGFzIGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XG5pbXBvcnQgeyBQcm9wZXJ0eUFuZFZhbHVlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvc3BhcnFsLWl0ZW0tc2VydmljZSc7XG5pbXBvcnQgeyBEYXRhRmFjdG9yeSwgT1dMLCBOYW1lZE5vZGUgfSBmcm9tICcuLi8uLi9tb2RlbHMvcmRmJztcbmltcG9ydCAqIGFzIFR5cGVBY3Rpb25zIGZyb20gJy4uLy4uL2FjdGlvbnMvdHlwZXMnO1xuaW1wb3J0ICogYXMgSXRlbUFjdGlvbnMgZnJvbSAnLi4vLi4vYWN0aW9ucy9pdGVtcyc7XG52YXIgVXBsb2FkQ29tcG9uZW50Q29udHJvbGxlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVXBsb2FkQ29tcG9uZW50Q29udHJvbGxlcihmaWJyYVNlcnZpY2UsICRuZ1JlZHV4LCAkcSwgJHNjb3BlKSB7XG4gICAgICAgIHRoaXMuZmlicmFTZXJ2aWNlID0gZmlicmFTZXJ2aWNlO1xuICAgICAgICB0aGlzLiRuZ1JlZHV4ID0gJG5nUmVkdXg7XG4gICAgICAgIHRoaXMuJHEgPSAkcTtcbiAgICAgICAgdGhpcy4kc2NvcGUgPSAkc2NvcGU7XG4gICAgICAgIHRoaXMuY2xhc3NTZWxlY3QgPSBudWxsO1xuICAgICAgICB2YXIgdW5zdWIxID0gJG5nUmVkdXguY29ubmVjdCh0aGlzLm1hcFR5cGVzVG9UaGlzLCBUeXBlQWN0aW9ucykodGhpcyk7XG4gICAgICAgIHZhciB1bnN1YjIgPSAkbmdSZWR1eC5jb25uZWN0KHRoaXMubWFwSXRlbXNUb1RoaXMsIEl0ZW1BY3Rpb25zKSh0aGlzKTtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHVuc3ViMSgpO1xuICAgICAgICAgICAgdW5zdWIyKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZmlicmFTZXJ2aWNlID0gZmlicmFTZXJ2aWNlO1xuICAgICAgICAkc2NvcGUucmVnaXN0ZXJGaWxlID0gdGhpcy5yZWdpc3RlckZpbGUuYmluZCh0aGlzKTtcbiAgICB9XG4gICAgVXBsb2FkQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUubWFwVHlwZXNUb1RoaXMgPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGVzOiBzdGF0ZS50eXBlc1xuICAgICAgICB9O1xuICAgIH07XG4gICAgVXBsb2FkQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUubWFwSXRlbXNUb1RoaXMgPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGl0ZW1zOiBzdGF0ZS5pdGVtc1xuICAgICAgICB9O1xuICAgIH07XG4gICAgVXBsb2FkQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUucmVnaXN0ZXJGaWxlID0gZnVuY3Rpb24gKGZpbGUpIHtcbiAgICAgICAgdGhpcy5maWxlSW5wdXQgPSBmaWxlO1xuICAgIH07XG4gICAgVXBsb2FkQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUudXBsb2FkRmlsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5maWxlSW5wdXQsIHRoaXMudHlwZXMudHlwZXMuZmlsdGVyKGZ1bmN0aW9uICh0KSB7IHJldHVybiB0LmlkID09PSBfdGhpcy5jbGFzc1NlbGVjdDsgfSlbMF0pO1xuICAgICAgICB2YXIgc2VsZWN0ZWRDbGFzcyA9IHRoaXMudHlwZXMudHlwZXMuZmlsdGVyKGZ1bmN0aW9uICh0KSB7IHJldHVybiB0LmlkID09PSBfdGhpcy5jbGFzc1NlbGVjdDsgfSlbMF07XG4gICAgICAgIC8vIE5vdGVzOiBjb2x1bW4gaGVhZGVycyB3ZSBzaG91bGQgaGFuZGxlXG4gICAgICAgIC8vICAtICdGaWJyYUlkJyAtIHRoaXMgd2lsbCBiZSB0aGUgbWF0Y2hpbmcgRmlicmEgaWRlbnRpZmllci4gSW4gdGhpcyBjYXNlIHdlIHNob3VsZCBub3QgY3JlYXRlSXRlbVxuICAgICAgICAvLyAgICAgICAgICAgICAgYnV0IHJhdGhlciB1cGRhdGUgYW4gZXhpc3RpbmcgaXRlbSBpZiBuZWNlc3NhcnlcbiAgICAgICAgLy8gIC0gU0tPUy5wcmVmTGFiZWwudmFsdWUgLSBXaWxsIGJlIHRoZSBsYWJlbCB0byB1c2VcbiAgICAgICAgLy8gIC0gJ01hdGNoJyAtIHdpbGwgYmUgdGhlIFJlY29uIG1hdGNoZWQgdmFsdWUgYW5kIHNob3VsZCBnbyB0byBPV0wuc2FtZUFzIHByb3BlcnR5XG4gICAgICAgIC8vICAtICdOb3RlcycgLSB3aWxsIGRvIG9udG8gYSBub3RlcyBwcm9wZXJ0eT9cbiAgICAgICAgLy8gSnVzdCB1c2VzIHRoZSBmaXJzdCBjb2x1bW4gb2YgdGhlIGZpbGUgYXMgbGFiZWxzXG4gICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHBhcnNlZENTViA9IGQzLmNzdlBhcnNlKHJlYWRlci5yZXN1bHQpO1xuICAgICAgICAgICAgdmFyIG5ld1Jvd3MgPSBwYXJzZWRDU1YuZmlsdGVyKGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gIXJvd1snRmlicmFJZCddOyAvLyBOb3QgYW4gdXBkYXRlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBsYWJlbENvbHVtbktleSA9IHBhcnNlZENTVi5jb2x1bW5zWzBdO1xuICAgICAgICAgICAgY29uc29sZS5sb2cocGFyc2VkQ1NWLCBsYWJlbENvbHVtbktleSk7XG4gICAgICAgICAgICB2YXIgcHJvbXMgPSBbXG4gICAgICAgICAgICAgICAgbmV3Um93cy5sZW5ndGggPiAwID8gX3RoaXMuZmlicmFTZXJ2aWNlLmRpc3BhdGNoQWN0aW9uKF90aGlzLmNyZWF0ZUl0ZW1zKG5ld1Jvd3MubWFwKGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBEYXRhRmFjdG9yeS5pbnN0YW5jZS5uYW1lZE5vZGUocm93W2xhYmVsQ29sdW1uS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgICAgIH0pLCBzZWxlY3RlZENsYXNzLmlkKSkgOiBfdGhpcy4kcS5yZXNvbHZlKF90aGlzLmZpYnJhU2VydmljZS5nZXRTdGF0ZSgpKSxcbiAgICAgICAgICAgICAgICBfdGhpcy4kcS5hbGwocGFyc2VkQ1NWLmZpbHRlcihmdW5jdGlvbiAocm93KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhIXJvd1snRmlicmFJZCddO1xuICAgICAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbiAocm93KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyb3dbJ01hdGNoJ10gJiYgIXJvd1tPV0wuc2FtZUFzLnZhbHVlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93W09XTC5zYW1lQXMudmFsdWVdID0gcm93WydNYXRjaCddO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHJvd1snTWF0Y2gnXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgZW50cmllcyA9IGQzLmVudHJpZXMocm93KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BzID0gZW50cmllc1xuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoZW50cnkpIHsgcmV0dXJuIGVudHJ5LmtleSAhPT0gJ0ZpYnJhSWQnXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBlbnRyeS52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgZW50cnkua2V5ICE9PSBPV0wuc2FtZUFzLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBlbnRyeS5rZXkgIT09ICdOb3RlcydcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIGVudHJ5LmtleSAhPT0gJ01hdGNoJzsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb3BlcnR5QW5kVmFsdWUoRGF0YUZhY3RvcnkuaW5zdGFuY2UubmFtZWROb2RlKGVudHJ5LmtleSksIGVudHJ5LnZhbHVlLmluZGV4T2YoJ2h0dHA6Ly8nKSA9PT0gMCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YUZhY3RvcnkuaW5zdGFuY2UubmFtZWROb2RlKGVudHJ5LnZhbHVlKSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YUZhY3RvcnkuaW5zdGFuY2UubGl0ZXJhbChlbnRyeS52YWx1ZSkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIE9XTC5zYW1lQXNcbiAgICAgICAgICAgICAgICAgICAgZW50cmllc1xuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoZW50cnkpIHsgcmV0dXJuIGVudHJ5LmtleSA9PT0gT1dMLnNhbWVBcy52YWx1ZSAmJiBlbnRyeS52YWx1ZTsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkgeyByZXR1cm4gcHJvcHMucHVzaChuZXcgUHJvcGVydHlBbmRWYWx1ZShPV0wuc2FtZUFzLCBEYXRhRmFjdG9yeS5pbnN0YW5jZS5uYW1lZE5vZGUoZW50cnkudmFsdWUpKSk7IH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZmlicmFTZXJ2aWNlLmRpc3BhdGNoQWN0aW9uKF90aGlzLml0ZW1Qcm9wZXJ0eShuZXcgTmFtZWROb2RlKHJvd1snRmlicmFJZCddKSwgcHJvcHMpKTtcbiAgICAgICAgICAgICAgICB9KSkudGhlbihmdW5jdGlvbiAoc3RhdGVzKSB7IHJldHVybiBzdGF0ZXNbc3RhdGVzLmxlbmd0aCAtIDFdOyB9KVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIF90aGlzLiRxLmFsbChwcm9tcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuZmlicmFTZXJ2aWNlLmRpc3BhdGNoKCdjaGFuZ2UnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZWFkZXIucmVhZEFzVGV4dCh0aGlzLmZpbGVJbnB1dC5maWxlc1swXSk7XG4gICAgICAgIC8vIFdlIG5lZWQgdG8gY2xlYXIgdGhlIGlucHV0IHNvIHRoYXQgd2UgcGljayB1cCBmdXR1cmUgdXBsb2Fkcy4gVGhpcyBpcyAqbm90KlxuICAgICAgICAvLyBjcm9zcy1icm93c2VyLWNvbXBhdGlibGUuXG4gICAgICAgIHRoaXMuZmlsZUlucHV0LnZhbHVlID0gbnVsbDtcbiAgICAgICAgdGhpcy5vblVwbG9hZCgpO1xuICAgIH07XG4gICAgcmV0dXJuIFVwbG9hZENvbXBvbmVudENvbnRyb2xsZXI7XG59KCkpO1xuZXhwb3J0IHsgVXBsb2FkQ29tcG9uZW50Q29udHJvbGxlciB9O1xudmFyIFVwbG9hZENvbXBvbmVudCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVXBsb2FkQ29tcG9uZW50KCkge1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBVcGxvYWRDb21wb25lbnRDb250cm9sbGVyOyAvLyAobmV3ICguLi5hcmdzOiBhbnlbXSkgPT4gYW5ndWxhci5JQ29udHJvbGxlcikgPSBTZWxlY3RWaWV3Q29tcG9uZW50Q29udHJvbGxlclxuICAgICAgICB0aGlzLnRlbXBsYXRlID0gcmVxdWlyZSgnLi91cGxvYWQucHVnJykoKTtcbiAgICAgICAgdGhpcy5iaW5kaW5ncyA9IHtcbiAgICAgICAgICAgIG9uVXBsb2FkOiAnJidcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIFVwbG9hZENvbXBvbmVudDtcbn0oKSk7XG5leHBvcnQgeyBVcGxvYWRDb21wb25lbnQgfTtcbmFuZ3VsYXIubW9kdWxlKCdmaWJyYS5jb21wb25lbnRzLnVwbG9hZCcsIFtdKVxuICAgIC5jb21wb25lbnQoJ3VwbG9hZCcsIG5ldyBVcGxvYWRDb21wb25lbnQoKSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXBwL2NvbXBvbmVudHMvdXBsb2FkL3VwbG9hZC1jb21wb25lbnQudHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ })

})