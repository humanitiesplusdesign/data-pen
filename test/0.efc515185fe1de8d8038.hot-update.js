webpackHotUpdate(0,{

/***/ "./app/components/construct-view/explore-component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__services_sparql_item_service__ = __webpack_require__(\"./app/services/sparql-item-service.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__sunburst__ = __webpack_require__(\"./app/components/construct-view/sunburst.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__property_popover__ = __webpack_require__(\"./app/components/construct-view/property-popover.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_d3__ = __webpack_require__(\"./app/bower_components/d3/d3.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_d3___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_d3__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__models_rdf__ = __webpack_require__(\"./app/models/rdf.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_angular__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_angular___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_angular__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__actions_verify__ = __webpack_require__(\"./app/actions/verify.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__actions_types__ = __webpack_require__(\"./app/actions/types.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__actions_items__ = __webpack_require__(\"./app/actions/items.ts\");\n/* unused harmony export ExploreComponent */\n\n\n\n\n\n\n\n\n\n\n\nvar ExploreComponentController = function () {\n    function ExploreComponentController($element, $compile, $window, $scope, $timeout, sparqlItemService, fibraService, $ngRedux, $q) {\n        var _this = this;\n        this.$element = $element;\n        this.$compile = $compile;\n        this.$window = $window;\n        this.$scope = $scope;\n        this.$timeout = $timeout;\n        this.sparqlItemService = sparqlItemService;\n        this.fibraService = fibraService;\n        this.$ngRedux = $ngRedux;\n        this.$q = $q;\n        this.primaryItems = [];\n        this.secondaryItems = [];\n        this.tertiaryItems = [];\n        this.untypedItems = [];\n        this.removedUntypedItems = [];\n        this.allItems = [];\n        this.radiusInitial = 1;\n        this.radius = 8;\n        this.radiusBounce = 15;\n        this.gridOffset = 50; // Should be even\n        this.chargeForce = __WEBPACK_IMPORTED_MODULE_3_d3__[\"forceCollide\"](this.gridOffset / 1.5);\n        this.chargeForce2 = __WEBPACK_IMPORTED_MODULE_3_d3__[\"forceCollide\"](this.gridOffset / 1.5);\n        this.svgBackgroundColor = '#EEE';\n        this.lastClickX = 0;\n        this.lastClickY = 0;\n        var unsub1 = $ngRedux.connect(this.mapVerifyToThis, __WEBPACK_IMPORTED_MODULE_6__actions_verify__)(this);\n        var unsub2 = $ngRedux.connect(this.mapTypesToThis, __WEBPACK_IMPORTED_MODULE_7__actions_types__)(this);\n        var unsub3 = $ngRedux.connect(this.mapItemsToThis, __WEBPACK_IMPORTED_MODULE_8__actions_items__)(this);\n        this.unsubscribe = function () {\n            unsub1();\n            unsub2();\n            unsub3();\n        };\n        this.sunburst = new __WEBPACK_IMPORTED_MODULE_1__sunburst__[\"a\" /* Sunburst */]($element, $compile, $scope, sparqlItemService, fibraService);\n        this.propertyPopover = new __WEBPACK_IMPORTED_MODULE_2__property_popover__[\"a\" /* PropertyPopover */]($element, $scope, fibraService, $compile);\n        this.fibraService.on('change', function () {\n            // this.verifyItem = this.fibraService.getState().construct.verifyItem\n            return _this.queryAndBuild();\n        });\n        this.itemService = sparqlItemService;\n        this.links = [];\n        this.$scope.layout = {\n            'choice': 'force',\n            'links': 'hide'\n        };\n        this.$scope.$watch('layout.choice', this.updateExplore.bind(this, false));\n        this.$scope.$watch('layout.links', this.updateExplore.bind(this, false));\n    }\n    ExploreComponentController.prototype.$onChanges = function (chngsObj) {\n        if (this.svgSel) {\n            this.updateExplore(false, false);\n        }\n    };\n    ExploreComponentController.prototype.$postLink = function () {\n        var _this = this;\n        this.svgSel = __WEBPACK_IMPORTED_MODULE_3_d3__[\"select\"](this.$element[0]).select('svg');\n        this.svgSel.append('rect').classed('background', true).style('fill', this.svgBackgroundColor).on('click', function () {\n            _this.lastClickX = __WEBPACK_IMPORTED_MODULE_3_d3__[\"event\"].offsetX;\n            _this.lastClickY = __WEBPACK_IMPORTED_MODULE_3_d3__[\"event\"].offsetY;\n            _this.fibraService.dispatchAction(_this.createDisplayItem());\n        });\n        // Create link g\n        this.svgSel.append('g').attr('class', 'links');\n        this.sunburst.addSunburstGroup(this.svgSel);\n        this.radius = 8;\n        this.tooltip = __WEBPACK_IMPORTED_MODULE_3_d3__[\"select\"]('body').append('div').style('position', 'absolute').style('z-index', '20').style('background-color', 'gray').style('color', 'white').style('padding', '3px').style('border-radius', '2px').style('visibility', 'hidden');\n        this.edittip = __WEBPACK_IMPORTED_MODULE_3_d3__[\"select\"]('body').append('div').attr('id', 'edittip').style('position', 'absolute').style('z-index', '40').style('background-color', 'white').style('color', 'gray').style('border', '1px solid gray').style('padding', '3px').style('border-radius', '2px').style('visibility', 'hidden');\n        this.updateSizing();\n        this.queryAndBuild();\n    };\n    // currently broken on deleting a link\n    ExploreComponentController.prototype.highlightLinks = function (d, i) {\n        __WEBPACK_IMPORTED_MODULE_3_d3__[\"selectAll\"]('line').classed('relevant', false);\n        for (var j = 0; j < this.links.length; j++) {\n            var linksource = this.links[j].source;\n            var linktarget = this.links[j].target;\n            if (linksource.index === i || linktarget.index === i) __WEBPACK_IMPORTED_MODULE_3_d3__[\"select\"]('#link-' + j).classed('relevant', true);\n        }\n    };\n    ExploreComponentController.prototype.$onDestroy = function () {\n        this.unsubscribe();\n    };\n    ExploreComponentController.prototype.queryAndBuild = function () {\n        var _this = this;\n        var prom = this.sparqlItemService.getItems(this.fibraService.getState().construct.items, false).then(function (items) {\n            // If we are showing property popovers, hide 'em.\n            _this.propertyPopover.hidePopover();\n            // Lock previous items\n            _this.lockExisting(_this.primaryItems);\n            _this.lockExisting(_this.secondaryItems);\n            _this.lockExisting(_this.tertiaryItems);\n            var displayTypes = _this.types.displayTypes;\n            var currentUntyped = _this.filterItemsByType(items, __WEBPACK_IMPORTED_MODULE_4__models_rdf__[\"d\" /* OWL */].Thing.value);\n            _this.removedUntypedItems = _this.untypedItems.filter(function (it) {\n                return currentUntyped.indexOf(it) === -1;\n            });\n            _this.untypedItems = _this.mergeNodes(_this.untypedItems, _this.filterItemsByType(items, __WEBPACK_IMPORTED_MODULE_4__models_rdf__[\"d\" /* OWL */].Thing.value));\n            if (displayTypes[0]) _this.primaryItems = _this.mergeNodes(_this.primaryItems, _this.filterItemsByType(items, displayTypes[0].id));\n            if (displayTypes[1]) _this.secondaryItems = _this.mergeNodes(_this.secondaryItems, _this.filterItemsByType(items, displayTypes[1].id));\n            if (displayTypes[2]) _this.tertiaryItems = _this.mergeNodes(_this.tertiaryItems, _this.filterItemsByType(items, displayTypes[2].id));\n            _this.allItems = _this.primaryItems.concat(_this.secondaryItems).concat(_this.tertiaryItems).concat(_this.untypedItems);\n            _this.properties = [];\n            if (_this.primaryItems[0] && _this.primaryItems[0].localProperties) {\n                for (var _i = 0, _a = _this.primaryItems[0].localProperties; _i < _a.length; _i++) {\n                    var p = _a[_i];\n                    _this.properties.push({ key: p.toCanonical(), value: p.label });\n                }\n            }\n            _this.links = _this.mergeLinks(_this.links);\n            return 'ok';\n        }).then(function () {\n            return _this.updateExplore();\n        });\n        this.fibraService.dispatchAction(this.fibraService.placeHolderAction(prom));\n        return prom;\n    };\n    ExploreComponentController.prototype.lockExisting = function (nodes) {\n        nodes.forEach(function (node) {\n            node.fx = node.gx;\n            node.fy = node.gy;\n        });\n    };\n    ExploreComponentController.prototype.filterItemsByType = function (items, type) {\n        return items.filter(function (it) {\n            var typeProp = it.localProperties.concat(it.remoteProperties).filter(function (pr) {\n                return pr.value === 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type';\n            });\n            if (typeProp[0]) {\n                return typeProp[0].values.map(function (v) {\n                    return v.value.value;\n                }).indexOf(type) !== -1;\n            } else {\n                return false;\n            }\n        });\n    };\n    ExploreComponentController.prototype.updateSizing = function () {\n        // allow item_info_tip to expand somehow\n        // add delete and alter ability to sparql-item.pug\n        // fix how links sit on top of nodes\n        var viewport_width = window.innerWidth;\n        var viewport_height = window.innerHeight;\n        this.exploreWidth = viewport_width;\n        this.exploreHeight = viewport_height - 36;\n        __WEBPACK_IMPORTED_MODULE_3_d3__[\"select\"](this.$element[0]).select('#explorecontainer').style('height', this.exploreHeight + 'px');\n        // move table down so top is at bottom of viewport\n        __WEBPACK_IMPORTED_MODULE_3_d3__[\"select\"](this.$element[0]).select('#exploretable').style('height', viewport_height - 50 + 'px');\n        this.svgSel.style('width', viewport_width + 'px').style('height', viewport_height - 36 + 'px');\n        this.svgSel.select('rect.background').style('width', viewport_width + 'px').style('height', viewport_height - 36 + 'px');\n        var svg_width = +this.svgSel.style('width').replace('px', '');\n        var svg_height = +this.svgSel.style('height').replace('px', '');\n    };\n    ExploreComponentController.prototype.appendNodes = function (enterSelection, className) {\n        var _this = this;\n        var appendSelection = enterSelection.append('g').attr('id', function (d, i) {\n            return 'node-' + i + '-' + className;\n        }).attr('class', 'node').classed(className, true).append('circle').classed('node-circle', true).classed(className, true).attr('id', function (d, i) {\n            return 'node-circle-' + i + '-' + className;\n        }).attr('r', this.radiusInitial + 'px').call(__WEBPACK_IMPORTED_MODULE_3_d3__[\"drag\"]().on('start', function (d, i) {\n            if (!_this.linkMode) {\n                d.fx = d.x;\n                d.fy = d.y;\n            } else {\n                _this.dragline = _this.svgSel.append('line').attr('class', 'dragLine');\n            }\n        }).on('drag', function (d, i, group) {\n            if (!_this.linkMode) {\n                __WEBPACK_IMPORTED_MODULE_3_d3__[\"select\"](group[i]).classed('fixed', true);\n                d.x = __WEBPACK_IMPORTED_MODULE_3_d3__[\"event\"].x;\n                d.y = __WEBPACK_IMPORTED_MODULE_3_d3__[\"event\"].y;\n            } else {\n                _this.dragline.attr('x1', d.x).attr('y1', d.y).attr('x2', __WEBPACK_IMPORTED_MODULE_3_d3__[\"event\"].x).attr('y2', __WEBPACK_IMPORTED_MODULE_3_d3__[\"event\"].y);\n            }\n            _this.updateExplore(false, false);\n        }).on('end', function (d, i, group) {\n            if (!_this.linkMode) {\n                if (!__WEBPACK_IMPORTED_MODULE_3_d3__[\"select\"](group[i]).classed('fixed')) {\n                    d.fx = undefined;\n                    d.fy = undefined;\n                }\n            } else {\n                var lineX_1 = +_this.dragline.attr('x2');\n                var lineY_1 = +_this.dragline.attr('y2');\n                var nodeDrop_1 = false;\n                __WEBPACK_IMPORTED_MODULE_3_d3__[\"selectAll\"]('.node').each(function (f, j) {\n                    if (Math.abs(lineX_1 - f.x) < _this.radius && Math.abs(lineY_1 - f.y) < _this.radius) {\n                        nodeDrop_1 = true;\n                        _this.fibraService.dispatchAction(_this.itemProperty(f, [new __WEBPACK_IMPORTED_MODULE_0__services_sparql_item_service__[\"a\" /* PropertyAndValue */](__WEBPACK_IMPORTED_MODULE_4__models_rdf__[\"a\" /* SKOS */].related, __WEBPACK_IMPORTED_MODULE_4__models_rdf__[\"b\" /* DataFactory */].instance.nodeFromNode(d))], [])).then(function (state) {\n                            _this.dragline.remove();\n                            _this.queryAndBuild();\n                            return state;\n                        });\n                    }\n                });\n                if (!nodeDrop_1) {\n                    _this.dragline.remove();\n                }\n            }\n        })).on('mouseover', function (d, i) {\n            _this.highlightLinks(d, i);\n            _this.tooltip.style('top', __WEBPACK_IMPORTED_MODULE_3_d3__[\"event\"].pageY - 10 + 'px').style('left', __WEBPACK_IMPORTED_MODULE_3_d3__[\"event\"].pageX + 10 + 'px').style('visibility', 'visible').text(d.label);\n        }).on('mouseout', function (d, i) {\n            _this.svgSel.selectAll('line').classed('relevant', false);\n            _this.tooltip.style('visibility', 'hidden');\n        }).on('click', function (d, i, group) {\n            var localSelected = d.selected;\n            // Unselect everything\n            _this.svgSel.selectAll('.node').each(function (n) {\n                n.selected = false;\n            });\n            // Flip this one\n            d.selected = !localSelected;\n            _this.updateExplore(false);\n            if (d.selected) {\n                _this.svgSel.select('g.sunburst-overlay').datum(d).each(_this.sunburst.buildSunburst.bind(_this)).style('display', 'block');\n            } else {\n                _this.svgSel.select('.sunburst-overlay').style('display', 'none');\n            }\n            _this.highlightLinks(d, i);\n        });\n        appendSelection.transition().attr('r', this.radius + this.radiusBounce + 'px').transition().attr('r', this.radius + 'px');\n        return appendSelection;\n    };\n    ExploreComponentController.prototype.snapToGrid = function (x, y, primary) {\n        if (primary === void 0) {\n            primary = true;\n        }\n        var sx, sy;\n        // Snap to gridOffset with further offset for multiples\n        if (primary) {\n            sx = Math.round(x / this.gridOffset) * this.gridOffset;\n            sy = Math.round(y / this.gridOffset) * this.gridOffset;\n        } else {\n            sx = Math.round(x / this.gridOffset) * this.gridOffset - this.gridOffset / 2;\n            sy = Math.round(y / this.gridOffset) * this.gridOffset - this.gridOffset / 2;\n        }\n        return [sx, sy];\n    };\n    ExploreComponentController.prototype.tickTransformNodes = function (sel, primary) {\n        var _this = this;\n        if (primary === void 0) {\n            primary = true;\n        }\n        sel.attr('transform', function (d, i) {\n            var x = d.x,\n                y = d.y;\n            if (d.x < _this.radius) x = _this.radius;\n            if (d.y < _this.radius) y = _this.radius;\n            var _a = [x, y],\n                gx = _a[0],\n                gy = _a[1];\n            if (_this.$scope.layout.choice === 'forcegrid') {\n                _b = _this.snapToGrid(x, y, primary), gx = _b[0], gy = _b[1];\n            }\n            d.gx = gx;\n            d.gy = gy;\n            return 'translate(' + gx + ', ' + gy + ')';\n            var _b;\n        });\n        if (sel.filter(function (d) {\n            return d.selected;\n        }).node()) {\n            var sbFunc_1 = this.sunburst.buildSunburst;\n            var svgSel_1 = this.svgSel;\n            var tickSunburst = function (d, i, g) {\n                svgSel_1.select('g.sunburst-overlay').datum(d).each(sbFunc_1.bind(this));\n            };\n            sel.filter(function (d) {\n                return d.selected;\n            }).each(tickSunburst.bind(this));\n        }\n    };\n    ExploreComponentController.prototype.genericTick = function (primaryNodes, secondaryNodes, untypedNodes, linkLines, transition) {\n        if (transition === void 0) {\n            transition = false;\n        }\n        var lPrimaryNodes = primaryNodes;\n        var lSecondaryNodes = secondaryNodes;\n        var lUntypedNodes = untypedNodes;\n        var lLinkLines = linkLines;\n        if (transition) {\n            lPrimaryNodes = lPrimaryNodes.transition();\n            lSecondaryNodes = lSecondaryNodes.transition();\n            lUntypedNodes = lUntypedNodes.transition();\n            lLinkLines = lLinkLines.transition();\n        }\n        this.tickTransformNodes(lPrimaryNodes, true);\n        this.tickTransformNodes(lSecondaryNodes, false);\n        this.tickTransformNodes(lUntypedNodes, false);\n        this.svgSel.selectAll('.node-circle').classed('selected-circle', function (d) {\n            return d.selected;\n        }).style('cursor', this.linkMode ? 'crosshair' : 'initial');\n        this.svgSel.selectAll('.node-circle').classed('labeled', function (d) {\n            return d.label ? true : false;\n        }).classed('verified', function (d) {\n            return d.localProperties.filter(function (p) {\n                return p.value === 'http://www.w3.org/2002/07/owl#sameAs';\n            }).length > 0;\n        });\n        lLinkLines.attr('x1', function (d) {\n            return d.source.gx;\n        }).attr('y1', function (d) {\n            return d.source.gy;\n        }).attr('x2', function (d) {\n            return d.target.gx;\n        }).attr('y2', function (d) {\n            return d.target.gy;\n        });\n    };\n    ExploreComponentController.prototype.updateExplore = function (runSim, transition) {\n        var _this = this;\n        if (runSim === void 0) {\n            runSim = true;\n        }\n        if (transition === void 0) {\n            transition = false;\n        }\n        var untypedNodes = this.svgSel.selectAll('circle.untyped').data(this.untypedItems, function (d) {\n            return d.value;\n        });\n        var primaryNodes = this.svgSel.selectAll('circle.primary').data(this.primaryItems, function (d) {\n            return d.value;\n        });\n        var secondaryNodes = this.svgSel.selectAll('circle.secondary').data(this.secondaryItems, function (d) {\n            return d.value;\n        });\n        primaryNodes.exit().remove();\n        secondaryNodes.exit().remove();\n        untypedNodes.exit().remove();\n        // Untyped nodes should come in one at a time based on a user's click event. For these\n        // we also want append the user interface for setting type and label.\n        untypedNodes.enter().each(function (datum, i, g) {\n            datum.x = _this.lastClickX;\n            datum.y = _this.lastClickY;\n            datum.fx = _this.lastClickX;\n            datum.fy = _this.lastClickY;\n            datum.gx = _this.lastClickX;\n            datum.gy = _this.lastClickY;\n        }).each(this.propertyPopover.addPopover.bind(this, this.$scope, this.svgSel));\n        // If a node went from being untyped to being primary or secondary, bring along its position\n        // Also handle position getting set from a drop (pull position from state)\n        var applyOldPosition = function (datum) {\n            // Get position from state if it was set there.\n            datum.x = _this.fibraService.getState().construct.itemIndex[datum.value].x;\n            datum.y = _this.fibraService.getState().construct.itemIndex[datum.value].y;\n            datum.fx = _this.fibraService.getState().construct.itemIndex[datum.value].x;\n            datum.fy = _this.fibraService.getState().construct.itemIndex[datum.value].y;\n            datum.gx = _this.fibraService.getState().construct.itemIndex[datum.value].x;\n            datum.gx = _this.fibraService.getState().construct.itemIndex[datum.value].y;\n            // Or if node was already here, get position from old node\n            var oldNode = _this.removedUntypedItems.filter(function (it) {\n                return it.value === datum.value;\n            })[0];\n            if (oldNode) {\n                datum.x = oldNode.x;\n                datum.y = oldNode.y;\n                datum.fx = oldNode.fx;\n                datum.fy = oldNode.fy;\n                datum.gx = oldNode.gx;\n                datum.gy = oldNode.gy;\n            }\n        };\n        primaryNodes.enter().each(applyOldPosition);\n        secondaryNodes.enter().each(applyOldPosition);\n        primaryNodes = primaryNodes.merge(this.appendNodes(primaryNodes.enter(), 'primary'));\n        secondaryNodes = secondaryNodes.merge(this.appendNodes(secondaryNodes.enter(), 'secondary'));\n        untypedNodes = untypedNodes.merge(this.appendNodes(untypedNodes.enter(), 'untyped'));\n        var linkLines = this.svgSel.select('g.links').selectAll('line').data(this.links);\n        linkLines.exit().remove();\n        linkLines = linkLines.enter().append('line').attr('id', function (d, i) {\n            return 'link-' + i;\n        }).on('mouseover', function (d, i) {\n            _this.tooltip.style('top', __WEBPACK_IMPORTED_MODULE_3_d3__[\"event\"].pageY - 10 + 'px').style('left', __WEBPACK_IMPORTED_MODULE_3_d3__[\"event\"].pageX + 10 + 'px').style('visibility', 'visible').text(d.property.label);\n        }).on('mouseout', function (d, i) {\n            _this.tooltip.style('visibility', 'hidden');\n        }).merge(linkLines).style('visibility', this.$scope.layout.links === 'show' ? 'visible' : 'hidden');\n        // Add sunburst again so it stays on top\n        this.sunburst.addSunburstGroup(this.svgSel);\n        this.genericTick(primaryNodes, secondaryNodes, untypedNodes, linkLines, transition);\n        return this.$q.resolve('ok');\n    };\n    ExploreComponentController.prototype.mapVerifyToThis = function (state) {\n        return {\n            verify: state.verify\n        };\n    };\n    ExploreComponentController.prototype.mapTypesToThis = function (state) {\n        return {\n            types: state.types\n        };\n    };\n    ExploreComponentController.prototype.mapItemsToThis = function (state) {\n        return {\n            items: state.items\n        };\n    };\n    ExploreComponentController.prototype.mergeNodes = function (oldNodes, nodes) {\n        var newNodes = [];\n        // Check if old nodes are still in the mix\n        for (var i = 0; i < oldNodes.length; i++) {\n            for (var j = 0; j < nodes.length; j++) {\n                if (oldNodes[i].toCanonical() === nodes[j].toCanonical()) {\n                    newNodes.push(oldNodes[i]);\n                    // We need to grab new node information like labels and props in case it's changed\n                    oldNodes[i].label = nodes[j].label;\n                    oldNodes[i].localProperties = nodes[j].localProperties;\n                }\n            }\n        }\n        // Add the new nodes\n        for (var i = 0; i < nodes.length; i++) {\n            var check = false;\n            for (var j = 0; j < newNodes.length; j++) {\n                if (newNodes[j].toCanonical() === nodes[i].toCanonical()) check = true;\n            }\n            if (!check) {\n                newNodes.push(nodes[i]);\n            }\n        }\n        return newNodes;\n    };\n    ExploreComponentController.prototype.mergeLinks = function (oldLinks) {\n        var newLinks = [];\n        var items = this.primaryItems.concat(this.secondaryItems);\n        var sameAs = new __WEBPACK_IMPORTED_MODULE_4__models_rdf__[\"e\" /* ENodeMap */]();\n        for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\n            var item = items_1[_i];\n            sameAs.set(item, item);\n            var sameAsProp = item.localProperties.filter(function (p) {\n                return __WEBPACK_IMPORTED_MODULE_4__models_rdf__[\"d\" /* OWL */].sameAs.equals(p);\n            })[0];\n            if (sameAsProp && sameAsProp.values) for (var _a = 0, _b = sameAsProp.values; _a < _b.length; _a++) {\n                var n = _b[_a];\n                sameAs.set(n.value, item);\n            }\n        }\n        // Iterate over item property values to see if they match the id of any\n        // of the items displayed. Also check if they match sameAs values...\n        for (var _c = 0, items_2 = items; _c < items_2.length; _c++) {\n            var item = items_2[_c];\n            for (var _d = 0, _e = item.localProperties; _d < _e.length; _d++) {\n                var p = _e[_d];\n                for (var _f = 0, _g = p.values; _f < _g.length; _f++) {\n                    var v = _g[_f];\n                    if (sameAs.has(v.value) && item !== sameAs.get(v.value) && items.indexOf(sameAs.get(v.value)) !== -1) {\n                        newLinks.push({\n                            source: item,\n                            target: sameAs.get(v.value),\n                            property: p\n                        });\n                    }\n                }\n            }\n        }\n        return newLinks;\n    };\n    return ExploreComponentController;\n}();\nvar ExploreComponent = function () {\n    function ExploreComponent() {\n        this.bindings = {\n            linkMode: '<'\n        };\n        this.controller = ExploreComponentController; // (new (...args: any[]) => angular.IController) = ExploreComponentController\n        this.template = __webpack_require__(\"./app/components/construct-view/explore.pug\")();\n    }\n    return ExploreComponent;\n}();\n\n__WEBPACK_IMPORTED_MODULE_5_angular__[\"module\"]('fibra.components.explore', ['fibra.services']).component('explore', new ExploreComponent());//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvY29tcG9uZW50cy9jb25zdHJ1Y3Qtdmlldy9leHBsb3JlLWNvbXBvbmVudC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hcHAvY29tcG9uZW50cy9jb25zdHJ1Y3Qtdmlldy9leHBsb3JlLWNvbXBvbmVudC50cz85OTJjIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmltcG9ydCB7IFByb3BlcnR5QW5kVmFsdWUgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9zcGFycWwtaXRlbS1zZXJ2aWNlJztcbmltcG9ydCB7IFN1bmJ1cnN0IH0gZnJvbSAnLi9zdW5idXJzdCc7XG5pbXBvcnQgeyBQcm9wZXJ0eVBvcG92ZXIgfSBmcm9tICcuL3Byb3BlcnR5LXBvcG92ZXInO1xuaW1wb3J0ICogYXMgZDMgZnJvbSAnZDMnO1xuaW1wb3J0IHsgT1dMLCBTS09TLCBEYXRhRmFjdG9yeSwgRU5vZGVNYXAgfSBmcm9tICcuLi8uLi9tb2RlbHMvcmRmJztcbmltcG9ydCAqIGFzIGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgKiBhcyBWZXJpZnlBY3Rpb25zIGZyb20gJy4uLy4uL2FjdGlvbnMvdmVyaWZ5JztcbmltcG9ydCAqIGFzIFR5cGVBY3Rpb25zIGZyb20gJy4uLy4uL2FjdGlvbnMvdHlwZXMnO1xuaW1wb3J0ICogYXMgSXRlbUFjdGlvbnMgZnJvbSAnLi4vLi4vYWN0aW9ucy9pdGVtcyc7XG52YXIgRXhwbG9yZUNvbXBvbmVudENvbnRyb2xsZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEV4cGxvcmVDb21wb25lbnRDb250cm9sbGVyKCRlbGVtZW50LCAkY29tcGlsZSwgJHdpbmRvdywgJHNjb3BlLCAkdGltZW91dCwgc3BhcnFsSXRlbVNlcnZpY2UsIGZpYnJhU2VydmljZSwgJG5nUmVkdXgsICRxKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuJGVsZW1lbnQgPSAkZWxlbWVudDtcbiAgICAgICAgdGhpcy4kY29tcGlsZSA9ICRjb21waWxlO1xuICAgICAgICB0aGlzLiR3aW5kb3cgPSAkd2luZG93O1xuICAgICAgICB0aGlzLiRzY29wZSA9ICRzY29wZTtcbiAgICAgICAgdGhpcy4kdGltZW91dCA9ICR0aW1lb3V0O1xuICAgICAgICB0aGlzLnNwYXJxbEl0ZW1TZXJ2aWNlID0gc3BhcnFsSXRlbVNlcnZpY2U7XG4gICAgICAgIHRoaXMuZmlicmFTZXJ2aWNlID0gZmlicmFTZXJ2aWNlO1xuICAgICAgICB0aGlzLiRuZ1JlZHV4ID0gJG5nUmVkdXg7XG4gICAgICAgIHRoaXMuJHEgPSAkcTtcbiAgICAgICAgdGhpcy5wcmltYXJ5SXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy5zZWNvbmRhcnlJdGVtcyA9IFtdO1xuICAgICAgICB0aGlzLnRlcnRpYXJ5SXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy51bnR5cGVkSXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy5yZW1vdmVkVW50eXBlZEl0ZW1zID0gW107XG4gICAgICAgIHRoaXMuYWxsSXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy5yYWRpdXNJbml0aWFsID0gMTtcbiAgICAgICAgdGhpcy5yYWRpdXMgPSA4O1xuICAgICAgICB0aGlzLnJhZGl1c0JvdW5jZSA9IDE1O1xuICAgICAgICB0aGlzLmdyaWRPZmZzZXQgPSA1MDsgLy8gU2hvdWxkIGJlIGV2ZW5cbiAgICAgICAgdGhpcy5jaGFyZ2VGb3JjZSA9IGQzLmZvcmNlQ29sbGlkZSh0aGlzLmdyaWRPZmZzZXQgLyAxLjUpO1xuICAgICAgICB0aGlzLmNoYXJnZUZvcmNlMiA9IGQzLmZvcmNlQ29sbGlkZSh0aGlzLmdyaWRPZmZzZXQgLyAxLjUpO1xuICAgICAgICB0aGlzLnN2Z0JhY2tncm91bmRDb2xvciA9ICcjRUVFJztcbiAgICAgICAgdGhpcy5sYXN0Q2xpY2tYID0gMDtcbiAgICAgICAgdGhpcy5sYXN0Q2xpY2tZID0gMDtcbiAgICAgICAgdmFyIHVuc3ViMSA9ICRuZ1JlZHV4LmNvbm5lY3QodGhpcy5tYXBWZXJpZnlUb1RoaXMsIFZlcmlmeUFjdGlvbnMpKHRoaXMpO1xuICAgICAgICB2YXIgdW5zdWIyID0gJG5nUmVkdXguY29ubmVjdCh0aGlzLm1hcFR5cGVzVG9UaGlzLCBUeXBlQWN0aW9ucykodGhpcyk7XG4gICAgICAgIHZhciB1bnN1YjMgPSAkbmdSZWR1eC5jb25uZWN0KHRoaXMubWFwSXRlbXNUb1RoaXMsIEl0ZW1BY3Rpb25zKSh0aGlzKTtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHVuc3ViMSgpO1xuICAgICAgICAgICAgdW5zdWIyKCk7XG4gICAgICAgICAgICB1bnN1YjMoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zdW5idXJzdCA9IG5ldyBTdW5idXJzdCgkZWxlbWVudCwgJGNvbXBpbGUsICRzY29wZSwgc3BhcnFsSXRlbVNlcnZpY2UsIGZpYnJhU2VydmljZSk7XG4gICAgICAgIHRoaXMucHJvcGVydHlQb3BvdmVyID0gbmV3IFByb3BlcnR5UG9wb3ZlcigkZWxlbWVudCwgJHNjb3BlLCBmaWJyYVNlcnZpY2UsICRjb21waWxlKTtcbiAgICAgICAgdGhpcy5maWJyYVNlcnZpY2Uub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIHRoaXMudmVyaWZ5SXRlbSA9IHRoaXMuZmlicmFTZXJ2aWNlLmdldFN0YXRlKCkuY29uc3RydWN0LnZlcmlmeUl0ZW1cbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5xdWVyeUFuZEJ1aWxkKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLml0ZW1TZXJ2aWNlID0gc3BhcnFsSXRlbVNlcnZpY2U7XG4gICAgICAgIHRoaXMubGlua3MgPSBbXTtcbiAgICAgICAgdGhpcy4kc2NvcGUubGF5b3V0ID0ge1xuICAgICAgICAgICAgJ2Nob2ljZSc6ICdmb3JjZScsXG4gICAgICAgICAgICAnbGlua3MnOiAnaGlkZSdcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy4kc2NvcGUuJHdhdGNoKCdsYXlvdXQuY2hvaWNlJywgdGhpcy51cGRhdGVFeHBsb3JlLmJpbmQodGhpcywgZmFsc2UpKTtcbiAgICAgICAgdGhpcy4kc2NvcGUuJHdhdGNoKCdsYXlvdXQubGlua3MnLCB0aGlzLnVwZGF0ZUV4cGxvcmUuYmluZCh0aGlzLCBmYWxzZSkpO1xuICAgIH1cbiAgICBFeHBsb3JlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUuJG9uQ2hhbmdlcyA9IGZ1bmN0aW9uIChjaG5nc09iaikge1xuICAgICAgICBpZiAodGhpcy5zdmdTZWwpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRXhwbG9yZShmYWxzZSwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBFeHBsb3JlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUuJHBvc3RMaW5rID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN2Z1NlbCA9IGQzLnNlbGVjdCh0aGlzLiRlbGVtZW50WzBdKS5zZWxlY3QoJ3N2ZycpO1xuICAgICAgICB0aGlzLnN2Z1NlbC5hcHBlbmQoJ3JlY3QnKVxuICAgICAgICAgICAgLmNsYXNzZWQoJ2JhY2tncm91bmQnLCB0cnVlKVxuICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgdGhpcy5zdmdCYWNrZ3JvdW5kQ29sb3IpXG4gICAgICAgICAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMubGFzdENsaWNrWCA9IGQzLmV2ZW50Lm9mZnNldFg7XG4gICAgICAgICAgICBfdGhpcy5sYXN0Q2xpY2tZID0gZDMuZXZlbnQub2Zmc2V0WTtcbiAgICAgICAgICAgIF90aGlzLmZpYnJhU2VydmljZS5kaXNwYXRjaEFjdGlvbihfdGhpcy5jcmVhdGVEaXNwbGF5SXRlbSgpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIENyZWF0ZSBsaW5rIGdcbiAgICAgICAgdGhpcy5zdmdTZWwuYXBwZW5kKCdnJykuYXR0cignY2xhc3MnLCAnbGlua3MnKTtcbiAgICAgICAgdGhpcy5zdW5idXJzdC5hZGRTdW5idXJzdEdyb3VwKHRoaXMuc3ZnU2VsKTtcbiAgICAgICAgdGhpcy5yYWRpdXMgPSA4O1xuICAgICAgICB0aGlzLnRvb2x0aXAgPSBkMy5zZWxlY3QoJ2JvZHknKS5hcHBlbmQoJ2RpdicpXG4gICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2Fic29sdXRlJylcbiAgICAgICAgICAgIC5zdHlsZSgnei1pbmRleCcsICcyMCcpXG4gICAgICAgICAgICAuc3R5bGUoJ2JhY2tncm91bmQtY29sb3InLCAnZ3JheScpXG4gICAgICAgICAgICAuc3R5bGUoJ2NvbG9yJywgJ3doaXRlJylcbiAgICAgICAgICAgIC5zdHlsZSgncGFkZGluZycsICczcHgnKVxuICAgICAgICAgICAgLnN0eWxlKCdib3JkZXItcmFkaXVzJywgJzJweCcpXG4gICAgICAgICAgICAuc3R5bGUoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG4gICAgICAgIHRoaXMuZWRpdHRpcCA9IGQzLnNlbGVjdCgnYm9keScpLmFwcGVuZCgnZGl2JylcbiAgICAgICAgICAgIC5hdHRyKCdpZCcsICdlZGl0dGlwJylcbiAgICAgICAgICAgIC5zdHlsZSgncG9zaXRpb24nLCAnYWJzb2x1dGUnKVxuICAgICAgICAgICAgLnN0eWxlKCd6LWluZGV4JywgJzQwJylcbiAgICAgICAgICAgIC5zdHlsZSgnYmFja2dyb3VuZC1jb2xvcicsICd3aGl0ZScpXG4gICAgICAgICAgICAuc3R5bGUoJ2NvbG9yJywgJ2dyYXknKVxuICAgICAgICAgICAgLnN0eWxlKCdib3JkZXInLCAnMXB4IHNvbGlkIGdyYXknKVxuICAgICAgICAgICAgLnN0eWxlKCdwYWRkaW5nJywgJzNweCcpXG4gICAgICAgICAgICAuc3R5bGUoJ2JvcmRlci1yYWRpdXMnLCAnMnB4JylcbiAgICAgICAgICAgIC5zdHlsZSgndmlzaWJpbGl0eScsICdoaWRkZW4nKTtcbiAgICAgICAgdGhpcy51cGRhdGVTaXppbmcoKTtcbiAgICAgICAgdGhpcy5xdWVyeUFuZEJ1aWxkKCk7XG4gICAgfTtcbiAgICAvLyBjdXJyZW50bHkgYnJva2VuIG9uIGRlbGV0aW5nIGEgbGlua1xuICAgIEV4cGxvcmVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS5oaWdobGlnaHRMaW5rcyA9IGZ1bmN0aW9uIChkLCBpKSB7XG4gICAgICAgIGQzLnNlbGVjdEFsbCgnbGluZScpLmNsYXNzZWQoJ3JlbGV2YW50JywgZmFsc2UpO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubGlua3MubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHZhciBsaW5rc291cmNlID0gdGhpcy5saW5rc1tqXS5zb3VyY2U7XG4gICAgICAgICAgICB2YXIgbGlua3RhcmdldCA9IHRoaXMubGlua3Nbal0udGFyZ2V0O1xuICAgICAgICAgICAgaWYgKGxpbmtzb3VyY2UuaW5kZXggPT09IGkgfHwgbGlua3RhcmdldC5pbmRleCA9PT0gaSlcbiAgICAgICAgICAgICAgICBkMy5zZWxlY3QoJyNsaW5rLScgKyBqKS5jbGFzc2VkKCdyZWxldmFudCcsIHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBFeHBsb3JlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUuJG9uRGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpO1xuICAgIH07XG4gICAgRXhwbG9yZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLnF1ZXJ5QW5kQnVpbGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBwcm9tID0gdGhpcy5zcGFycWxJdGVtU2VydmljZS5nZXRJdGVtcyh0aGlzLmZpYnJhU2VydmljZS5nZXRTdGF0ZSgpLmNvbnN0cnVjdC5pdGVtcywgZmFsc2UpLnRoZW4oZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgICAgICAvLyBJZiB3ZSBhcmUgc2hvd2luZyBwcm9wZXJ0eSBwb3BvdmVycywgaGlkZSAnZW0uXG4gICAgICAgICAgICBfdGhpcy5wcm9wZXJ0eVBvcG92ZXIuaGlkZVBvcG92ZXIoKTtcbiAgICAgICAgICAgIC8vIExvY2sgcHJldmlvdXMgaXRlbXNcbiAgICAgICAgICAgIF90aGlzLmxvY2tFeGlzdGluZyhfdGhpcy5wcmltYXJ5SXRlbXMpO1xuICAgICAgICAgICAgX3RoaXMubG9ja0V4aXN0aW5nKF90aGlzLnNlY29uZGFyeUl0ZW1zKTtcbiAgICAgICAgICAgIF90aGlzLmxvY2tFeGlzdGluZyhfdGhpcy50ZXJ0aWFyeUl0ZW1zKTtcbiAgICAgICAgICAgIHZhciBkaXNwbGF5VHlwZXMgPSBfdGhpcy50eXBlcy5kaXNwbGF5VHlwZXM7XG4gICAgICAgICAgICB2YXIgY3VycmVudFVudHlwZWQgPSBfdGhpcy5maWx0ZXJJdGVtc0J5VHlwZShpdGVtcywgT1dMLlRoaW5nLnZhbHVlKTtcbiAgICAgICAgICAgIF90aGlzLnJlbW92ZWRVbnR5cGVkSXRlbXMgPSBfdGhpcy51bnR5cGVkSXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChpdCkgeyByZXR1cm4gY3VycmVudFVudHlwZWQuaW5kZXhPZihpdCkgPT09IC0xOyB9KTtcbiAgICAgICAgICAgIF90aGlzLnVudHlwZWRJdGVtcyA9IF90aGlzLm1lcmdlTm9kZXMoX3RoaXMudW50eXBlZEl0ZW1zLCBfdGhpcy5maWx0ZXJJdGVtc0J5VHlwZShpdGVtcywgT1dMLlRoaW5nLnZhbHVlKSk7XG4gICAgICAgICAgICBpZiAoZGlzcGxheVR5cGVzWzBdKVxuICAgICAgICAgICAgICAgIF90aGlzLnByaW1hcnlJdGVtcyA9IF90aGlzLm1lcmdlTm9kZXMoX3RoaXMucHJpbWFyeUl0ZW1zLCBfdGhpcy5maWx0ZXJJdGVtc0J5VHlwZShpdGVtcywgZGlzcGxheVR5cGVzWzBdLmlkKSk7XG4gICAgICAgICAgICBpZiAoZGlzcGxheVR5cGVzWzFdKVxuICAgICAgICAgICAgICAgIF90aGlzLnNlY29uZGFyeUl0ZW1zID0gX3RoaXMubWVyZ2VOb2RlcyhfdGhpcy5zZWNvbmRhcnlJdGVtcywgX3RoaXMuZmlsdGVySXRlbXNCeVR5cGUoaXRlbXMsIGRpc3BsYXlUeXBlc1sxXS5pZCkpO1xuICAgICAgICAgICAgaWYgKGRpc3BsYXlUeXBlc1syXSlcbiAgICAgICAgICAgICAgICBfdGhpcy50ZXJ0aWFyeUl0ZW1zID0gX3RoaXMubWVyZ2VOb2RlcyhfdGhpcy50ZXJ0aWFyeUl0ZW1zLCBfdGhpcy5maWx0ZXJJdGVtc0J5VHlwZShpdGVtcywgZGlzcGxheVR5cGVzWzJdLmlkKSk7XG4gICAgICAgICAgICBfdGhpcy5hbGxJdGVtcyA9IF90aGlzLnByaW1hcnlJdGVtcy5jb25jYXQoX3RoaXMuc2Vjb25kYXJ5SXRlbXMpLmNvbmNhdChfdGhpcy50ZXJ0aWFyeUl0ZW1zKS5jb25jYXQoX3RoaXMudW50eXBlZEl0ZW1zKTtcbiAgICAgICAgICAgIF90aGlzLnByb3BlcnRpZXMgPSBbXTtcbiAgICAgICAgICAgIGlmIChfdGhpcy5wcmltYXJ5SXRlbXNbMF0gJiYgX3RoaXMucHJpbWFyeUl0ZW1zWzBdLmxvY2FsUHJvcGVydGllcykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBfdGhpcy5wcmltYXJ5SXRlbXNbMF0ubG9jYWxQcm9wZXJ0aWVzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucHJvcGVydGllcy5wdXNoKHsga2V5OiBwLnRvQ2Fub25pY2FsKCksIHZhbHVlOiBwLmxhYmVsIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLmxpbmtzID0gX3RoaXMubWVyZ2VMaW5rcyhfdGhpcy5saW5rcyk7XG4gICAgICAgICAgICByZXR1cm4gJ29rJztcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy51cGRhdGVFeHBsb3JlKCk7IH0pO1xuICAgICAgICB0aGlzLmZpYnJhU2VydmljZS5kaXNwYXRjaEFjdGlvbih0aGlzLmZpYnJhU2VydmljZS5wbGFjZUhvbGRlckFjdGlvbihwcm9tKSk7XG4gICAgICAgIHJldHVybiBwcm9tO1xuICAgIH07XG4gICAgRXhwbG9yZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLmxvY2tFeGlzdGluZyA9IGZ1bmN0aW9uIChub2Rlcykge1xuICAgICAgICBub2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICBub2RlLmZ4ID0gbm9kZS5neDtcbiAgICAgICAgICAgIG5vZGUuZnkgPSBub2RlLmd5O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEV4cGxvcmVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS5maWx0ZXJJdGVtc0J5VHlwZSA9IGZ1bmN0aW9uIChpdGVtcywgdHlwZSkge1xuICAgICAgICByZXR1cm4gaXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChpdCkge1xuICAgICAgICAgICAgdmFyIHR5cGVQcm9wID0gaXQubG9jYWxQcm9wZXJ0aWVzLmNvbmNhdChpdC5yZW1vdGVQcm9wZXJ0aWVzKS5maWx0ZXIoZnVuY3Rpb24gKHByKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByLnZhbHVlID09PSAnaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zI3R5cGUnO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAodHlwZVByb3BbMF0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZVByb3BbMF0udmFsdWVzLm1hcChmdW5jdGlvbiAodikgeyByZXR1cm4gdi52YWx1ZS52YWx1ZTsgfSkuaW5kZXhPZih0eXBlKSAhPT0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRXhwbG9yZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLnVwZGF0ZVNpemluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gYWxsb3cgaXRlbV9pbmZvX3RpcCB0byBleHBhbmQgc29tZWhvd1xuICAgICAgICAvLyBhZGQgZGVsZXRlIGFuZCBhbHRlciBhYmlsaXR5IHRvIHNwYXJxbC1pdGVtLnB1Z1xuICAgICAgICAvLyBmaXggaG93IGxpbmtzIHNpdCBvbiB0b3Agb2Ygbm9kZXNcbiAgICAgICAgdmFyIHZpZXdwb3J0X3dpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICAgIHZhciB2aWV3cG9ydF9oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgICAgIHRoaXMuZXhwbG9yZVdpZHRoID0gdmlld3BvcnRfd2lkdGg7XG4gICAgICAgIHRoaXMuZXhwbG9yZUhlaWdodCA9IHZpZXdwb3J0X2hlaWdodCAtIDM2O1xuICAgICAgICBkMy5zZWxlY3QodGhpcy4kZWxlbWVudFswXSkuc2VsZWN0KCcjZXhwbG9yZWNvbnRhaW5lcicpXG4gICAgICAgICAgICAuc3R5bGUoJ2hlaWdodCcsIHRoaXMuZXhwbG9yZUhlaWdodCArICdweCcpO1xuICAgICAgICAvLyBtb3ZlIHRhYmxlIGRvd24gc28gdG9wIGlzIGF0IGJvdHRvbSBvZiB2aWV3cG9ydFxuICAgICAgICBkMy5zZWxlY3QodGhpcy4kZWxlbWVudFswXSkuc2VsZWN0KCcjZXhwbG9yZXRhYmxlJylcbiAgICAgICAgICAgIC5zdHlsZSgnaGVpZ2h0Jywgdmlld3BvcnRfaGVpZ2h0IC0gNTAgKyAncHgnKTtcbiAgICAgICAgdGhpcy5zdmdTZWwuc3R5bGUoJ3dpZHRoJywgdmlld3BvcnRfd2lkdGggKyAncHgnKVxuICAgICAgICAgICAgLnN0eWxlKCdoZWlnaHQnLCB2aWV3cG9ydF9oZWlnaHQgLSAzNiArICdweCcpO1xuICAgICAgICB0aGlzLnN2Z1NlbC5zZWxlY3QoJ3JlY3QuYmFja2dyb3VuZCcpXG4gICAgICAgICAgICAuc3R5bGUoJ3dpZHRoJywgdmlld3BvcnRfd2lkdGggKyAncHgnKVxuICAgICAgICAgICAgLnN0eWxlKCdoZWlnaHQnLCB2aWV3cG9ydF9oZWlnaHQgLSAzNiArICdweCcpO1xuICAgICAgICB2YXIgc3ZnX3dpZHRoID0gK3RoaXMuc3ZnU2VsLnN0eWxlKCd3aWR0aCcpLnJlcGxhY2UoJ3B4JywgJycpO1xuICAgICAgICB2YXIgc3ZnX2hlaWdodCA9ICt0aGlzLnN2Z1NlbC5zdHlsZSgnaGVpZ2h0JykucmVwbGFjZSgncHgnLCAnJyk7XG4gICAgfTtcbiAgICBFeHBsb3JlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUuYXBwZW5kTm9kZXMgPSBmdW5jdGlvbiAoZW50ZXJTZWxlY3Rpb24sIGNsYXNzTmFtZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgYXBwZW5kU2VsZWN0aW9uID0gZW50ZXJTZWxlY3Rpb24uYXBwZW5kKCdnJylcbiAgICAgICAgICAgIC5hdHRyKCdpZCcsIGZ1bmN0aW9uIChkLCBpKSB7IHJldHVybiAnbm9kZS0nICsgaSArICctJyArIGNsYXNzTmFtZTsgfSlcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdub2RlJylcbiAgICAgICAgICAgIC5jbGFzc2VkKGNsYXNzTmFtZSwgdHJ1ZSlcbiAgICAgICAgICAgIC5hcHBlbmQoJ2NpcmNsZScpXG4gICAgICAgICAgICAuY2xhc3NlZCgnbm9kZS1jaXJjbGUnLCB0cnVlKVxuICAgICAgICAgICAgLmNsYXNzZWQoY2xhc3NOYW1lLCB0cnVlKVxuICAgICAgICAgICAgLmF0dHIoJ2lkJywgZnVuY3Rpb24gKGQsIGkpIHsgcmV0dXJuICdub2RlLWNpcmNsZS0nICsgaSArICctJyArIGNsYXNzTmFtZTsgfSlcbiAgICAgICAgICAgIC5hdHRyKCdyJywgdGhpcy5yYWRpdXNJbml0aWFsICsgJ3B4JylcbiAgICAgICAgICAgIC5jYWxsKGQzLmRyYWcoKVxuICAgICAgICAgICAgLm9uKCdzdGFydCcsIGZ1bmN0aW9uIChkLCBpKSB7XG4gICAgICAgICAgICBpZiAoIV90aGlzLmxpbmtNb2RlKSB7XG4gICAgICAgICAgICAgICAgZC5meCA9IGQueDtcbiAgICAgICAgICAgICAgICBkLmZ5ID0gZC55O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuZHJhZ2xpbmUgPSBfdGhpcy5zdmdTZWwuYXBwZW5kKCdsaW5lJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2RyYWdMaW5lJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ2RyYWcnLCBmdW5jdGlvbiAoZCwgaSwgZ3JvdXApIHtcbiAgICAgICAgICAgIGlmICghX3RoaXMubGlua01vZGUpIHtcbiAgICAgICAgICAgICAgICBkMy5zZWxlY3QoZ3JvdXBbaV0pLmNsYXNzZWQoJ2ZpeGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgZC54ID0gZDMuZXZlbnQueDtcbiAgICAgICAgICAgICAgICBkLnkgPSBkMy5ldmVudC55O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuZHJhZ2xpbmUuYXR0cigneDEnLCBkLngpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGQueSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZDMuZXZlbnQueClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZDMuZXZlbnQueSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy51cGRhdGVFeHBsb3JlKGZhbHNlLCBmYWxzZSk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ2VuZCcsIGZ1bmN0aW9uIChkLCBpLCBncm91cCkge1xuICAgICAgICAgICAgaWYgKCFfdGhpcy5saW5rTW9kZSkge1xuICAgICAgICAgICAgICAgIGlmICghZDMuc2VsZWN0KGdyb3VwW2ldKS5jbGFzc2VkKCdmaXhlZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuZnggPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIGQuZnkgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmVYXzEgPSArX3RoaXMuZHJhZ2xpbmUuYXR0cigneDInKTtcbiAgICAgICAgICAgICAgICB2YXIgbGluZVlfMSA9ICtfdGhpcy5kcmFnbGluZS5hdHRyKCd5MicpO1xuICAgICAgICAgICAgICAgIHZhciBub2RlRHJvcF8xID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0QWxsKCcubm9kZScpXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uIChmLCBqKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhsaW5lWF8xIC0gZi54KSA8IF90aGlzLnJhZGl1cyAmJiBNYXRoLmFicyhsaW5lWV8xIC0gZi55KSA8IF90aGlzLnJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURyb3BfMSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5maWJyYVNlcnZpY2UuZGlzcGF0Y2hBY3Rpb24oX3RoaXMuaXRlbVByb3BlcnR5KGYsIFtuZXcgUHJvcGVydHlBbmRWYWx1ZShTS09TLnJlbGF0ZWQsIERhdGFGYWN0b3J5Lmluc3RhbmNlLm5vZGVGcm9tTm9kZShkKSldLCBbXSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZHJhZ2xpbmUucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVlcnlBbmRCdWlsZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFub2RlRHJvcF8xKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmRyYWdsaW5lLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpXG4gICAgICAgICAgICAub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uIChkLCBpKSB7XG4gICAgICAgICAgICBfdGhpcy5oaWdobGlnaHRMaW5rcyhkLCBpKTtcbiAgICAgICAgICAgIF90aGlzLnRvb2x0aXAuc3R5bGUoJ3RvcCcsIChkMy5ldmVudC5wYWdlWSAtIDEwKSArICdweCcpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdsZWZ0JywgKGQzLmV2ZW50LnBhZ2VYICsgMTApICsgJ3B4JylcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpXG4gICAgICAgICAgICAgICAgLnRleHQoZC5sYWJlbCk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ21vdXNlb3V0JywgZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgICAgIF90aGlzLnN2Z1NlbC5zZWxlY3RBbGwoJ2xpbmUnKS5jbGFzc2VkKCdyZWxldmFudCcsIGZhbHNlKTtcbiAgICAgICAgICAgIF90aGlzLnRvb2x0aXAuc3R5bGUoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24gKGQsIGksIGdyb3VwKSB7XG4gICAgICAgICAgICB2YXIgbG9jYWxTZWxlY3RlZCA9IGQuc2VsZWN0ZWQ7XG4gICAgICAgICAgICAvLyBVbnNlbGVjdCBldmVyeXRoaW5nXG4gICAgICAgICAgICBfdGhpcy5zdmdTZWwuc2VsZWN0QWxsKCcubm9kZScpXG4gICAgICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24gKG4pIHsgbi5zZWxlY3RlZCA9IGZhbHNlOyB9KTtcbiAgICAgICAgICAgIC8vIEZsaXAgdGhpcyBvbmVcbiAgICAgICAgICAgIGQuc2VsZWN0ZWQgPSAhbG9jYWxTZWxlY3RlZDtcbiAgICAgICAgICAgIF90aGlzLnVwZGF0ZUV4cGxvcmUoZmFsc2UpO1xuICAgICAgICAgICAgaWYgKGQuc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5zdmdTZWwuc2VsZWN0KCdnLnN1bmJ1cnN0LW92ZXJsYXknKVxuICAgICAgICAgICAgICAgICAgICAuZGF0dW0oZClcbiAgICAgICAgICAgICAgICAgICAgLmVhY2goX3RoaXMuc3VuYnVyc3QuYnVpbGRTdW5idXJzdC5iaW5kKF90aGlzKSlcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdkaXNwbGF5JywgJ2Jsb2NrJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5zdmdTZWwuc2VsZWN0KCcuc3VuYnVyc3Qtb3ZlcmxheScpLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLmhpZ2hsaWdodExpbmtzKGQsIGkpO1xuICAgICAgICB9KTtcbiAgICAgICAgYXBwZW5kU2VsZWN0aW9uXG4gICAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAuYXR0cigncicsICh0aGlzLnJhZGl1cyArIHRoaXMucmFkaXVzQm91bmNlKSArICdweCcpXG4gICAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAuYXR0cigncicsIHRoaXMucmFkaXVzICsgJ3B4Jyk7XG4gICAgICAgIHJldHVybiBhcHBlbmRTZWxlY3Rpb247XG4gICAgfTtcbiAgICBFeHBsb3JlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUuc25hcFRvR3JpZCA9IGZ1bmN0aW9uICh4LCB5LCBwcmltYXJ5KSB7XG4gICAgICAgIGlmIChwcmltYXJ5ID09PSB2b2lkIDApIHsgcHJpbWFyeSA9IHRydWU7IH1cbiAgICAgICAgdmFyIHN4LCBzeTtcbiAgICAgICAgLy8gU25hcCB0byBncmlkT2Zmc2V0IHdpdGggZnVydGhlciBvZmZzZXQgZm9yIG11bHRpcGxlc1xuICAgICAgICBpZiAocHJpbWFyeSkge1xuICAgICAgICAgICAgc3ggPSBNYXRoLnJvdW5kKHggLyB0aGlzLmdyaWRPZmZzZXQpICogdGhpcy5ncmlkT2Zmc2V0O1xuICAgICAgICAgICAgc3kgPSBNYXRoLnJvdW5kKHkgLyB0aGlzLmdyaWRPZmZzZXQpICogdGhpcy5ncmlkT2Zmc2V0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3ggPSBNYXRoLnJvdW5kKHggLyB0aGlzLmdyaWRPZmZzZXQpICogdGhpcy5ncmlkT2Zmc2V0IC0gdGhpcy5ncmlkT2Zmc2V0IC8gMjtcbiAgICAgICAgICAgIHN5ID0gTWF0aC5yb3VuZCh5IC8gdGhpcy5ncmlkT2Zmc2V0KSAqIHRoaXMuZ3JpZE9mZnNldCAtIHRoaXMuZ3JpZE9mZnNldCAvIDI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtzeCwgc3ldO1xuICAgIH07XG4gICAgRXhwbG9yZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLnRpY2tUcmFuc2Zvcm1Ob2RlcyA9IGZ1bmN0aW9uIChzZWwsIHByaW1hcnkpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHByaW1hcnkgPT09IHZvaWQgMCkgeyBwcmltYXJ5ID0gdHJ1ZTsgfVxuICAgICAgICBzZWwuYXR0cigndHJhbnNmb3JtJywgZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgICAgIHZhciB4ID0gZC54LCB5ID0gZC55O1xuICAgICAgICAgICAgaWYgKGQueCA8IF90aGlzLnJhZGl1cylcbiAgICAgICAgICAgICAgICB4ID0gX3RoaXMucmFkaXVzO1xuICAgICAgICAgICAgaWYgKGQueSA8IF90aGlzLnJhZGl1cylcbiAgICAgICAgICAgICAgICB5ID0gX3RoaXMucmFkaXVzO1xuICAgICAgICAgICAgdmFyIF9hID0gW3gsIHldLCBneCA9IF9hWzBdLCBneSA9IF9hWzFdO1xuICAgICAgICAgICAgaWYgKF90aGlzLiRzY29wZS5sYXlvdXQuY2hvaWNlID09PSAnZm9yY2VncmlkJykge1xuICAgICAgICAgICAgICAgIF9iID0gX3RoaXMuc25hcFRvR3JpZCh4LCB5LCBwcmltYXJ5KSwgZ3ggPSBfYlswXSwgZ3kgPSBfYlsxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGQuZ3ggPSBneDtcbiAgICAgICAgICAgIGQuZ3kgPSBneTtcbiAgICAgICAgICAgIHJldHVybiAndHJhbnNsYXRlKCcgKyBneCArICcsICcgKyBneSArICcpJztcbiAgICAgICAgICAgIHZhciBfYjtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChzZWwuZmlsdGVyKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLnNlbGVjdGVkOyB9KS5ub2RlKCkpIHtcbiAgICAgICAgICAgIHZhciBzYkZ1bmNfMSA9IHRoaXMuc3VuYnVyc3QuYnVpbGRTdW5idXJzdDtcbiAgICAgICAgICAgIHZhciBzdmdTZWxfMSA9IHRoaXMuc3ZnU2VsO1xuICAgICAgICAgICAgdmFyIHRpY2tTdW5idXJzdCA9IGZ1bmN0aW9uIChkLCBpLCBnKSB7XG4gICAgICAgICAgICAgICAgc3ZnU2VsXzEuc2VsZWN0KCdnLnN1bmJ1cnN0LW92ZXJsYXknKS5kYXR1bShkKS5lYWNoKHNiRnVuY18xLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHNlbC5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuc2VsZWN0ZWQ7IH0pXG4gICAgICAgICAgICAgICAgLmVhY2godGlja1N1bmJ1cnN0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBFeHBsb3JlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUuZ2VuZXJpY1RpY2sgPSBmdW5jdGlvbiAocHJpbWFyeU5vZGVzLCBzZWNvbmRhcnlOb2RlcywgdW50eXBlZE5vZGVzLCBsaW5rTGluZXMsIHRyYW5zaXRpb24pIHtcbiAgICAgICAgaWYgKHRyYW5zaXRpb24gPT09IHZvaWQgMCkgeyB0cmFuc2l0aW9uID0gZmFsc2U7IH1cbiAgICAgICAgdmFyIGxQcmltYXJ5Tm9kZXMgPSBwcmltYXJ5Tm9kZXM7XG4gICAgICAgIHZhciBsU2Vjb25kYXJ5Tm9kZXMgPSBzZWNvbmRhcnlOb2RlcztcbiAgICAgICAgdmFyIGxVbnR5cGVkTm9kZXMgPSB1bnR5cGVkTm9kZXM7XG4gICAgICAgIHZhciBsTGlua0xpbmVzID0gbGlua0xpbmVzO1xuICAgICAgICBpZiAodHJhbnNpdGlvbikge1xuICAgICAgICAgICAgbFByaW1hcnlOb2RlcyA9IGxQcmltYXJ5Tm9kZXMudHJhbnNpdGlvbigpO1xuICAgICAgICAgICAgbFNlY29uZGFyeU5vZGVzID0gbFNlY29uZGFyeU5vZGVzLnRyYW5zaXRpb24oKTtcbiAgICAgICAgICAgIGxVbnR5cGVkTm9kZXMgPSBsVW50eXBlZE5vZGVzLnRyYW5zaXRpb24oKTtcbiAgICAgICAgICAgIGxMaW5rTGluZXMgPSBsTGlua0xpbmVzLnRyYW5zaXRpb24oKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRpY2tUcmFuc2Zvcm1Ob2RlcyhsUHJpbWFyeU5vZGVzLCB0cnVlKTtcbiAgICAgICAgdGhpcy50aWNrVHJhbnNmb3JtTm9kZXMobFNlY29uZGFyeU5vZGVzLCBmYWxzZSk7XG4gICAgICAgIHRoaXMudGlja1RyYW5zZm9ybU5vZGVzKGxVbnR5cGVkTm9kZXMsIGZhbHNlKTtcbiAgICAgICAgdGhpcy5zdmdTZWwuc2VsZWN0QWxsKCcubm9kZS1jaXJjbGUnKVxuICAgICAgICAgICAgLmNsYXNzZWQoJ3NlbGVjdGVkLWNpcmNsZScsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLnNlbGVjdGVkOyB9KVxuICAgICAgICAgICAgLnN0eWxlKCdjdXJzb3InLCB0aGlzLmxpbmtNb2RlID8gJ2Nyb3NzaGFpcicgOiAnaW5pdGlhbCcpO1xuICAgICAgICB0aGlzLnN2Z1NlbC5zZWxlY3RBbGwoJy5ub2RlLWNpcmNsZScpXG4gICAgICAgICAgICAuY2xhc3NlZCgnbGFiZWxlZCcsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmxhYmVsID8gdHJ1ZSA6IGZhbHNlOyB9KVxuICAgICAgICAgICAgLmNsYXNzZWQoJ3ZlcmlmaWVkJywgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQubG9jYWxQcm9wZXJ0aWVzLmZpbHRlcihmdW5jdGlvbiAocCkgeyByZXR1cm4gcC52YWx1ZSA9PT0gJ2h0dHA6Ly93d3cudzMub3JnLzIwMDIvMDcvb3dsI3NhbWVBcyc7IH0pLmxlbmd0aCA+IDA7IH0pO1xuICAgICAgICBsTGlua0xpbmVzXG4gICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5zb3VyY2UuZ3g7IH0pXG4gICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5zb3VyY2UuZ3k7IH0pXG4gICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC50YXJnZXQuZ3g7IH0pXG4gICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC50YXJnZXQuZ3k7IH0pO1xuICAgIH07XG4gICAgRXhwbG9yZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLnVwZGF0ZUV4cGxvcmUgPSBmdW5jdGlvbiAocnVuU2ltLCB0cmFuc2l0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChydW5TaW0gPT09IHZvaWQgMCkgeyBydW5TaW0gPSB0cnVlOyB9XG4gICAgICAgIGlmICh0cmFuc2l0aW9uID09PSB2b2lkIDApIHsgdHJhbnNpdGlvbiA9IGZhbHNlOyB9XG4gICAgICAgIHZhciB1bnR5cGVkTm9kZXMgPSB0aGlzLnN2Z1NlbFxuICAgICAgICAgICAgLnNlbGVjdEFsbCgnY2lyY2xlLnVudHlwZWQnKVxuICAgICAgICAgICAgLmRhdGEodGhpcy51bnR5cGVkSXRlbXMsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLnZhbHVlOyB9KTtcbiAgICAgICAgdmFyIHByaW1hcnlOb2RlcyA9IHRoaXMuc3ZnU2VsXG4gICAgICAgICAgICAuc2VsZWN0QWxsKCdjaXJjbGUucHJpbWFyeScpXG4gICAgICAgICAgICAuZGF0YSh0aGlzLnByaW1hcnlJdGVtcywgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQudmFsdWU7IH0pO1xuICAgICAgICB2YXIgc2Vjb25kYXJ5Tm9kZXMgPSB0aGlzLnN2Z1NlbFxuICAgICAgICAgICAgLnNlbGVjdEFsbCgnY2lyY2xlLnNlY29uZGFyeScpXG4gICAgICAgICAgICAuZGF0YSh0aGlzLnNlY29uZGFyeUl0ZW1zLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC52YWx1ZTsgfSk7XG4gICAgICAgIHByaW1hcnlOb2Rlcy5leGl0KCkucmVtb3ZlKCk7XG4gICAgICAgIHNlY29uZGFyeU5vZGVzLmV4aXQoKS5yZW1vdmUoKTtcbiAgICAgICAgdW50eXBlZE5vZGVzLmV4aXQoKS5yZW1vdmUoKTtcbiAgICAgICAgLy8gVW50eXBlZCBub2RlcyBzaG91bGQgY29tZSBpbiBvbmUgYXQgYSB0aW1lIGJhc2VkIG9uIGEgdXNlcidzIGNsaWNrIGV2ZW50LiBGb3IgdGhlc2VcbiAgICAgICAgLy8gd2UgYWxzbyB3YW50IGFwcGVuZCB0aGUgdXNlciBpbnRlcmZhY2UgZm9yIHNldHRpbmcgdHlwZSBhbmQgbGFiZWwuXG4gICAgICAgIHVudHlwZWROb2Rlcy5lbnRlcigpLmVhY2goZnVuY3Rpb24gKGRhdHVtLCBpLCBnKSB7XG4gICAgICAgICAgICBkYXR1bS54ID0gX3RoaXMubGFzdENsaWNrWDtcbiAgICAgICAgICAgIGRhdHVtLnkgPSBfdGhpcy5sYXN0Q2xpY2tZO1xuICAgICAgICAgICAgZGF0dW0uZnggPSBfdGhpcy5sYXN0Q2xpY2tYO1xuICAgICAgICAgICAgZGF0dW0uZnkgPSBfdGhpcy5sYXN0Q2xpY2tZO1xuICAgICAgICAgICAgZGF0dW0uZ3ggPSBfdGhpcy5sYXN0Q2xpY2tYO1xuICAgICAgICAgICAgZGF0dW0uZ3kgPSBfdGhpcy5sYXN0Q2xpY2tZO1xuICAgICAgICB9KS5lYWNoKHRoaXMucHJvcGVydHlQb3BvdmVyLmFkZFBvcG92ZXIuYmluZCh0aGlzLCB0aGlzLiRzY29wZSwgdGhpcy5zdmdTZWwpKTtcbiAgICAgICAgLy8gSWYgYSBub2RlIHdlbnQgZnJvbSBiZWluZyB1bnR5cGVkIHRvIGJlaW5nIHByaW1hcnkgb3Igc2Vjb25kYXJ5LCBicmluZyBhbG9uZyBpdHMgcG9zaXRpb25cbiAgICAgICAgLy8gQWxzbyBoYW5kbGUgcG9zaXRpb24gZ2V0dGluZyBzZXQgZnJvbSBhIGRyb3AgKHB1bGwgcG9zaXRpb24gZnJvbSBzdGF0ZSlcbiAgICAgICAgdmFyIGFwcGx5T2xkUG9zaXRpb24gPSBmdW5jdGlvbiAoZGF0dW0pIHtcbiAgICAgICAgICAgIC8vIEdldCBwb3NpdGlvbiBmcm9tIHN0YXRlIGlmIGl0IHdhcyBzZXQgdGhlcmUuXG4gICAgICAgICAgICBkYXR1bS54ID0gX3RoaXMuZmlicmFTZXJ2aWNlLmdldFN0YXRlKCkuY29uc3RydWN0Lml0ZW1JbmRleFtkYXR1bS52YWx1ZV0ueDtcbiAgICAgICAgICAgIGRhdHVtLnkgPSBfdGhpcy5maWJyYVNlcnZpY2UuZ2V0U3RhdGUoKS5jb25zdHJ1Y3QuaXRlbUluZGV4W2RhdHVtLnZhbHVlXS55O1xuICAgICAgICAgICAgZGF0dW0uZnggPSBfdGhpcy5maWJyYVNlcnZpY2UuZ2V0U3RhdGUoKS5jb25zdHJ1Y3QuaXRlbUluZGV4W2RhdHVtLnZhbHVlXS54O1xuICAgICAgICAgICAgZGF0dW0uZnkgPSBfdGhpcy5maWJyYVNlcnZpY2UuZ2V0U3RhdGUoKS5jb25zdHJ1Y3QuaXRlbUluZGV4W2RhdHVtLnZhbHVlXS55O1xuICAgICAgICAgICAgZGF0dW0uZ3ggPSBfdGhpcy5maWJyYVNlcnZpY2UuZ2V0U3RhdGUoKS5jb25zdHJ1Y3QuaXRlbUluZGV4W2RhdHVtLnZhbHVlXS54O1xuICAgICAgICAgICAgZGF0dW0uZ3ggPSBfdGhpcy5maWJyYVNlcnZpY2UuZ2V0U3RhdGUoKS5jb25zdHJ1Y3QuaXRlbUluZGV4W2RhdHVtLnZhbHVlXS55O1xuICAgICAgICAgICAgLy8gT3IgaWYgbm9kZSB3YXMgYWxyZWFkeSBoZXJlLCBnZXQgcG9zaXRpb24gZnJvbSBvbGQgbm9kZVxuICAgICAgICAgICAgdmFyIG9sZE5vZGUgPSBfdGhpcy5yZW1vdmVkVW50eXBlZEl0ZW1zLmZpbHRlcihmdW5jdGlvbiAoaXQpIHsgcmV0dXJuIGl0LnZhbHVlID09PSBkYXR1bS52YWx1ZTsgfSlbMF07XG4gICAgICAgICAgICBpZiAob2xkTm9kZSkge1xuICAgICAgICAgICAgICAgIGRhdHVtLnggPSBvbGROb2RlLng7XG4gICAgICAgICAgICAgICAgZGF0dW0ueSA9IG9sZE5vZGUueTtcbiAgICAgICAgICAgICAgICBkYXR1bS5meCA9IG9sZE5vZGUuZng7XG4gICAgICAgICAgICAgICAgZGF0dW0uZnkgPSBvbGROb2RlLmZ5O1xuICAgICAgICAgICAgICAgIGRhdHVtLmd4ID0gb2xkTm9kZS5neDtcbiAgICAgICAgICAgICAgICBkYXR1bS5neSA9IG9sZE5vZGUuZ3k7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHByaW1hcnlOb2Rlcy5lbnRlcigpLmVhY2goYXBwbHlPbGRQb3NpdGlvbik7XG4gICAgICAgIHNlY29uZGFyeU5vZGVzLmVudGVyKCkuZWFjaChhcHBseU9sZFBvc2l0aW9uKTtcbiAgICAgICAgcHJpbWFyeU5vZGVzID0gcHJpbWFyeU5vZGVzLm1lcmdlKHRoaXMuYXBwZW5kTm9kZXMocHJpbWFyeU5vZGVzLmVudGVyKCksICdwcmltYXJ5JykpO1xuICAgICAgICBzZWNvbmRhcnlOb2RlcyA9IHNlY29uZGFyeU5vZGVzLm1lcmdlKHRoaXMuYXBwZW5kTm9kZXMoc2Vjb25kYXJ5Tm9kZXMuZW50ZXIoKSwgJ3NlY29uZGFyeScpKTtcbiAgICAgICAgdW50eXBlZE5vZGVzID0gdW50eXBlZE5vZGVzLm1lcmdlKHRoaXMuYXBwZW5kTm9kZXModW50eXBlZE5vZGVzLmVudGVyKCksICd1bnR5cGVkJykpO1xuICAgICAgICB2YXIgbGlua0xpbmVzID0gdGhpcy5zdmdTZWxcbiAgICAgICAgICAgIC5zZWxlY3QoJ2cubGlua3MnKVxuICAgICAgICAgICAgLnNlbGVjdEFsbCgnbGluZScpXG4gICAgICAgICAgICAuZGF0YSh0aGlzLmxpbmtzKTtcbiAgICAgICAgbGlua0xpbmVzLmV4aXQoKS5yZW1vdmUoKTtcbiAgICAgICAgbGlua0xpbmVzID0gbGlua0xpbmVzXG4gICAgICAgICAgICAuZW50ZXIoKS5hcHBlbmQoJ2xpbmUnKVxuICAgICAgICAgICAgLmF0dHIoJ2lkJywgZnVuY3Rpb24gKGQsIGkpIHsgcmV0dXJuICdsaW5rLScgKyBpOyB9KVxuICAgICAgICAgICAgLm9uKCdtb3VzZW92ZXInLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgICAgICAgX3RoaXMudG9vbHRpcC5zdHlsZSgndG9wJywgKGQzLmV2ZW50LnBhZ2VZIC0gMTApICsgJ3B4JylcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ2xlZnQnLCAoZDMuZXZlbnQucGFnZVggKyAxMCkgKyAncHgnKVxuICAgICAgICAgICAgICAgIC5zdHlsZSgndmlzaWJpbGl0eScsICd2aXNpYmxlJylcbiAgICAgICAgICAgICAgICAudGV4dChkLnByb3BlcnR5LmxhYmVsKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignbW91c2VvdXQnLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgICAgICAgX3RoaXMudG9vbHRpcC5zdHlsZSgndmlzaWJpbGl0eScsICdoaWRkZW4nKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5tZXJnZShsaW5rTGluZXMpXG4gICAgICAgICAgICAuc3R5bGUoJ3Zpc2liaWxpdHknLCB0aGlzLiRzY29wZS5sYXlvdXQubGlua3MgPT09ICdzaG93JyA/ICd2aXNpYmxlJyA6ICdoaWRkZW4nKTtcbiAgICAgICAgLy8gQWRkIHN1bmJ1cnN0IGFnYWluIHNvIGl0IHN0YXlzIG9uIHRvcFxuICAgICAgICB0aGlzLnN1bmJ1cnN0LmFkZFN1bmJ1cnN0R3JvdXAodGhpcy5zdmdTZWwpO1xuICAgICAgICB0aGlzLmdlbmVyaWNUaWNrKHByaW1hcnlOb2Rlcywgc2Vjb25kYXJ5Tm9kZXMsIHVudHlwZWROb2RlcywgbGlua0xpbmVzLCB0cmFuc2l0aW9uKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHEucmVzb2x2ZSgnb2snKTtcbiAgICB9O1xuICAgIEV4cGxvcmVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS5tYXBWZXJpZnlUb1RoaXMgPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZlcmlmeTogc3RhdGUudmVyaWZ5XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBFeHBsb3JlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUubWFwVHlwZXNUb1RoaXMgPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGVzOiBzdGF0ZS50eXBlc1xuICAgICAgICB9O1xuICAgIH07XG4gICAgRXhwbG9yZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLm1hcEl0ZW1zVG9UaGlzID0gZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpdGVtczogc3RhdGUuaXRlbXNcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEV4cGxvcmVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS5tZXJnZU5vZGVzID0gZnVuY3Rpb24gKG9sZE5vZGVzLCBub2Rlcykge1xuICAgICAgICB2YXIgbmV3Tm9kZXMgPSBbXTtcbiAgICAgICAgLy8gQ2hlY2sgaWYgb2xkIG5vZGVzIGFyZSBzdGlsbCBpbiB0aGUgbWl4XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbm9kZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpZiAob2xkTm9kZXNbaV0udG9DYW5vbmljYWwoKSA9PT0gbm9kZXNbal0udG9DYW5vbmljYWwoKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdOb2Rlcy5wdXNoKG9sZE5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBncmFiIG5ldyBub2RlIGluZm9ybWF0aW9uIGxpa2UgbGFiZWxzIGFuZCBwcm9wcyBpbiBjYXNlIGl0J3MgY2hhbmdlZFxuICAgICAgICAgICAgICAgICAgICBvbGROb2Rlc1tpXS5sYWJlbCA9IG5vZGVzW2pdLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBvbGROb2Rlc1tpXS5sb2NhbFByb3BlcnRpZXMgPSBub2Rlc1tqXS5sb2NhbFByb3BlcnRpZXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIEFkZCB0aGUgbmV3IG5vZGVzXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjaGVjayA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBuZXdOb2Rlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGlmIChuZXdOb2Rlc1tqXS50b0Nhbm9uaWNhbCgpID09PSBub2Rlc1tpXS50b0Nhbm9uaWNhbCgpKVxuICAgICAgICAgICAgICAgICAgICBjaGVjayA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWNoZWNrKSB7XG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMucHVzaChub2Rlc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ld05vZGVzO1xuICAgIH07XG4gICAgRXhwbG9yZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLm1lcmdlTGlua3MgPSBmdW5jdGlvbiAob2xkTGlua3MpIHtcbiAgICAgICAgdmFyIG5ld0xpbmtzID0gW107XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMucHJpbWFyeUl0ZW1zLmNvbmNhdCh0aGlzLnNlY29uZGFyeUl0ZW1zKTtcbiAgICAgICAgdmFyIHNhbWVBcyA9IG5ldyBFTm9kZU1hcCgpO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGl0ZW1zXzEgPSBpdGVtczsgX2kgPCBpdGVtc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc18xW19pXTtcbiAgICAgICAgICAgIHNhbWVBcy5zZXQoaXRlbSwgaXRlbSk7XG4gICAgICAgICAgICB2YXIgc2FtZUFzUHJvcCA9IGl0ZW0ubG9jYWxQcm9wZXJ0aWVzLmZpbHRlcihmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBPV0wuc2FtZUFzLmVxdWFscyhwKTtcbiAgICAgICAgICAgIH0pWzBdO1xuICAgICAgICAgICAgaWYgKHNhbWVBc1Byb3AgJiYgc2FtZUFzUHJvcC52YWx1ZXMpXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBfYiA9IHNhbWVBc1Byb3AudmFsdWVzOyBfYSA8IF9iLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IF9iW19hXTtcbiAgICAgICAgICAgICAgICAgICAgc2FtZUFzLnNldChuLnZhbHVlLCBpdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSXRlcmF0ZSBvdmVyIGl0ZW0gcHJvcGVydHkgdmFsdWVzIHRvIHNlZSBpZiB0aGV5IG1hdGNoIHRoZSBpZCBvZiBhbnlcbiAgICAgICAgLy8gb2YgdGhlIGl0ZW1zIGRpc3BsYXllZC4gQWxzbyBjaGVjayBpZiB0aGV5IG1hdGNoIHNhbWVBcyB2YWx1ZXMuLi5cbiAgICAgICAgZm9yICh2YXIgX2MgPSAwLCBpdGVtc18yID0gaXRlbXM7IF9jIDwgaXRlbXNfMi5sZW5ndGg7IF9jKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNfMltfY107XG4gICAgICAgICAgICBmb3IgKHZhciBfZCA9IDAsIF9lID0gaXRlbS5sb2NhbFByb3BlcnRpZXM7IF9kIDwgX2UubGVuZ3RoOyBfZCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHAgPSBfZVtfZF07XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2YgPSAwLCBfZyA9IHAudmFsdWVzOyBfZiA8IF9nLmxlbmd0aDsgX2YrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdiA9IF9nW19mXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNhbWVBcy5oYXModi52YWx1ZSkgJiYgaXRlbSAhPT0gc2FtZUFzLmdldCh2LnZhbHVlKSAmJiBpdGVtcy5pbmRleE9mKHNhbWVBcy5nZXQodi52YWx1ZSkpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3TGlua3MucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBpdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogc2FtZUFzLmdldCh2LnZhbHVlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogcFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ld0xpbmtzO1xuICAgIH07XG4gICAgcmV0dXJuIEV4cGxvcmVDb21wb25lbnRDb250cm9sbGVyO1xufSgpKTtcbnZhciBFeHBsb3JlQ29tcG9uZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBFeHBsb3JlQ29tcG9uZW50KCkge1xuICAgICAgICB0aGlzLmJpbmRpbmdzID0ge1xuICAgICAgICAgICAgbGlua01vZGU6ICc8JyxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5jb250cm9sbGVyID0gRXhwbG9yZUNvbXBvbmVudENvbnRyb2xsZXI7IC8vIChuZXcgKC4uLmFyZ3M6IGFueVtdKSA9PiBhbmd1bGFyLklDb250cm9sbGVyKSA9IEV4cGxvcmVDb21wb25lbnRDb250cm9sbGVyXG4gICAgICAgIHRoaXMudGVtcGxhdGUgPSByZXF1aXJlKCcuL2V4cGxvcmUucHVnJykoKTtcbiAgICB9XG4gICAgcmV0dXJuIEV4cGxvcmVDb21wb25lbnQ7XG59KCkpO1xuZXhwb3J0IHsgRXhwbG9yZUNvbXBvbmVudCB9O1xuYW5ndWxhci5tb2R1bGUoJ2ZpYnJhLmNvbXBvbmVudHMuZXhwbG9yZScsIFsnZmlicmEuc2VydmljZXMnXSlcbiAgICAuY29tcG9uZW50KCdleHBsb3JlJywgbmV3IEV4cGxvcmVDb21wb25lbnQoKSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXBwL2NvbXBvbmVudHMvY29uc3RydWN0LXZpZXcvZXhwbG9yZS1jb21wb25lbnQudHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFNQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFFQTtBQUFBO0FBRUE7QUFJQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),

/***/ "./app/components/construct-view/palette-component/palette-component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3__ = __webpack_require__(\"./app/bower_components/d3/d3.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_d3__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__models_rdf__ = __webpack_require__(\"./app/models/rdf.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_angular__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_angular___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_angular__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__actions_types__ = __webpack_require__(\"./app/actions/types.ts\");\n/* unused harmony export PaletteComponentController */\n/* unused harmony export PaletteComponent */\n\n\n\n\n\n\nvar PaletteComponentController = function () {\n    function PaletteComponentController(fibraService, $element, sparqlItemService, sparqlTreeService, $q, $ngRedux, FileSaver) {\n        this.fibraService = fibraService;\n        this.$element = $element;\n        this.sparqlItemService = sparqlItemService;\n        this.sparqlTreeService = sparqlTreeService;\n        this.$q = $q;\n        this.$ngRedux = $ngRedux;\n        this.FileSaver = FileSaver;\n        this.paletteSearchHeight = 40;\n        this.typeColorScale = __WEBPACK_IMPORTED_MODULE_0_d3__[\"scaleOrdinal\"](__WEBPACK_IMPORTED_MODULE_0_d3__[\"schemeCategory20c\"]);\n        this.labelFilter = '';\n        this.typeItemTree = __WEBPACK_IMPORTED_MODULE_0_d3__[\"map\"]();\n        this.unsubscribe = $ngRedux.connect(this.mapStateToThis, __WEBPACK_IMPORTED_MODULE_3__actions_types__)(this);\n        this.typeItemTree.set('', {\n            label: 'No type defined',\n            items: [],\n            expanded: false\n        });\n        this.query();\n    }\n    PaletteComponentController.prototype.$onDestroy = function () {\n        this.unsubscribe();\n    };\n    PaletteComponentController.prototype.query = function () {\n        var _this = this;\n        return this.typeItemTreePromise = this.sparqlItemService.getAllItems().then(function (items) {\n            return _this.mergeItems(_this.items, items);\n        });\n    };\n    PaletteComponentController.prototype.$postLink = function () {\n        var _this = this;\n        this.divSel = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"](this.$element[0]).select('div.palette');\n        this.nodeDrag = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"](this.$element[0]).select('.palette-node-drag');\n        this.nodeDrag.style('display', 'none');\n        this.nodeDrag.append('circle');\n        this.divSel.style('height', '100%').style('width', '100%');\n        this.tooltip = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"]('body').append('div').style('position', 'absolute').style('z-index', '20').style('background-color', 'gray').style('color', 'white').style('padding', '3px').style('border-radius', '2px').style('visibility', 'hidden');\n        var onChangeFunction = function () {\n            return _this.query().then(_this.build.bind(_this)).then(function () {\n                return 'Done';\n            });\n        };\n        this.fibraService.on('change', onChangeFunction);\n        this.typeItemTreePromise.then(function (itemTree) {\n            _this.build.bind(_this)(itemTree);\n        });\n    };\n    PaletteComponentController.prototype.addItem = function (item, coordinates) {\n        var _this = this;\n        var itemTypeKey = item.typeValue;\n        var itemType = this.types.types.filter(function (t) {\n            return t.id === itemTypeKey;\n        })[0];\n        var chosenTypes = this.types.displayTypes;\n        if (!chosenTypes[0] && itemType) {\n            this.setOrderedTypes([itemType]);\n        } else if (!chosenTypes[1] && itemType && chosenTypes[0] !== itemType) {\n            var newTypes = chosenTypes.concat([]);\n            newTypes.push(itemType);\n            this.setOrderedTypes(newTypes);\n        }\n        return this.fibraService.dispatchAction(this.fibraService.displayItem(item, coordinates)).then(function (state) {\n            _this.fibraService.dispatch('change');\n            return state;\n        });\n    };\n    PaletteComponentController.prototype.createItem = function (label) {\n        var _this = this;\n        var node = __WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"b\" /* DataFactory */].instance.namedNode(label);\n        this.fibraService.dispatchAction(this.fibraService.createItem(node)).then(function () {\n            _this.query().then(function (items) {\n                _this.build.bind(_this)(items);\n            });\n        });\n    };\n    PaletteComponentController.prototype.downloadCSV = function (datum) {\n        var blob = new Blob([__WEBPACK_IMPORTED_MODULE_0_d3__[\"csvFormat\"](datum.value.items.map(function (d) {\n            var sameAs = d.localProperties.filter(function (p) {\n                return p.value === __WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"d\" /* OWL */].sameAs.value;\n            })[0];\n            var prefLabel = d.localProperties.filter(function (p) {\n                return p.value === __WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"a\" /* SKOS */].prefLabel.value;\n            })[0];\n            return _a = {}, _a[__WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"a\" /* SKOS */].prefLabel.value] = prefLabel ? prefLabel.values[0].value.value : '', _a.FibraId = d.value, _a.Match = sameAs ? sameAs.values[0].value.value : '', _a;\n            var _a;\n        }), [__WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"a\" /* SKOS */].prefLabel.value, 'FibraId', 'Match'])], { type: 'application/csv;charset=utf-8' });\n        var filename = datum.value.label + '.csv';\n        this.FileSaver.saveAs(blob, filename);\n    };\n    PaletteComponentController.prototype.build = function (itemTree) {\n        var _this = this;\n        this.updateSizing();\n        console.log(itemTree.entries());\n        var itemTreeFiltered = itemTree.entries().filter(function (d) {\n            return d.key !== '';\n        });\n        var items = itemTreeFiltered.reduce(function (a, b) {\n            return a.concat(b.value.items);\n        }, []);\n        var padding = items.length > 300 ? items.length > 2000 ? 1 : 2 : 4;\n        var paletteHeightLessTypes = this.paletteHeight - itemTreeFiltered.length * 25;\n        var rawRadius = (Math.sqrt(this.paletteWidth * paletteHeightLessTypes / items.length) - padding) / 2;\n        var radius = rawRadius > 8 ? 8 : rawRadius;\n        var xOffset = radius * 2 + padding / 2;\n        var yOffset = radius * 2 + padding / 2;\n        var xDots = Math.floor(this.paletteWidth / xOffset) - 1;\n        // Bring the node drag SVG and the addItem function local\n        var nodeDrag = this.nodeDrag;\n        var addItem = this.addItem.bind(this);\n        var paletteWidth = this.paletteWidth;\n        this.typesD3 = this.divSel.selectAll('div.type').data(itemTreeFiltered, function (d) {\n            return d.key;\n        });\n        this.typesD3.exit().remove();\n        var typesDivsEnter = this.typesD3.enter().append('div').classed('type', true).classed('inverse-icon', true).text(function (d) {\n            return d.value.label;\n        });\n        typesDivsEnter.append('span').classed('glyphicon', true).classed('glyphicon-download', true).on('click', function (d) {\n            return _this.downloadCSV(d);\n        });\n        typesDivsEnter.append('span').classed('glyphicon', true).classed('expand-button', true).on('click', function (d) {\n            d.value.expanded = !d.value.expanded;\n            _this.typeItemTreePromise.then(_this.build.bind(_this));\n        });\n        typesDivsEnter.append('svg').attr('width', '100%');\n        this.typesD3 = typesDivsEnter.merge(this.typesD3);\n        this.typesD3.selectAll('.expand-button').classed('glyphicon-resize-small', function (d) {\n            return d.value.expanded;\n        }).classed('glyphicon-resize-full', function (d) {\n            return !d.value.expanded;\n        });\n        this.typesD3.selectAll('svg').style('display', function (d) {\n            return d.value.expanded ? 'block' : 'none';\n        });\n        var typeSvgs = this.typesD3.select('svg').attr('height', function (d) {\n            return (Math.ceil(d.value.items.length / xDots) + 1) * yOffset;\n        });\n        this.circles = typeSvgs.selectAll('circle.item').data(function (d) {\n            return d.value.items;\n        }, function (d) {\n            return d.value;\n        });\n        this.circles.exit().remove();\n        this.circles = this.circles.enter().append('circle').classed('item', true).attr('r', radius).on('mouseover', function (d, i) {\n            _this.tooltip.style('top', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].pageY - 10 + 'px').style('left', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].pageX + 10 + 'px').style('visibility', 'visible').text(d.label + ' (' + d.typeLabel + ')');\n        }).on('mouseout', function (d, i) {\n            _this.tooltip.style('visibility', 'hidden');\n        }).call(__WEBPACK_IMPORTED_MODULE_0_d3__[\"drag\"]().on('start', function (d) {\n            var thisCircle = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"](this);\n            nodeDrag.style('display', 'block');\n            nodeDrag.select('circle').classed('item', thisCircle.classed('item')).attr('r', thisCircle.attr('r')).attr('fill', thisCircle.attr('fill')).attr('transform', 'translate(8,8)');\n            nodeDrag.style('left', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientX - 8).style('top', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientY - 8);\n        }).on('drag', function (d) {\n            nodeDrag.style('left', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientX - 8).style('top', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientY - 8);\n        }).on('end', function (d) {\n            // If the cursor is on the canvas, display\n            var exploreContainer = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"]('#explorecontainer').node();\n            if (__WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientX > exploreContainer.getBoundingClientRect().left && __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientX < exploreContainer.getBoundingClientRect().right && __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientY > exploreContainer.getBoundingClientRect().top && __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientY < exploreContainer.getBoundingClientRect().bottom) {\n                addItem(__WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"](this).datum(), [__WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientX - exploreContainer.getBoundingClientRect().left, __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].sourceEvent.clientY - exploreContainer.getBoundingClientRect().top]).then(function () {\n                    nodeDrag.style('display', 'none');\n                });\n            } else {\n                nodeDrag.style('display', 'none');\n            }\n        })).merge(this.circles).call(this.update.bind(this));\n        this.circles.transition().attr('fill', function (d) {\n            return _this.typeColorScale(d.typeValue);\n        }).attr('transform', function (d, i) {\n            return 'translate(' + (i % xDots + 1) * xOffset + ',' + (Math.floor(i / xDots) + 1) * yOffset + ')';\n        });\n    };\n    PaletteComponentController.prototype.update = function (circles) {\n        var _this = this;\n        var c = circles ? circles : this.circles;\n        c.classed('displayed', function (d) {\n            return _this.fibraService.getState().construct.itemIndex[d.value] ? true : false;\n        }).classed('filtered', function (d) {\n            return _this.labelFilter && !(d.label.toUpperCase().indexOf(_this.labelFilter.toUpperCase()) !== -1);\n        });\n    };\n    PaletteComponentController.prototype.mapStateToThis = function (state) {\n        return {\n            types: state.types\n        };\n    };\n    PaletteComponentController.prototype.updateSizing = function () {\n        this.paletteWidth = Math.round(window.innerWidth * 0.15); // this.svgSel.node().clientWidth\n        this.paletteHeight = Math.round(window.innerHeight) - this.paletteSearchHeight;\n        this.divSel.style('height', this.paletteHeight + 'px');\n    };\n    PaletteComponentController.prototype.mergeItems = function (oldItems, newItems) {\n        var _this = this;\n        // Wipe old items (bad, but temporary)\n        this.typeItemTree.values().forEach(function (v) {\n            v.items = [];\n        });\n        newItems.forEach(function (item) {\n            var typeProp = item.localProperties.filter(function (p) {\n                return p.value === __WEBPACK_IMPORTED_MODULE_1__models_rdf__[\"c\" /* RDF */].type.value;\n            })[0];\n            if (typeProp && typeProp.values[0]) {\n                item.typeValue = typeProp.values[0].value.value;\n                item.typeLabel = typeProp.values[0].value.label;\n                // Add type to the type map\n                if (!_this.typeItemTree.has(item.typeValue)) {\n                    _this.typeItemTree.set(item.typeValue, {\n                        label: item.typeLabel,\n                        items: [item],\n                        expanded: true\n                    });\n                } else {\n                    _this.typeItemTree.get(item.typeValue).items.push(item);\n                }\n            } else {\n                item.typeValue = '';\n                item.typeLabel = 'No type defined';\n            }\n        });\n        // Sort by label\n        this.typeItemTree.values().forEach(function (v) {\n            v.items.sort(function (a, b) {\n                return a.label === b.label ? 0 : a.label > b.label ? 1 : -1;\n            });\n        });\n        return this.typeItemTree;\n    };\n    return PaletteComponentController;\n}();\n\nvar PaletteComponent = function () {\n    function PaletteComponent() {\n        this.template = __webpack_require__(\"./app/components/construct-view/palette-component/palette-component.pug\")();\n        this.controller = PaletteComponentController;\n    }\n    return PaletteComponent;\n}();\n\n__WEBPACK_IMPORTED_MODULE_2_angular__[\"module\"]('fibra.components.palette', ['fibra.services']).component('palette', new PaletteComponent());//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvY29tcG9uZW50cy9jb25zdHJ1Y3Qtdmlldy9wYWxldHRlLWNvbXBvbmVudC9wYWxldHRlLWNvbXBvbmVudC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hcHAvY29tcG9uZW50cy9jb25zdHJ1Y3Qtdmlldy9wYWxldHRlLWNvbXBvbmVudC9wYWxldHRlLWNvbXBvbmVudC50cz83M2FiIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmltcG9ydCAqIGFzIGQzIGZyb20gJ2QzJztcbmltcG9ydCB7IERhdGFGYWN0b3J5LCBTS09TLCBPV0wsIFJERiB9IGZyb20gJy4uLy4uLy4uL21vZGVscy9yZGYnO1xuaW1wb3J0ICogYXMgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCAqIGFzIFR5cGVBY3Rpb25zIGZyb20gJy4uLy4uLy4uL2FjdGlvbnMvdHlwZXMnO1xudmFyIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQYWxldHRlQ29tcG9uZW50Q29udHJvbGxlcihmaWJyYVNlcnZpY2UsICRlbGVtZW50LCBzcGFycWxJdGVtU2VydmljZSwgc3BhcnFsVHJlZVNlcnZpY2UsICRxLCAkbmdSZWR1eCwgRmlsZVNhdmVyKSB7XG4gICAgICAgIHRoaXMuZmlicmFTZXJ2aWNlID0gZmlicmFTZXJ2aWNlO1xuICAgICAgICB0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuc3BhcnFsSXRlbVNlcnZpY2UgPSBzcGFycWxJdGVtU2VydmljZTtcbiAgICAgICAgdGhpcy5zcGFycWxUcmVlU2VydmljZSA9IHNwYXJxbFRyZWVTZXJ2aWNlO1xuICAgICAgICB0aGlzLiRxID0gJHE7XG4gICAgICAgIHRoaXMuJG5nUmVkdXggPSAkbmdSZWR1eDtcbiAgICAgICAgdGhpcy5GaWxlU2F2ZXIgPSBGaWxlU2F2ZXI7XG4gICAgICAgIHRoaXMucGFsZXR0ZVNlYXJjaEhlaWdodCA9IDQwO1xuICAgICAgICB0aGlzLnR5cGVDb2xvclNjYWxlID0gZDMuc2NhbGVPcmRpbmFsKGQzLnNjaGVtZUNhdGVnb3J5MjBjKTtcbiAgICAgICAgdGhpcy5sYWJlbEZpbHRlciA9ICcnO1xuICAgICAgICB0aGlzLnR5cGVJdGVtVHJlZSA9IGQzLm1hcCgpO1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlID0gJG5nUmVkdXguY29ubmVjdCh0aGlzLm1hcFN0YXRlVG9UaGlzLCBUeXBlQWN0aW9ucykodGhpcyk7XG4gICAgICAgIHRoaXMudHlwZUl0ZW1UcmVlLnNldCgnJywge1xuICAgICAgICAgICAgbGFiZWw6ICdObyB0eXBlIGRlZmluZWQnLFxuICAgICAgICAgICAgaXRlbXM6IFtdLFxuICAgICAgICAgICAgZXhwYW5kZWQ6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnF1ZXJ5KCk7XG4gICAgfVxuICAgIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS4kb25EZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgfTtcbiAgICBQYWxldHRlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUucXVlcnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLnR5cGVJdGVtVHJlZVByb21pc2UgPSB0aGlzLnNwYXJxbEl0ZW1TZXJ2aWNlLmdldEFsbEl0ZW1zKCkudGhlbihmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tZXJnZUl0ZW1zKF90aGlzLml0ZW1zLCBpdGVtcyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLiRwb3N0TGluayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5kaXZTZWwgPSBkMy5zZWxlY3QodGhpcy4kZWxlbWVudFswXSkuc2VsZWN0KCdkaXYucGFsZXR0ZScpO1xuICAgICAgICB0aGlzLm5vZGVEcmFnID0gZDMuc2VsZWN0KHRoaXMuJGVsZW1lbnRbMF0pLnNlbGVjdCgnLnBhbGV0dGUtbm9kZS1kcmFnJyk7XG4gICAgICAgIHRoaXMubm9kZURyYWcuc3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICB0aGlzLm5vZGVEcmFnLmFwcGVuZCgnY2lyY2xlJyk7XG4gICAgICAgIHRoaXMuZGl2U2VsXG4gICAgICAgICAgICAuc3R5bGUoJ2hlaWdodCcsICcxMDAlJylcbiAgICAgICAgICAgIC5zdHlsZSgnd2lkdGgnLCAnMTAwJScpO1xuICAgICAgICB0aGlzLnRvb2x0aXAgPSBkMy5zZWxlY3QoJ2JvZHknKS5hcHBlbmQoJ2RpdicpXG4gICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2Fic29sdXRlJylcbiAgICAgICAgICAgIC5zdHlsZSgnei1pbmRleCcsICcyMCcpXG4gICAgICAgICAgICAuc3R5bGUoJ2JhY2tncm91bmQtY29sb3InLCAnZ3JheScpXG4gICAgICAgICAgICAuc3R5bGUoJ2NvbG9yJywgJ3doaXRlJylcbiAgICAgICAgICAgIC5zdHlsZSgncGFkZGluZycsICczcHgnKVxuICAgICAgICAgICAgLnN0eWxlKCdib3JkZXItcmFkaXVzJywgJzJweCcpXG4gICAgICAgICAgICAuc3R5bGUoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG4gICAgICAgIHZhciBvbkNoYW5nZUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnF1ZXJ5KCkudGhlbihfdGhpcy5idWlsZC5iaW5kKF90aGlzKSkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiAnRG9uZSc7IH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmZpYnJhU2VydmljZS5vbignY2hhbmdlJywgb25DaGFuZ2VGdW5jdGlvbik7XG4gICAgICAgIHRoaXMudHlwZUl0ZW1UcmVlUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChpdGVtVHJlZSkge1xuICAgICAgICAgICAgX3RoaXMuYnVpbGQuYmluZChfdGhpcykoaXRlbVRyZWUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS5hZGRJdGVtID0gZnVuY3Rpb24gKGl0ZW0sIGNvb3JkaW5hdGVzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBpdGVtVHlwZUtleSA9IGl0ZW0udHlwZVZhbHVlO1xuICAgICAgICB2YXIgaXRlbVR5cGUgPSB0aGlzLnR5cGVzLnR5cGVzLmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gdC5pZCA9PT0gaXRlbVR5cGVLZXk7IH0pWzBdO1xuICAgICAgICB2YXIgY2hvc2VuVHlwZXMgPSB0aGlzLnR5cGVzLmRpc3BsYXlUeXBlcztcbiAgICAgICAgaWYgKCFjaG9zZW5UeXBlc1swXSAmJiBpdGVtVHlwZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRPcmRlcmVkVHlwZXMoW2l0ZW1UeXBlXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWNob3NlblR5cGVzWzFdICYmIGl0ZW1UeXBlICYmIChjaG9zZW5UeXBlc1swXSAhPT0gaXRlbVR5cGUpKSB7XG4gICAgICAgICAgICB2YXIgbmV3VHlwZXMgPSBjaG9zZW5UeXBlcy5jb25jYXQoW10pO1xuICAgICAgICAgICAgbmV3VHlwZXMucHVzaChpdGVtVHlwZSk7XG4gICAgICAgICAgICB0aGlzLnNldE9yZGVyZWRUeXBlcyhuZXdUeXBlcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZmlicmFTZXJ2aWNlLmRpc3BhdGNoQWN0aW9uKHRoaXMuZmlicmFTZXJ2aWNlLmRpc3BsYXlJdGVtKGl0ZW0sIGNvb3JkaW5hdGVzKSkudGhlbihmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgICAgIF90aGlzLmZpYnJhU2VydmljZS5kaXNwYXRjaCgnY2hhbmdlJyk7XG4gICAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLmNyZWF0ZUl0ZW0gPSBmdW5jdGlvbiAobGFiZWwpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIG5vZGUgPSBEYXRhRmFjdG9yeS5pbnN0YW5jZS5uYW1lZE5vZGUobGFiZWwpO1xuICAgICAgICB0aGlzLmZpYnJhU2VydmljZS5kaXNwYXRjaEFjdGlvbih0aGlzLmZpYnJhU2VydmljZS5jcmVhdGVJdGVtKG5vZGUpKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLnF1ZXJ5KCkudGhlbihmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5idWlsZC5iaW5kKF90aGlzKShpdGVtcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBQYWxldHRlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUuZG93bmxvYWRDU1YgPSBmdW5jdGlvbiAoZGF0dW0pIHtcbiAgICAgICAgdmFyIGJsb2IgPSBuZXcgQmxvYihbZDMuY3N2Rm9ybWF0KGRhdHVtLnZhbHVlLml0ZW1zLm1hcChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHZhciBzYW1lQXMgPSBkLmxvY2FsUHJvcGVydGllcy5maWx0ZXIoZnVuY3Rpb24gKHApIHsgcmV0dXJuIHAudmFsdWUgPT09IE9XTC5zYW1lQXMudmFsdWU7IH0pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBwcmVmTGFiZWwgPSBkLmxvY2FsUHJvcGVydGllcy5maWx0ZXIoZnVuY3Rpb24gKHApIHsgcmV0dXJuIHAudmFsdWUgPT09IFNLT1MucHJlZkxhYmVsLnZhbHVlOyB9KVswXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2EgPSB7fSxcbiAgICAgICAgICAgICAgICAgICAgX2FbU0tPUy5wcmVmTGFiZWwudmFsdWVdID0gcHJlZkxhYmVsID8gcHJlZkxhYmVsLnZhbHVlc1swXS52YWx1ZS52YWx1ZSA6ICcnLFxuICAgICAgICAgICAgICAgICAgICBfYS5GaWJyYUlkID0gZC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgX2EuTWF0Y2ggPSBzYW1lQXMgPyBzYW1lQXMudmFsdWVzWzBdLnZhbHVlLnZhbHVlIDogJycsXG4gICAgICAgICAgICAgICAgICAgIF9hO1xuICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIH0pLCBbU0tPUy5wcmVmTGFiZWwudmFsdWUsICdGaWJyYUlkJywgJ01hdGNoJ10pXSwgeyB0eXBlOiAnYXBwbGljYXRpb24vY3N2O2NoYXJzZXQ9dXRmLTgnIH0pO1xuICAgICAgICB2YXIgZmlsZW5hbWUgPSBkYXR1bS52YWx1ZS5sYWJlbCArICcuY3N2JztcbiAgICAgICAgdGhpcy5GaWxlU2F2ZXIuc2F2ZUFzKGJsb2IsIGZpbGVuYW1lKTtcbiAgICB9O1xuICAgIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS5idWlsZCA9IGZ1bmN0aW9uIChpdGVtVHJlZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnVwZGF0ZVNpemluZygpO1xuICAgICAgICBjb25zb2xlLmxvZyhpdGVtVHJlZS5lbnRyaWVzKCkpO1xuICAgICAgICB2YXIgaXRlbVRyZWVGaWx0ZXJlZCA9IGl0ZW1UcmVlLmVudHJpZXMoKS5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQua2V5ICE9PSAnJzsgfSk7XG4gICAgICAgIHZhciBpdGVtcyA9IGl0ZW1UcmVlRmlsdGVyZWQucmVkdWNlKGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gYS5jb25jYXQoYi52YWx1ZS5pdGVtcyk7XG4gICAgICAgIH0sIFtdKTtcbiAgICAgICAgdmFyIHBhZGRpbmcgPSBpdGVtcy5sZW5ndGggPiAzMDAgPyBpdGVtcy5sZW5ndGggPiAyMDAwID8gMSA6IDIgOiA0O1xuICAgICAgICB2YXIgcGFsZXR0ZUhlaWdodExlc3NUeXBlcyA9IHRoaXMucGFsZXR0ZUhlaWdodCAtIChpdGVtVHJlZUZpbHRlcmVkLmxlbmd0aCAqIDI1KTtcbiAgICAgICAgdmFyIHJhd1JhZGl1cyA9IChNYXRoLnNxcnQodGhpcy5wYWxldHRlV2lkdGggKiBwYWxldHRlSGVpZ2h0TGVzc1R5cGVzIC8gaXRlbXMubGVuZ3RoKSAtIHBhZGRpbmcpIC8gMjtcbiAgICAgICAgdmFyIHJhZGl1cyA9IHJhd1JhZGl1cyA+IDggPyA4IDogcmF3UmFkaXVzO1xuICAgICAgICB2YXIgeE9mZnNldCA9IHJhZGl1cyAqIDIgKyBwYWRkaW5nIC8gMjtcbiAgICAgICAgdmFyIHlPZmZzZXQgPSByYWRpdXMgKiAyICsgcGFkZGluZyAvIDI7XG4gICAgICAgIHZhciB4RG90cyA9IE1hdGguZmxvb3IoKHRoaXMucGFsZXR0ZVdpZHRoKSAvIHhPZmZzZXQpIC0gMTtcbiAgICAgICAgLy8gQnJpbmcgdGhlIG5vZGUgZHJhZyBTVkcgYW5kIHRoZSBhZGRJdGVtIGZ1bmN0aW9uIGxvY2FsXG4gICAgICAgIHZhciBub2RlRHJhZyA9IHRoaXMubm9kZURyYWc7XG4gICAgICAgIHZhciBhZGRJdGVtID0gdGhpcy5hZGRJdGVtLmJpbmQodGhpcyk7XG4gICAgICAgIHZhciBwYWxldHRlV2lkdGggPSB0aGlzLnBhbGV0dGVXaWR0aDtcbiAgICAgICAgdGhpcy50eXBlc0QzID0gdGhpcy5kaXZTZWxcbiAgICAgICAgICAgIC5zZWxlY3RBbGwoJ2Rpdi50eXBlJylcbiAgICAgICAgICAgIC5kYXRhKGl0ZW1UcmVlRmlsdGVyZWQsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmtleTsgfSk7XG4gICAgICAgIHRoaXMudHlwZXNEMy5leGl0KCkucmVtb3ZlKCk7XG4gICAgICAgIHZhciB0eXBlc0RpdnNFbnRlciA9IHRoaXMudHlwZXNEMy5lbnRlcigpXG4gICAgICAgICAgICAuYXBwZW5kKCdkaXYnKVxuICAgICAgICAgICAgLmNsYXNzZWQoJ3R5cGUnLCB0cnVlKVxuICAgICAgICAgICAgLmNsYXNzZWQoJ2ludmVyc2UtaWNvbicsIHRydWUpXG4gICAgICAgICAgICAudGV4dChmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC52YWx1ZS5sYWJlbDsgfSk7XG4gICAgICAgIHR5cGVzRGl2c0VudGVyXG4gICAgICAgICAgICAuYXBwZW5kKCdzcGFuJylcbiAgICAgICAgICAgIC5jbGFzc2VkKCdnbHlwaGljb24nLCB0cnVlKVxuICAgICAgICAgICAgLmNsYXNzZWQoJ2dseXBoaWNvbi1kb3dubG9hZCcsIHRydWUpXG4gICAgICAgICAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIF90aGlzLmRvd25sb2FkQ1NWKGQpOyB9KTtcbiAgICAgICAgdHlwZXNEaXZzRW50ZXJcbiAgICAgICAgICAgIC5hcHBlbmQoJ3NwYW4nKVxuICAgICAgICAgICAgLmNsYXNzZWQoJ2dseXBoaWNvbicsIHRydWUpXG4gICAgICAgICAgICAuY2xhc3NlZCgnZXhwYW5kLWJ1dHRvbicsIHRydWUpXG4gICAgICAgICAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgIGQudmFsdWUuZXhwYW5kZWQgPSAhZC52YWx1ZS5leHBhbmRlZDtcbiAgICAgICAgICAgIF90aGlzLnR5cGVJdGVtVHJlZVByb21pc2UudGhlbihfdGhpcy5idWlsZC5iaW5kKF90aGlzKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0eXBlc0RpdnNFbnRlclxuICAgICAgICAgICAgLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsICcxMDAlJyk7XG4gICAgICAgIHRoaXMudHlwZXNEMyA9IHR5cGVzRGl2c0VudGVyXG4gICAgICAgICAgICAubWVyZ2UodGhpcy50eXBlc0QzKTtcbiAgICAgICAgdGhpcy50eXBlc0QzLnNlbGVjdEFsbCgnLmV4cGFuZC1idXR0b24nKVxuICAgICAgICAgICAgLmNsYXNzZWQoJ2dseXBoaWNvbi1yZXNpemUtc21hbGwnLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC52YWx1ZS5leHBhbmRlZDsgfSlcbiAgICAgICAgICAgIC5jbGFzc2VkKCdnbHlwaGljb24tcmVzaXplLWZ1bGwnLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gIWQudmFsdWUuZXhwYW5kZWQ7IH0pO1xuICAgICAgICB0aGlzLnR5cGVzRDMuc2VsZWN0QWxsKCdzdmcnKVxuICAgICAgICAgICAgLnN0eWxlKCdkaXNwbGF5JywgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQudmFsdWUuZXhwYW5kZWQgPyAnYmxvY2snIDogJ25vbmUnOyB9KTtcbiAgICAgICAgdmFyIHR5cGVTdmdzID0gdGhpcy50eXBlc0QzLnNlbGVjdCgnc3ZnJylcbiAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgcmV0dXJuIChNYXRoLmNlaWwoZC52YWx1ZS5pdGVtcy5sZW5ndGggLyB4RG90cykgKyAxKSAqIHlPZmZzZXQ7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNpcmNsZXMgPSB0eXBlU3Znc1xuICAgICAgICAgICAgLnNlbGVjdEFsbCgnY2lyY2xlLml0ZW0nKVxuICAgICAgICAgICAgLmRhdGEoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQudmFsdWUuaXRlbXM7IH0sIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLnZhbHVlOyB9KTtcbiAgICAgICAgdGhpcy5jaXJjbGVzLmV4aXQoKS5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5jaXJjbGVzID0gdGhpcy5jaXJjbGVzLmVudGVyKClcbiAgICAgICAgICAgIC5hcHBlbmQoJ2NpcmNsZScpXG4gICAgICAgICAgICAuY2xhc3NlZCgnaXRlbScsIHRydWUpXG4gICAgICAgICAgICAuYXR0cigncicsIHJhZGl1cylcbiAgICAgICAgICAgIC5vbignbW91c2VvdmVyJywgZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgICAgIF90aGlzLnRvb2x0aXAuc3R5bGUoJ3RvcCcsIChkMy5ldmVudC5wYWdlWSAtIDEwKSArICdweCcpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdsZWZ0JywgKGQzLmV2ZW50LnBhZ2VYICsgMTApICsgJ3B4JylcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpXG4gICAgICAgICAgICAgICAgLnRleHQoZC5sYWJlbCArICcgKCcgKyBkLnR5cGVMYWJlbCArICcpJyk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ21vdXNlb3V0JywgZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgICAgIF90aGlzLnRvb2x0aXAuc3R5bGUoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAuY2FsbChkMy5kcmFnKClcbiAgICAgICAgICAgIC5vbignc3RhcnQnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgdmFyIHRoaXNDaXJjbGUgPSBkMy5zZWxlY3QodGhpcyk7XG4gICAgICAgICAgICBub2RlRHJhZ1xuICAgICAgICAgICAgICAgIC5zdHlsZSgnZGlzcGxheScsICdibG9jaycpO1xuICAgICAgICAgICAgbm9kZURyYWcuc2VsZWN0KCdjaXJjbGUnKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKCdpdGVtJywgdGhpc0NpcmNsZS5jbGFzc2VkKCdpdGVtJykpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3InLCB0aGlzQ2lyY2xlLmF0dHIoJ3InKSlcbiAgICAgICAgICAgICAgICAuYXR0cignZmlsbCcsIHRoaXNDaXJjbGUuYXR0cignZmlsbCcpKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDgsOCknKTtcbiAgICAgICAgICAgIG5vZGVEcmFnXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdsZWZ0JywgZDMuZXZlbnQuc291cmNlRXZlbnQuY2xpZW50WCAtIDgpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCd0b3AnLCBkMy5ldmVudC5zb3VyY2VFdmVudC5jbGllbnRZIC0gOCk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ2RyYWcnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgbm9kZURyYWdcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ2xlZnQnLCBkMy5ldmVudC5zb3VyY2VFdmVudC5jbGllbnRYIC0gOClcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ3RvcCcsIGQzLmV2ZW50LnNvdXJjZUV2ZW50LmNsaWVudFkgLSA4KTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignZW5kJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZSBjdXJzb3IgaXMgb24gdGhlIGNhbnZhcywgZGlzcGxheVxuICAgICAgICAgICAgdmFyIGV4cGxvcmVDb250YWluZXIgPSBkMy5zZWxlY3QoJyNleHBsb3JlY29udGFpbmVyJykubm9kZSgpO1xuICAgICAgICAgICAgaWYgKGQzLmV2ZW50LnNvdXJjZUV2ZW50LmNsaWVudFggPiBleHBsb3JlQ29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgJiZcbiAgICAgICAgICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5jbGllbnRYIDwgZXhwbG9yZUNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodCAmJlxuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnNvdXJjZUV2ZW50LmNsaWVudFkgPiBleHBsb3JlQ29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCAmJlxuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnNvdXJjZUV2ZW50LmNsaWVudFkgPCBleHBsb3JlQ29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbSkge1xuICAgICAgICAgICAgICAgIGFkZEl0ZW0oZDMuc2VsZWN0KHRoaXMpLmRhdHVtKCksIFtcbiAgICAgICAgICAgICAgICAgICAgZDMuZXZlbnQuc291cmNlRXZlbnQuY2xpZW50WCAtIGV4cGxvcmVDb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCxcbiAgICAgICAgICAgICAgICAgICAgZDMuZXZlbnQuc291cmNlRXZlbnQuY2xpZW50WSAtIGV4cGxvcmVDb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wXG4gICAgICAgICAgICAgICAgXSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEcmFnLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5vZGVEcmFnLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpXG4gICAgICAgICAgICAubWVyZ2UodGhpcy5jaXJjbGVzKVxuICAgICAgICAgICAgLmNhbGwodGhpcy51cGRhdGUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuY2lyY2xlc1xuICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgLmF0dHIoJ2ZpbGwnLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gX3RoaXMudHlwZUNvbG9yU2NhbGUoZC50eXBlVmFsdWUpOyB9KVxuICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIGZ1bmN0aW9uIChkLCBpKSB7IHJldHVybiAndHJhbnNsYXRlKCcgKyAoKGkgJSB4RG90cykgKyAxKSAqIHhPZmZzZXQgKyAnLCcgKyAoTWF0aC5mbG9vcihpIC8geERvdHMpICsgMSkgKiB5T2Zmc2V0ICsgJyknOyB9KTtcbiAgICB9O1xuICAgIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoY2lyY2xlcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgYyA9IGNpcmNsZXMgPyBjaXJjbGVzIDogdGhpcy5jaXJjbGVzO1xuICAgICAgICBjLmNsYXNzZWQoJ2Rpc3BsYXllZCcsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBfdGhpcy5maWJyYVNlcnZpY2UuZ2V0U3RhdGUoKS5jb25zdHJ1Y3QuaXRlbUluZGV4W2QudmFsdWVdID8gdHJ1ZSA6IGZhbHNlOyB9KVxuICAgICAgICAgICAgLmNsYXNzZWQoJ2ZpbHRlcmVkJywgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIF90aGlzLmxhYmVsRmlsdGVyICYmICEoZC5sYWJlbC50b1VwcGVyQ2FzZSgpLmluZGV4T2YoX3RoaXMubGFiZWxGaWx0ZXIudG9VcHBlckNhc2UoKSkgIT09IC0xKTsgfSk7XG4gICAgfTtcbiAgICBQYWxldHRlQ29tcG9uZW50Q29udHJvbGxlci5wcm90b3R5cGUubWFwU3RhdGVUb1RoaXMgPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGVzOiBzdGF0ZS50eXBlc1xuICAgICAgICB9O1xuICAgIH07XG4gICAgUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXIucHJvdG90eXBlLnVwZGF0ZVNpemluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5wYWxldHRlV2lkdGggPSBNYXRoLnJvdW5kKHdpbmRvdy5pbm5lcldpZHRoICogMC4xNSk7IC8vIHRoaXMuc3ZnU2VsLm5vZGUoKS5jbGllbnRXaWR0aFxuICAgICAgICB0aGlzLnBhbGV0dGVIZWlnaHQgPSBNYXRoLnJvdW5kKHdpbmRvdy5pbm5lckhlaWdodCkgLSB0aGlzLnBhbGV0dGVTZWFyY2hIZWlnaHQ7XG4gICAgICAgIHRoaXMuZGl2U2VsLnN0eWxlKCdoZWlnaHQnLCB0aGlzLnBhbGV0dGVIZWlnaHQgKyAncHgnKTtcbiAgICB9O1xuICAgIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZS5tZXJnZUl0ZW1zID0gZnVuY3Rpb24gKG9sZEl0ZW1zLCBuZXdJdGVtcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAvLyBXaXBlIG9sZCBpdGVtcyAoYmFkLCBidXQgdGVtcG9yYXJ5KVxuICAgICAgICB0aGlzLnR5cGVJdGVtVHJlZS52YWx1ZXMoKS5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICB2Lml0ZW1zID0gW107XG4gICAgICAgIH0pO1xuICAgICAgICBuZXdJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICB2YXIgdHlwZVByb3AgPSBpdGVtLmxvY2FsUHJvcGVydGllcy5maWx0ZXIoZnVuY3Rpb24gKHApIHsgcmV0dXJuIHAudmFsdWUgPT09IFJERi50eXBlLnZhbHVlOyB9KVswXTtcbiAgICAgICAgICAgIGlmICh0eXBlUHJvcCAmJiB0eXBlUHJvcC52YWx1ZXNbMF0pIHtcbiAgICAgICAgICAgICAgICBpdGVtLnR5cGVWYWx1ZSA9IHR5cGVQcm9wLnZhbHVlc1swXS52YWx1ZS52YWx1ZTtcbiAgICAgICAgICAgICAgICBpdGVtLnR5cGVMYWJlbCA9IHR5cGVQcm9wLnZhbHVlc1swXS52YWx1ZS5sYWJlbDtcbiAgICAgICAgICAgICAgICAvLyBBZGQgdHlwZSB0byB0aGUgdHlwZSBtYXBcbiAgICAgICAgICAgICAgICBpZiAoIV90aGlzLnR5cGVJdGVtVHJlZS5oYXMoaXRlbS50eXBlVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnR5cGVJdGVtVHJlZS5zZXQoaXRlbS50eXBlVmFsdWUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBpdGVtLnR5cGVMYWJlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiBbaXRlbV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBhbmRlZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnR5cGVJdGVtVHJlZS5nZXQoaXRlbS50eXBlVmFsdWUpLml0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaXRlbS50eXBlVmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICBpdGVtLnR5cGVMYWJlbCA9ICdObyB0eXBlIGRlZmluZWQnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gU29ydCBieSBsYWJlbFxuICAgICAgICB0aGlzLnR5cGVJdGVtVHJlZS52YWx1ZXMoKS5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICB2Lml0ZW1zLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEubGFiZWwgPT09IGIubGFiZWwgPyAwIDogYS5sYWJlbCA+IGIubGFiZWwgPyAxIDogLTE7IH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZUl0ZW1UcmVlO1xuICAgIH07XG4gICAgcmV0dXJuIFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyO1xufSgpKTtcbmV4cG9ydCB7IFBhbGV0dGVDb21wb25lbnRDb250cm9sbGVyIH07XG52YXIgUGFsZXR0ZUNvbXBvbmVudCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUGFsZXR0ZUNvbXBvbmVudCgpIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZSA9IHJlcXVpcmUoJy4vcGFsZXR0ZS1jb21wb25lbnQucHVnJykoKTtcbiAgICAgICAgdGhpcy5jb250cm9sbGVyID0gUGFsZXR0ZUNvbXBvbmVudENvbnRyb2xsZXI7XG4gICAgfVxuICAgIHJldHVybiBQYWxldHRlQ29tcG9uZW50O1xufSgpKTtcbmV4cG9ydCB7IFBhbGV0dGVDb21wb25lbnQgfTtcbmFuZ3VsYXIubW9kdWxlKCdmaWJyYS5jb21wb25lbnRzLnBhbGV0dGUnLCBbJ2ZpYnJhLnNlcnZpY2VzJ10pXG4gICAgLmNvbXBvbmVudCgncGFsZXR0ZScsIG5ldyBQYWxldHRlQ29tcG9uZW50KCkpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGFwcC9jb21wb25lbnRzL2NvbnN0cnVjdC12aWV3L3BhbGV0dGUtY29tcG9uZW50L3BhbGV0dGUtY29tcG9uZW50LnRzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQVFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUlBO0FBQUE7QUFDQTtBQUlBO0FBQUE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFLQTtBQUlBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUtBO0FBR0E7QUFFQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBSUE7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),

/***/ "./app/components/construct-view/sunburst.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3__ = __webpack_require__(\"./app/bower_components/d3/d3.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_d3__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Sunburst; });\n\n\n\nvar Sunburst = function () {\n    function Sunburst($element, $compile, $scope, sparqlItemService, fibraService) {\n        var _this = this;\n        this.$element = $element;\n        this.$compile = $compile;\n        this.$scope = $scope;\n        this.sparqlItemService = sparqlItemService;\n        this.fibraService = fibraService;\n        this.sbRadius = 200;\n        this.lessRadius = this.sbRadius * this.sbRadius / 3 - 12 * 12;\n        this.sbArc = __WEBPACK_IMPORTED_MODULE_0_d3__[\"arc\"]().startAngle(function (d) {\n            return d.x0;\n        }).endAngle(function (d) {\n            return d.x1;\n        }).innerRadius(function (d) {\n            return Math.sqrt(d.y0 - _this.lessRadius);\n        }).outerRadius(function (d) {\n            return Math.sqrt(d.y1 - _this.lessRadius);\n        });\n        this.sbPart = __WEBPACK_IMPORTED_MODULE_0_d3__[\"partition\"]().size([2 * Math.PI, this.sbRadius * this.sbRadius]);\n        this.item_info_tip_displayed = false;\n        this.sbTooltip = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"]('body').append('div').style('position', 'absolute').style('z-index', '20').style('background-color', 'gray').style('color', 'white').style('padding', '3px').style('border-radius', '2px').style('visibility', 'hidden');\n        this.item_info_tip = __WEBPACK_IMPORTED_MODULE_0_d3__[\"select\"]('body').append('div').attr('id', 'item_info_tip').style('position', 'absolute').style('z-index', '20').style('background-color', 'white').style('padding', '3px').style('visibility', 'hidden');\n        // Typescript messes with `this` depending on caller. Override.\n        this.buildSunburst = this.buildSunburst.bind(this);\n    }\n    Sunburst.prototype.addSunburstGroup = function (sel) {\n        var _this = this;\n        this.sel = sel;\n        if (this.sbGroup) this.sbGroup.remove();\n        this.sbGroup = sel.append('g').classed('sunburst-overlay', true);\n        // Handle info overlay\n        this.sel.on('click', function () {\n            if (_this.item_info_tip_displayed) {\n                _this.item_info_tip.style('visibility', 'hidden');\n                _this.item_info_tip_displayed = false;\n            }\n        });\n    };\n    Sunburst.prototype.buildSunburst = function (d, i, g) {\n        var _this = this;\n        this.original_data = d;\n        this.sbGroup.attr('transform', function (d) {\n            return 'translate(' + d.gx + ',' + d.gy + ')';\n        });\n        // Group by property type -> property value\n        var hier = __WEBPACK_IMPORTED_MODULE_0_d3__[\"hierarchy\"](d, function (node) {\n            if (node.localProperties) {\n                // Root node\n                return node.localProperties.concat(node.remoteProperties);\n            } else {\n                // Property node\n                return node.values ? node.values.map(function (n) {\n                    return n.value;\n                }) : undefined;\n            }\n        });\n        hier.sum(function (d) {\n            return d.values === undefined && d.localProperties === undefined ? 1 : 0;\n        });\n        var part = this.sbPart(hier);\n        var paths = this.sbGroup.selectAll(\"path\").data(hier.descendants(), function (d) {\n            return d.data;\n        });\n        paths.exit().remove();\n        paths.enter().filter(function (d) {\n            return d.depth > 0;\n        }).append(\"path\").classed(\"sunburst-cell\", true).on('mouseover', function (d, i) {\n            _this.sbTooltip.style('top', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].pageY - 10 + 'px').style('left', __WEBPACK_IMPORTED_MODULE_0_d3__[\"event\"].pageX + 10 + 'px').style('visibility', 'visible').text(d.depth === 2 ? d.data.label + \" (click to add)\" : d.data.label + \" (click to add all children)\");\n        }).on('mouseout', function () {\n            _this.sbTooltip.style('visibility', 'hidden');\n        }).on('click', function (d, i) {\n            if (d.depth === 2) {\n                // Leaf\n                _this.fibraService.dispatchAction(_this.fibraService.displayItem(d.data));\n            } else {\n                // Property\n                _this.fibraService.dispatchAction(_this.fibraService.displayItems(d.children.map(function (hn) {\n                    return hn.data;\n                })));\n            }\n            _this.original_data.selected = false;\n            _this.sbTooltip.style('visibility', 'hidden');\n            _this.sbGroup.remove();\n        }).merge(paths).attr(\"d\", this.sbArc).style(\"stroke\", \"#fff\");\n    };\n    Sunburst.prototype.selectItem = function (id) {\n        this.selectedItem = id;\n    };\n    return Sunburst;\n}();\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvY29tcG9uZW50cy9jb25zdHJ1Y3Qtdmlldy9zdW5idXJzdC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hcHAvY29tcG9uZW50cy9jb25zdHJ1Y3Qtdmlldy9zdW5idXJzdC50cz82ZWQxIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmltcG9ydCAqIGFzIGQzIGZyb20gJ2QzJztcbnZhciBTdW5idXJzdCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3VuYnVyc3QoJGVsZW1lbnQsICRjb21waWxlLCAkc2NvcGUsIHNwYXJxbEl0ZW1TZXJ2aWNlLCBmaWJyYVNlcnZpY2UpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy4kZWxlbWVudCA9ICRlbGVtZW50O1xuICAgICAgICB0aGlzLiRjb21waWxlID0gJGNvbXBpbGU7XG4gICAgICAgIHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuICAgICAgICB0aGlzLnNwYXJxbEl0ZW1TZXJ2aWNlID0gc3BhcnFsSXRlbVNlcnZpY2U7XG4gICAgICAgIHRoaXMuZmlicmFTZXJ2aWNlID0gZmlicmFTZXJ2aWNlO1xuICAgICAgICB0aGlzLnNiUmFkaXVzID0gMjAwO1xuICAgICAgICB0aGlzLmxlc3NSYWRpdXMgPSB0aGlzLnNiUmFkaXVzICogdGhpcy5zYlJhZGl1cyAvIDMgLSAxMiAqIDEyO1xuICAgICAgICB0aGlzLnNiQXJjID0gZDMuYXJjKClcbiAgICAgICAgICAgIC5zdGFydEFuZ2xlKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLngwOyB9KVxuICAgICAgICAgICAgLmVuZEFuZ2xlKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLngxOyB9KVxuICAgICAgICAgICAgLmlubmVyUmFkaXVzKGZ1bmN0aW9uIChkKSB7IHJldHVybiBNYXRoLnNxcnQoZC55MCAtIF90aGlzLmxlc3NSYWRpdXMpOyB9KVxuICAgICAgICAgICAgLm91dGVyUmFkaXVzKGZ1bmN0aW9uIChkKSB7IHJldHVybiBNYXRoLnNxcnQoZC55MSAtIF90aGlzLmxlc3NSYWRpdXMpOyB9KTtcbiAgICAgICAgdGhpcy5zYlBhcnQgPSBkMy5wYXJ0aXRpb24oKVxuICAgICAgICAgICAgLnNpemUoWzIgKiBNYXRoLlBJLCB0aGlzLnNiUmFkaXVzICogdGhpcy5zYlJhZGl1c10pO1xuICAgICAgICB0aGlzLml0ZW1faW5mb190aXBfZGlzcGxheWVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2JUb29sdGlwID0gZDMuc2VsZWN0KCdib2R5JykuYXBwZW5kKCdkaXYnKVxuICAgICAgICAgICAgLnN0eWxlKCdwb3NpdGlvbicsICdhYnNvbHV0ZScpXG4gICAgICAgICAgICAuc3R5bGUoJ3otaW5kZXgnLCAnMjAnKVxuICAgICAgICAgICAgLnN0eWxlKCdiYWNrZ3JvdW5kLWNvbG9yJywgJ2dyYXknKVxuICAgICAgICAgICAgLnN0eWxlKCdjb2xvcicsICd3aGl0ZScpXG4gICAgICAgICAgICAuc3R5bGUoJ3BhZGRpbmcnLCAnM3B4JylcbiAgICAgICAgICAgIC5zdHlsZSgnYm9yZGVyLXJhZGl1cycsICcycHgnKVxuICAgICAgICAgICAgLnN0eWxlKCd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1xuICAgICAgICB0aGlzLml0ZW1faW5mb190aXAgPSBkMy5zZWxlY3QoJ2JvZHknKS5hcHBlbmQoJ2RpdicpXG4gICAgICAgICAgICAuYXR0cignaWQnLCAnaXRlbV9pbmZvX3RpcCcpXG4gICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2Fic29sdXRlJylcbiAgICAgICAgICAgIC5zdHlsZSgnei1pbmRleCcsICcyMCcpXG4gICAgICAgICAgICAuc3R5bGUoJ2JhY2tncm91bmQtY29sb3InLCAnd2hpdGUnKVxuICAgICAgICAgICAgLnN0eWxlKCdwYWRkaW5nJywgJzNweCcpXG4gICAgICAgICAgICAuc3R5bGUoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG4gICAgICAgIC8vIFR5cGVzY3JpcHQgbWVzc2VzIHdpdGggYHRoaXNgIGRlcGVuZGluZyBvbiBjYWxsZXIuIE92ZXJyaWRlLlxuICAgICAgICB0aGlzLmJ1aWxkU3VuYnVyc3QgPSB0aGlzLmJ1aWxkU3VuYnVyc3QuYmluZCh0aGlzKTtcbiAgICB9XG4gICAgU3VuYnVyc3QucHJvdG90eXBlLmFkZFN1bmJ1cnN0R3JvdXAgPSBmdW5jdGlvbiAoc2VsKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2VsID0gc2VsO1xuICAgICAgICBpZiAodGhpcy5zYkdyb3VwKVxuICAgICAgICAgICAgdGhpcy5zYkdyb3VwLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLnNiR3JvdXAgPSBzZWwuYXBwZW5kKCdnJylcbiAgICAgICAgICAgIC5jbGFzc2VkKCdzdW5idXJzdC1vdmVybGF5JywgdHJ1ZSk7XG4gICAgICAgIC8vIEhhbmRsZSBpbmZvIG92ZXJsYXlcbiAgICAgICAgdGhpcy5zZWwub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKF90aGlzLml0ZW1faW5mb190aXBfZGlzcGxheWVkKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXRlbV9pbmZvX3RpcC5zdHlsZSgndmlzaWJpbGl0eScsICdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5pdGVtX2luZm9fdGlwX2Rpc3BsYXllZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFN1bmJ1cnN0LnByb3RvdHlwZS5idWlsZFN1bmJ1cnN0ID0gZnVuY3Rpb24gKGQsIGksIGcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5vcmlnaW5hbF9kYXRhID0gZDtcbiAgICAgICAgdGhpcy5zYkdyb3VwLmF0dHIoJ3RyYW5zZm9ybScsIGZ1bmN0aW9uIChkKSB7IHJldHVybiAndHJhbnNsYXRlKCcgKyBkLmd4ICsgJywnICsgZC5neSArICcpJzsgfSk7XG4gICAgICAgIC8vIEdyb3VwIGJ5IHByb3BlcnR5IHR5cGUgLT4gcHJvcGVydHkgdmFsdWVcbiAgICAgICAgdmFyIGhpZXIgPSBkMy5oaWVyYXJjaHkoZCwgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIGlmIChub2RlLmxvY2FsUHJvcGVydGllcykge1xuICAgICAgICAgICAgICAgIC8vIFJvb3Qgbm9kZVxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlLmxvY2FsUHJvcGVydGllcy5jb25jYXQobm9kZS5yZW1vdGVQcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFByb3BlcnR5IG5vZGVcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS52YWx1ZXMgPyBub2RlLnZhbHVlcy5tYXAoZnVuY3Rpb24gKG4pIHsgcmV0dXJuIG4udmFsdWU7IH0pIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaGllci5zdW0oZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQudmFsdWVzID09PSB1bmRlZmluZWQgJiYgZC5sb2NhbFByb3BlcnRpZXMgPT09IHVuZGVmaW5lZCA/IDEgOiAwOyB9KTtcbiAgICAgICAgdmFyIHBhcnQgPSB0aGlzLnNiUGFydChoaWVyKTtcbiAgICAgICAgdmFyIHBhdGhzID0gdGhpcy5zYkdyb3VwLnNlbGVjdEFsbChcInBhdGhcIilcbiAgICAgICAgICAgIC5kYXRhKGhpZXIuZGVzY2VuZGFudHMoKSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuZGF0YTsgfSk7XG4gICAgICAgIHBhdGhzLmV4aXQoKS5yZW1vdmUoKTtcbiAgICAgICAgcGF0aHMuZW50ZXIoKVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5kZXB0aCA+IDA7IH0pXG4gICAgICAgICAgICAuYXBwZW5kKFwicGF0aFwiKVxuICAgICAgICAgICAgLmNsYXNzZWQoXCJzdW5idXJzdC1jZWxsXCIsIHRydWUpXG4gICAgICAgICAgICAub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uIChkLCBpKSB7XG4gICAgICAgICAgICBfdGhpcy5zYlRvb2x0aXAuc3R5bGUoJ3RvcCcsIChkMy5ldmVudC5wYWdlWSAtIDEwKSArICdweCcpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdsZWZ0JywgKGQzLmV2ZW50LnBhZ2VYICsgMTApICsgJ3B4JylcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpXG4gICAgICAgICAgICAgICAgLnRleHQoZC5kZXB0aCA9PT0gMiA/XG4gICAgICAgICAgICAgICAgKGQuZGF0YS5sYWJlbCArIFwiIChjbGljayB0byBhZGQpXCIpIDpcbiAgICAgICAgICAgICAgICAoZC5kYXRhLmxhYmVsICsgXCIgKGNsaWNrIHRvIGFkZCBhbGwgY2hpbGRyZW4pXCIpKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignbW91c2VvdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5zYlRvb2x0aXAuc3R5bGUoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgICAgIGlmIChkLmRlcHRoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgLy8gTGVhZlxuICAgICAgICAgICAgICAgIF90aGlzLmZpYnJhU2VydmljZS5kaXNwYXRjaEFjdGlvbihfdGhpcy5maWJyYVNlcnZpY2UuZGlzcGxheUl0ZW0oZC5kYXRhKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBQcm9wZXJ0eVxuICAgICAgICAgICAgICAgIF90aGlzLmZpYnJhU2VydmljZS5kaXNwYXRjaEFjdGlvbihfdGhpcy5maWJyYVNlcnZpY2UuZGlzcGxheUl0ZW1zKGQuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChobikgeyByZXR1cm4gaG4uZGF0YTsgfSkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLm9yaWdpbmFsX2RhdGEuc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLnNiVG9vbHRpcC5zdHlsZSgndmlzaWJpbGl0eScsICdoaWRkZW4nKTtcbiAgICAgICAgICAgIF90aGlzLnNiR3JvdXAucmVtb3ZlKCk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAubWVyZ2UocGF0aHMpXG4gICAgICAgICAgICAuYXR0cihcImRcIiwgdGhpcy5zYkFyYylcbiAgICAgICAgICAgIC5zdHlsZShcInN0cm9rZVwiLCBcIiNmZmZcIik7XG4gICAgfTtcbiAgICBTdW5idXJzdC5wcm90b3R5cGUuc2VsZWN0SXRlbSA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkSXRlbSA9IGlkO1xuICAgIH07XG4gICAgcmV0dXJuIFN1bmJ1cnN0O1xufSgpKTtcbmV4cG9ydCB7IFN1bmJ1cnN0IH07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXBwL2NvbXBvbmVudHMvY29uc3RydWN0LXZpZXcvc3VuYnVyc3QudHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBUUE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFJQTtBQU1BO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),

/***/ "./app/components/index.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_angular__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_angular___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_angular__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__projects_view_projects_view_component__ = __webpack_require__(\"./app/components/projects-view/projects-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__citable_citable_component__ = __webpack_require__(\"./app/components/citable/citable-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__social_auth_callback_component__ = __webpack_require__(\"./app/components/social-auth/callback-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__social_auth_login_component__ = __webpack_require__(\"./app/components/social-auth/login-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__construct_view_construct_view_component__ = __webpack_require__(\"./app/components/construct-view/construct-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__construct_view_explore_component__ = __webpack_require__(\"./app/components/construct-view/explore-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__construct_view_property_popover__ = __webpack_require__(\"./app/components/construct-view/property-popover.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__construct_view_palette_component_palette_component__ = __webpack_require__(\"./app/components/construct-view/palette-component/palette-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__construct_view_explore_verify_component_explore_verify_component__ = __webpack_require__(\"./app/components/construct-view/explore-verify-component/explore-verify-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__construct_view_explore_table_component_explore_table_component__ = __webpack_require__(\"./app/components/construct-view/explore-table-component/explore-table-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__construct_view_explore_type_component_explore_type_component__ = __webpack_require__(\"./app/components/construct-view/explore-type-component/explore-type-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__configure_view_configure_view_component__ = __webpack_require__(\"./app/components/configure-view/configure-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__citable_editor_citable_editor_component__ = __webpack_require__(\"./app/components/citable-editor/citable-editor-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__edit_primary_endpoint_configuration_view_edit_primary_endpoint_configuration_view_component__ = __webpack_require__(\"./app/components/edit-primary-endpoint-configuration-view/edit-primary-endpoint-configuration-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__edit_remote_endpoint_configuration_view_edit_remote_endpoint_configuration_view_component__ = __webpack_require__(\"./app/components/edit-remote-endpoint-configuration-view/edit-remote-endpoint-configuration-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__edit_schema_view_edit_schema_view_component__ = __webpack_require__(\"./app/components/edit-schema-view/edit-schema-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__project_source_configurations_view_project_source_configurations_view_component__ = __webpack_require__(\"./app/components/project-source-configurations-view/project-source-configurations-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__project_sources_view_project_sources_view_component__ = __webpack_require__(\"./app/components/project-sources-view/project-sources-view-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__type_select_type_select_component__ = __webpack_require__(\"./app/components/type-select/type-select-component.ts\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__upload_upload_component__ = __webpack_require__(\"./app/components/upload/upload-component.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_angular__[\"module\"]('fibra.components', ['fibra.components.construct-view', 'fibra.components.explore', 'fibra.components.property-popover', 'fibra.components.palette', 'fibra.components.verify', 'fibra.components.explore-table', 'fibra.components.explore-type', 'fibra.components.projects-view', 'fibra.components.citable', 'fibra.components.callback', 'fibra.components.login', 'fibra.components.configure', 'fibra.components.citable-editor', 'fibra.components.edit-primary-endpoint-configuration', 'fibra.components.edit-remote-endpoint-configuration', 'fibra.components.edit-schema-view', 'fibra.components.project-source-configurations-view', 'fibra.components.project-sources-view', 'fibra.components.type-select', 'fibra.components.upload']);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvY29tcG9uZW50cy9pbmRleC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hcHAvY29tcG9uZW50cy9pbmRleC50cz8zMWZkIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmltcG9ydCAqIGFzIGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgJy4vcHJvamVjdHMtdmlldy9wcm9qZWN0cy12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vY2l0YWJsZS9jaXRhYmxlLWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vc29jaWFsLWF1dGgvY2FsbGJhY2stY29tcG9uZW50JztcbmltcG9ydCAnLi9zb2NpYWwtYXV0aC9sb2dpbi1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2NvbnN0cnVjdC12aWV3L2NvbnN0cnVjdC12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vY29uc3RydWN0LXZpZXcvZXhwbG9yZS1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2NvbnN0cnVjdC12aWV3L3Byb3BlcnR5LXBvcG92ZXInO1xuaW1wb3J0ICcuL2NvbnN0cnVjdC12aWV3L3BhbGV0dGUtY29tcG9uZW50L3BhbGV0dGUtY29tcG9uZW50JztcbmltcG9ydCAnLi9jb25zdHJ1Y3Qtdmlldy9leHBsb3JlLXZlcmlmeS1jb21wb25lbnQvZXhwbG9yZS12ZXJpZnktY29tcG9uZW50JztcbmltcG9ydCAnLi9jb25zdHJ1Y3Qtdmlldy9leHBsb3JlLXRhYmxlLWNvbXBvbmVudC9leHBsb3JlLXRhYmxlLWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vY29uc3RydWN0LXZpZXcvZXhwbG9yZS10eXBlLWNvbXBvbmVudC9leHBsb3JlLXR5cGUtY29tcG9uZW50JztcbmltcG9ydCAnLi9jb25maWd1cmUtdmlldy9jb25maWd1cmUtdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2NpdGFibGUtZWRpdG9yL2NpdGFibGUtZWRpdG9yLWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vZWRpdC1wcmltYXJ5LWVuZHBvaW50LWNvbmZpZ3VyYXRpb24tdmlldy9lZGl0LXByaW1hcnktZW5kcG9pbnQtY29uZmlndXJhdGlvbi12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vZWRpdC1yZW1vdGUtZW5kcG9pbnQtY29uZmlndXJhdGlvbi12aWV3L2VkaXQtcmVtb3RlLWVuZHBvaW50LWNvbmZpZ3VyYXRpb24tdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL2VkaXQtc2NoZW1hLXZpZXcvZWRpdC1zY2hlbWEtdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL3Byb2plY3Qtc291cmNlLWNvbmZpZ3VyYXRpb25zLXZpZXcvcHJvamVjdC1zb3VyY2UtY29uZmlndXJhdGlvbnMtdmlldy1jb21wb25lbnQnO1xuaW1wb3J0ICcuL3Byb2plY3Qtc291cmNlcy12aWV3L3Byb2plY3Qtc291cmNlcy12aWV3LWNvbXBvbmVudCc7XG5pbXBvcnQgJy4vdHlwZS1zZWxlY3QvdHlwZS1zZWxlY3QtY29tcG9uZW50JztcbmltcG9ydCAnLi91cGxvYWQvdXBsb2FkLWNvbXBvbmVudCc7XG5hbmd1bGFyLm1vZHVsZSgnZmlicmEuY29tcG9uZW50cycsIFtcbiAgICAnZmlicmEuY29tcG9uZW50cy5jb25zdHJ1Y3QtdmlldycsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMuZXhwbG9yZScsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMucHJvcGVydHktcG9wb3ZlcicsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMucGFsZXR0ZScsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMudmVyaWZ5JyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5leHBsb3JlLXRhYmxlJyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5leHBsb3JlLXR5cGUnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLnByb2plY3RzLXZpZXcnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmNpdGFibGUnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmNhbGxiYWNrJyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5sb2dpbicsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMuY29uZmlndXJlJyxcbiAgICAnZmlicmEuY29tcG9uZW50cy5jaXRhYmxlLWVkaXRvcicsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMuZWRpdC1wcmltYXJ5LWVuZHBvaW50LWNvbmZpZ3VyYXRpb24nLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmVkaXQtcmVtb3RlLWVuZHBvaW50LWNvbmZpZ3VyYXRpb24nLFxuICAgICdmaWJyYS5jb21wb25lbnRzLmVkaXQtc2NoZW1hLXZpZXcnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLnByb2plY3Qtc291cmNlLWNvbmZpZ3VyYXRpb25zLXZpZXcnLFxuICAgICdmaWJyYS5jb21wb25lbnRzLnByb2plY3Qtc291cmNlcy12aWV3JyxcbiAgICAnZmlicmEuY29tcG9uZW50cy50eXBlLXNlbGVjdCcsXG4gICAgJ2ZpYnJhLmNvbXBvbmVudHMudXBsb2FkJ1xuXSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXBwL2NvbXBvbmVudHMvaW5kZXgudHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ "./app/services/fibra-service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_angular__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_angular___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_angular__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__worker_service_worker_service__ = __webpack_require__(\"./app/services/worker-service/worker-service.ts\");\n/* unused harmony export CommonState */\n/* unused harmony export ConstructState */\n/* unused harmony export UIState */\n/* unused harmony export FibraService */\n\n\nvar __extends = this && this.__extends || function () {\n    var extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (d, b) {\n        d.__proto__ = b;\n    } || function (d, b) {\n        for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() {\n            this.constructor = d;\n        }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n}();\n\n\nvar CommonState = function () {\n    function CommonState(project, language) {\n        if (project === void 0) {\n            project = null;\n        }\n        if (language === void 0) {\n            language = 'en';\n        }\n        this.project = project;\n        this.language = language;\n    }\n    return CommonState;\n}();\n\nvar ConstructState = function () {\n    function ConstructState() {\n        this.types = [];\n        this.userTypes = [];\n        this.displayTypes = [];\n        this.items = [];\n        this.itemIndex = {};\n        this.localItems = [];\n    }\n    return ConstructState;\n}();\n\nvar UIState = function (_super) {\n    __extends(UIState, _super);\n    function UIState() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.construct = new ConstructState();\n        _this.actionsRunning = 0;\n        return _this;\n    }\n    UIState.prototype.toCommonState = function () {\n        return new CommonState(this.project, this.language);\n    };\n    return UIState;\n}(CommonState);\n\nvar PLACEHOLDER = 'PLACEHOLDER';\n// const CREATE_TYPE: string = 'CREATE_TYPE'\n// const CREATE_ITEMS: string = 'CREATE_ITEMS'\n// const CREATE_DISPLAY_ITEMS: string = 'CREATE_DISPLAY_ITEMS'\n// const DELETE_ITEMS: string = 'DELETE_ITEMS'\n// const CLEAR_TYPES: string = 'CLEAR_TYPES'\n// const DISPLAY_ITEMS: string = 'DISPLAY_ITEMS'\n// const HIDE_ITEM: string = 'HIDE_ITEM'\n// const CREATE_LOCAL_ITEM: string = 'CREATE_LOCAL_ITEM'\n// const ITEM_PROPERTIES: string = 'ITEM_PROPERTIES'\n// const SET_ORDERED_TYPES: string = 'SET_ORDERED_TYPES'\nvar SET_LANGUAGE = 'SET_LANGUAGE';\nvar SET_PROJECT = 'SET_PROJECT';\nvar INITIAL_STATE = new UIState();\nvar DEFAULT_ACTION = { type: '', payload: null };\nvar FibraService = function () {\n    function FibraService($q, workerService, sparqlItemService, sparqlTreeService) {\n        this.$q = $q;\n        this.workerService = workerService;\n        this.sparqlItemService = sparqlItemService;\n        this.sparqlTreeService = sparqlTreeService;\n        // Event model - Based on d3.event\n        this.callbacks = {};\n        this.createState();\n    }\n    // Returns a function that can be called to remove the callback\n    FibraService.prototype.on = function (evnt, callback) {\n        var _this = this;\n        if (this.callbacks[evnt] === undefined) this.callbacks[evnt] = Array();\n        this.callbacks[evnt].push(callback);\n        return function () {\n            if (_this.callbacks[evnt].indexOf(callback) !== -1) _this.callbacks[evnt].splice(_this.callbacks[evnt].indexOf(callback), 1);\n        };\n    };\n    FibraService.prototype.dispatch = function (evnt) {\n        if (this.callbacks[evnt] === undefined) this.callbacks[evnt] = Array();\n        var proms = this.callbacks[evnt].map(function (cb) {\n            return cb();\n        });\n        return this.$q.all(proms);\n    };\n    FibraService.prototype.createState = function () {\n        this.state = INITIAL_STATE;\n        if (!this.store) {\n            this.createStore();\n        }\n    };\n    FibraService.prototype.createStore = function () {\n        this.store = [this.state];\n    };\n    // Action creators\n    FibraService.prototype.placeHolderAction = function (prom) {\n        return {\n            type: PLACEHOLDER,\n            payload: prom\n        };\n    };\n    FibraService.prototype.setLanguage = function (language) {\n        return { type: SET_LANGUAGE, payload: language };\n    };\n    FibraService.prototype.setProject = function (project) {\n        return { type: SET_PROJECT, payload: project };\n    };\n    // public createLocalItem(item: ITerm): Action {\n    //   return {\n    //     type: CREATE_LOCAL_ITEM,\n    //     payload: item\n    //   }\n    // }\n    // public displayItem(item: ITerm, coordinates?: [number]): Action {\n    //   return {\n    //     type: DISPLAY_ITEMS,\n    //     payload: {\n    //       items: [item],\n    //       coordinates: [coordinates]\n    //     }\n    //   }\n    // }\n    // public displayItems(items: ITerm[], coordinates?: [number][]): Action {\n    //   return {\n    //     type: DISPLAY_ITEMS,\n    //     payload: {\n    //       items: items,\n    //       coordinates: coordinates\n    //     }\n    //   }\n    // }\n    // public hideItem(item: ITerm): Action {\n    //   return {\n    //     type: HIDE_ITEM,\n    //     payload: item\n    //   }\n    // }\n    // public itemProperty(item: INode, propertiesToAdd: IPropertyAndValue[], propertiesToRemove?: IPropertyAndValue[]) {\n    //   return {\n    //     type: ITEM_PROPERTIES,\n    //     payload: {\n    //       item: item,\n    //       propertiesToAdd: propertiesToAdd,\n    //       propertiesToRemove: propertiesToRemove\n    //     }\n    //   }\n    // }\n    // public createItem(item?: INode, typ?: string):Action {\n    //   return {\n    //     type: CREATE_ITEMS,\n    //     payload: {\n    //       items: [item],\n    //       type: typ\n    //     }\n    //   }\n    // }\n    // public createItems(items: INode[], typ?: string): Action {\n    //   return {\n    //     type: CREATE_ITEMS,\n    //     payload: {\n    //       items: items,\n    //       type: typ\n    //     }\n    //   }\n    // }\n    // public createDisplayItem(item?: INode, typ?: string): Action {\n    //   return {\n    //     type: CREATE_DISPLAY_ITEMS,\n    //     payload: {\n    //       items: [item],\n    //       type: typ\n    //     }\n    //   }\n    // }\n    // public createDisplayItems(items: INode[], typ?: string): Action {\n    //   return {\n    //     type: CREATE_DISPLAY_ITEMS,\n    //     payload: {\n    //       items: items,\n    //       type: typ\n    //     }\n    //   }\n    // }\n    // public deleteItem(item: INode): Action {\n    //   return {\n    //     type: DELETE_ITEMS,\n    //     payload: [item]\n    //   }\n    // }\n    // public clearTypes(): Action {\n    //   return {\n    //     type: CLEAR_TYPES,\n    //     payload: undefined\n    //   }\n    // }\n    // public setOrderedTypes(types: TreeNode[]): Action {\n    //   return {\n    //     type: SET_ORDERED_TYPES,\n    //     payload: types\n    //   }\n    // }\n    // public createType(label: string): Action {\n    //   return {\n    //     type: CREATE_TYPE,\n    //     payload: label\n    //   }\n    // }\n    // Reducers\n    FibraService.prototype.itemReducer = function (state, action) {\n        if (state === void 0) {\n            state = INITIAL_STATE;\n        }\n        if (action === void 0) {\n            action = DEFAULT_ACTION;\n        }\n        switch (action.type) {\n            // case DISPLAY_ITEMS:\n            //   action.payload.items.forEach((item, i) => {\n            //     if(!state.construct.itemIndex[item.value]) {\n            //       state.construct.items.push(item)\n            //       state.construct.itemIndex[item.value] = item\n            //       // If coordinates are provided, apply them\n            //       if(action.payload.coordinates && action.payload.coordinates[i] && action.payload.coordinates[i][0] && action.payload.coordinates[i][1]) {\n            //         state.construct.itemIndex[item.value].x = action.payload.coordinates[i][0]\n            //         state.construct.itemIndex[item.value].y = action.payload.coordinates[i][1]\n            //       }\n            //     }\n            //   })\n            //   this.dispatch('change')\n            //   return this.$q.resolve(state)\n            // case HIDE_ITEM:\n            //   let it = state.construct.itemIndex[action.payload.value]\n            //   if(it) {\n            //     state.construct.items.splice(state.construct.items.indexOf(it), 1)\n            //     delete state.construct.itemIndex[action.payload.value]\n            //   }\n            //   this.dispatch('change')\n            //   return this.$q.resolve(state)\n            // case CREATE_LOCAL_ITEM:\n            //   let item: IGridNode = action.payload\n            //   state.construct.localItems.push(item)\n            //   return this.$q.resolve(state)\n            // case CREATE_ITEMS:\n            //   return this.createItemsInternal(action, state).then((nodes) => {\n            //     return state\n            //   })\n            // case CREATE_DISPLAY_ITEMS:\n            //   return this.createItemsInternal(action, state).then((nodes) => {\n            //     return this.dispatchAction(this.displayItems(nodes))\n            //   })\n            // case DELETE_ITEMS:\n            //   return this.$q.all(action.payload.map((item: INode) => {\n            //     return this.sparqlItemService.deleteItem(item)\n            //   })).then(() => {\n            //     this.dispatch('change')\n            //     return this.state\n            //   })\n            // case ITEM_PROPERTIES:\n            //   return this.sparqlItemService.alterItem(action.payload.item, action.payload.propertiesToAdd, action.payload.propertiesToRemove).then((str) => {\n            //     return this.state\n            //   })\n            default:\n                return this.$q.resolve(state);\n        }\n    };\n    FibraService.prototype.sessionReducer = function (state, action) {\n        if (state === void 0) {\n            state = INITIAL_STATE;\n        }\n        if (action === void 0) {\n            action = DEFAULT_ACTION;\n        }\n        switch (action.type) {\n            case SET_LANGUAGE:\n                state.language = action.payload;\n                return this.$q.resolve(state);\n            case SET_PROJECT:\n                state.project = action.payload;\n                return this.$q.resolve(state);\n            default:\n                return this.$q.resolve(state);\n        }\n    };\n    FibraService.prototype.constructReducer = function (state, action) {\n        if (state === void 0) {\n            state = INITIAL_STATE;\n        }\n        if (action === void 0) {\n            action = DEFAULT_ACTION;\n        }\n        switch (action.type) {\n            case PLACEHOLDER:\n                return action.payload.then(function () {\n                    return state;\n                });\n            // case CLEAR_TYPES:\n            //   state.construct.types = []\n            //   return this.$q.resolve(state)\n            // case SET_ORDERED_TYPES:\n            //   state.construct.displayTypes = action.payload\n            //   return this.$q.resolve(state)\n            // case CREATE_TYPE:\n            //   return this.sparqlItemService.createNewItem([new PropertyAndValue(SKOS.prefLabel, DataFactory.instance.literal(action.payload)), new PropertyAndValue(RDF.type, OWL.Class)]).then((node) => {\n            //     let tn: TreeNode = new TreeNode(node.value, action.payload)\n            //     this.state.construct.userTypes.push(tn)\n            //     return this.state\n            //   })\n            default:\n                return this.$q.resolve(state);\n        }\n    };\n    // private createItemsInternal(action, state): angular.IPromise<INode[]> {\n    //   let items: Item[] = action.payload.items\n    //   let typeNode: INamedNode = action.payload.type ? DataFactory.instance.namedNode(action.payload.type) : OWL.Thing\n    //   if (items[0]) {\n    //     let proms = items.map((node) => {\n    //       if (node.value) {\n    //         return this.sparqlItemService.createNewItem([new PropertyAndValue(SKOS.prefLabel, DataFactory.instance.literal(node.value)), new PropertyAndValue(RDF.type, typeNode)])\n    //       } else {\n    //         return this.sparqlItemService.createNewItem([new PropertyAndValue(RDF.type, typeNode)])\n    //       }\n    //       // return this.sparqlItemService.getItem(node).then((item) => {\n    //       //   let prefLabelProp = item.localProperties.concat(item.remoteProperties).filter((pr) => {\n    //       //     return pr.value === 'http://www.w3.org/2004/02/skos/core#prefLabel'\n    //       //   })\n    //       //   let type: PropertyToValues<INode> = new PropertyToValues(RDF.type)\n    //       //   let typeProp = item.localProperties.concat(item.remoteProperties).filter((pr) => {\n    //       //     return pr.value === 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type'\n    //       //   })\n    //       //   if(typeProp[0]) {\n    //       //     let typeWithLabel: INodePlusLabel = new SourcedNodePlusLabel(typeProp[0])\n    //       //     type.values.push(typeWithLabel)\n    //       //   }\n    //       //   return this.sparqlItemService.createNewItem([item], [type, prefLabelProp[0]])\n    //       // }).then((node) => {\n    //       //   // Display the item\n    //       //   return this.dispatchAction(this.displayItem(node))\n    //       // })\n    //     })\n    //     return this.$q.all(proms)\n    //   } else {\n    //     return this.sparqlItemService.createNewItem([new PropertyAndValue(RDF.type, typeNode), new PropertyAndValue(SKOS.prefLabel, DataFactory.instance.literal(''))]).then((node) => {\n    //       return [node]\n    //     })\n    //   }\n    // }\n    // Public API\n    FibraService.prototype.dispatchAction = function (action) {\n        var _this = this;\n        this.state.actionsRunning = this.state.actionsRunning + 1;\n        console.log(action.type, this.state.actionsRunning);\n        this.dispatch('action');\n        var oldCommonState = this.state.toCommonState();\n        return this.constructReducer(this.state, action).then(function (state) {\n            return _this.itemReducer(state, action);\n        }).then(function (state) {\n            return _this.sessionReducer(state, action);\n        }).then(function (state) {\n            if (state.language !== oldCommonState.language || state.project !== oldCommonState.project) {\n                var wstate = state.toCommonState();\n                __WEBPACK_IMPORTED_MODULE_1__worker_service_worker_service__[\"b\" /* WorkerService */].savePrototypes(wstate);\n                _this.workerService.callAll('stateWorkerService', 'setState', [wstate]);\n            }\n            _this.state = state;\n            _this.state.actionsRunning = _this.state.actionsRunning - 1;\n            return state;\n        });\n    };\n    FibraService.prototype.getState = function () {\n        return this.state;\n    };\n    FibraService.prototype.undo = function () {};\n    return FibraService;\n}();\n\n__WEBPACK_IMPORTED_MODULE_0_angular__[\"module\"]('fibra.services.fibra-service', []).config(function ($provide) {\n    $provide.service('fibraService', FibraService);\n});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvc2VydmljZXMvZmlicmEtc2VydmljZS50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hcHAvc2VydmljZXMvZmlicmEtc2VydmljZS50cz82ZWY5Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0ICogYXMgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCB7IFdvcmtlclNlcnZpY2UgfSBmcm9tICcuL3dvcmtlci1zZXJ2aWNlL3dvcmtlci1zZXJ2aWNlJztcbnZhciBDb21tb25TdGF0ZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29tbW9uU3RhdGUocHJvamVjdCwgbGFuZ3VhZ2UpIHtcbiAgICAgICAgaWYgKHByb2plY3QgPT09IHZvaWQgMCkgeyBwcm9qZWN0ID0gbnVsbDsgfVxuICAgICAgICBpZiAobGFuZ3VhZ2UgPT09IHZvaWQgMCkgeyBsYW5ndWFnZSA9ICdlbic7IH1cbiAgICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdDtcbiAgICAgICAgdGhpcy5sYW5ndWFnZSA9IGxhbmd1YWdlO1xuICAgIH1cbiAgICByZXR1cm4gQ29tbW9uU3RhdGU7XG59KCkpO1xuZXhwb3J0IHsgQ29tbW9uU3RhdGUgfTtcbnZhciBDb25zdHJ1Y3RTdGF0ZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29uc3RydWN0U3RhdGUoKSB7XG4gICAgICAgIHRoaXMudHlwZXMgPSBbXTtcbiAgICAgICAgdGhpcy51c2VyVHlwZXMgPSBbXTtcbiAgICAgICAgdGhpcy5kaXNwbGF5VHlwZXMgPSBbXTtcbiAgICAgICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgICAgICB0aGlzLml0ZW1JbmRleCA9IHt9O1xuICAgICAgICB0aGlzLmxvY2FsSXRlbXMgPSBbXTtcbiAgICB9XG4gICAgcmV0dXJuIENvbnN0cnVjdFN0YXRlO1xufSgpKTtcbmV4cG9ydCB7IENvbnN0cnVjdFN0YXRlIH07XG52YXIgVUlTdGF0ZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJU3RhdGUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVUlTdGF0ZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNvbnN0cnVjdCA9IG5ldyBDb25zdHJ1Y3RTdGF0ZSgpO1xuICAgICAgICBfdGhpcy5hY3Rpb25zUnVubmluZyA9IDA7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgVUlTdGF0ZS5wcm90b3R5cGUudG9Db21tb25TdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDb21tb25TdGF0ZSh0aGlzLnByb2plY3QsIHRoaXMubGFuZ3VhZ2UpO1xuICAgIH07XG4gICAgcmV0dXJuIFVJU3RhdGU7XG59KENvbW1vblN0YXRlKSk7XG5leHBvcnQgeyBVSVN0YXRlIH07XG52YXIgUExBQ0VIT0xERVIgPSAnUExBQ0VIT0xERVInO1xuLy8gY29uc3QgQ1JFQVRFX1RZUEU6IHN0cmluZyA9ICdDUkVBVEVfVFlQRSdcbi8vIGNvbnN0IENSRUFURV9JVEVNUzogc3RyaW5nID0gJ0NSRUFURV9JVEVNUydcbi8vIGNvbnN0IENSRUFURV9ESVNQTEFZX0lURU1TOiBzdHJpbmcgPSAnQ1JFQVRFX0RJU1BMQVlfSVRFTVMnXG4vLyBjb25zdCBERUxFVEVfSVRFTVM6IHN0cmluZyA9ICdERUxFVEVfSVRFTVMnXG4vLyBjb25zdCBDTEVBUl9UWVBFUzogc3RyaW5nID0gJ0NMRUFSX1RZUEVTJ1xuLy8gY29uc3QgRElTUExBWV9JVEVNUzogc3RyaW5nID0gJ0RJU1BMQVlfSVRFTVMnXG4vLyBjb25zdCBISURFX0lURU06IHN0cmluZyA9ICdISURFX0lURU0nXG4vLyBjb25zdCBDUkVBVEVfTE9DQUxfSVRFTTogc3RyaW5nID0gJ0NSRUFURV9MT0NBTF9JVEVNJ1xuLy8gY29uc3QgSVRFTV9QUk9QRVJUSUVTOiBzdHJpbmcgPSAnSVRFTV9QUk9QRVJUSUVTJ1xuLy8gY29uc3QgU0VUX09SREVSRURfVFlQRVM6IHN0cmluZyA9ICdTRVRfT1JERVJFRF9UWVBFUydcbnZhciBTRVRfTEFOR1VBR0UgPSAnU0VUX0xBTkdVQUdFJztcbnZhciBTRVRfUFJPSkVDVCA9ICdTRVRfUFJPSkVDVCc7XG52YXIgSU5JVElBTF9TVEFURSA9IG5ldyBVSVN0YXRlKCk7XG52YXIgREVGQVVMVF9BQ1RJT04gPSB7IHR5cGU6ICcnLCBwYXlsb2FkOiBudWxsIH07XG52YXIgRmlicmFTZXJ2aWNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGaWJyYVNlcnZpY2UoJHEsIHdvcmtlclNlcnZpY2UsIHNwYXJxbEl0ZW1TZXJ2aWNlLCBzcGFycWxUcmVlU2VydmljZSkge1xuICAgICAgICB0aGlzLiRxID0gJHE7XG4gICAgICAgIHRoaXMud29ya2VyU2VydmljZSA9IHdvcmtlclNlcnZpY2U7XG4gICAgICAgIHRoaXMuc3BhcnFsSXRlbVNlcnZpY2UgPSBzcGFycWxJdGVtU2VydmljZTtcbiAgICAgICAgdGhpcy5zcGFycWxUcmVlU2VydmljZSA9IHNwYXJxbFRyZWVTZXJ2aWNlO1xuICAgICAgICAvLyBFdmVudCBtb2RlbCAtIEJhc2VkIG9uIGQzLmV2ZW50XG4gICAgICAgIHRoaXMuY2FsbGJhY2tzID0ge307XG4gICAgICAgIHRoaXMuY3JlYXRlU3RhdGUoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIGNhbGxlZCB0byByZW1vdmUgdGhlIGNhbGxiYWNrXG4gICAgRmlicmFTZXJ2aWNlLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldm50LCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5jYWxsYmFja3NbZXZudF0gPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tzW2V2bnRdID0gQXJyYXkoKTtcbiAgICAgICAgdGhpcy5jYWxsYmFja3NbZXZudF0ucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMuY2FsbGJhY2tzW2V2bnRdLmluZGV4T2YoY2FsbGJhY2spICE9PSAtMSlcbiAgICAgICAgICAgICAgICBfdGhpcy5jYWxsYmFja3NbZXZudF0uc3BsaWNlKF90aGlzLmNhbGxiYWNrc1tldm50XS5pbmRleE9mKGNhbGxiYWNrKSwgMSk7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBGaWJyYVNlcnZpY2UucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKGV2bnQpIHtcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tzW2V2bnRdID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrc1tldm50XSA9IEFycmF5KCk7XG4gICAgICAgIHZhciBwcm9tcyA9IHRoaXMuY2FsbGJhY2tzW2V2bnRdLm1hcChmdW5jdGlvbiAoY2IpIHsgcmV0dXJuIGNiKCk7IH0pO1xuICAgICAgICByZXR1cm4gdGhpcy4kcS5hbGwocHJvbXMpO1xuICAgIH07XG4gICAgRmlicmFTZXJ2aWNlLnByb3RvdHlwZS5jcmVhdGVTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IElOSVRJQUxfU1RBVEU7XG4gICAgICAgIGlmICghdGhpcy5zdG9yZSkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVTdG9yZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWJyYVNlcnZpY2UucHJvdG90eXBlLmNyZWF0ZVN0b3JlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnN0b3JlID0gW3RoaXMuc3RhdGVdO1xuICAgIH07XG4gICAgLy8gQWN0aW9uIGNyZWF0b3JzXG4gICAgRmlicmFTZXJ2aWNlLnByb3RvdHlwZS5wbGFjZUhvbGRlckFjdGlvbiA9IGZ1bmN0aW9uIChwcm9tKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBQTEFDRUhPTERFUixcbiAgICAgICAgICAgIHBheWxvYWQ6IHByb21cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEZpYnJhU2VydmljZS5wcm90b3R5cGUuc2V0TGFuZ3VhZ2UgPSBmdW5jdGlvbiAobGFuZ3VhZ2UpIHsgcmV0dXJuIHsgdHlwZTogU0VUX0xBTkdVQUdFLCBwYXlsb2FkOiBsYW5ndWFnZSB9OyB9O1xuICAgIEZpYnJhU2VydmljZS5wcm90b3R5cGUuc2V0UHJvamVjdCA9IGZ1bmN0aW9uIChwcm9qZWN0KSB7IHJldHVybiB7IHR5cGU6IFNFVF9QUk9KRUNULCBwYXlsb2FkOiBwcm9qZWN0IH07IH07XG4gICAgLy8gcHVibGljIGNyZWF0ZUxvY2FsSXRlbShpdGVtOiBJVGVybSk6IEFjdGlvbiB7XG4gICAgLy8gICByZXR1cm4ge1xuICAgIC8vICAgICB0eXBlOiBDUkVBVEVfTE9DQUxfSVRFTSxcbiAgICAvLyAgICAgcGF5bG9hZDogaXRlbVxuICAgIC8vICAgfVxuICAgIC8vIH1cbiAgICAvLyBwdWJsaWMgZGlzcGxheUl0ZW0oaXRlbTogSVRlcm0sIGNvb3JkaW5hdGVzPzogW251bWJlcl0pOiBBY3Rpb24ge1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgdHlwZTogRElTUExBWV9JVEVNUyxcbiAgICAvLyAgICAgcGF5bG9hZDoge1xuICAgIC8vICAgICAgIGl0ZW1zOiBbaXRlbV0sXG4gICAgLy8gICAgICAgY29vcmRpbmF0ZXM6IFtjb29yZGluYXRlc11cbiAgICAvLyAgICAgfVxuICAgIC8vICAgfVxuICAgIC8vIH1cbiAgICAvLyBwdWJsaWMgZGlzcGxheUl0ZW1zKGl0ZW1zOiBJVGVybVtdLCBjb29yZGluYXRlcz86IFtudW1iZXJdW10pOiBBY3Rpb24ge1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgdHlwZTogRElTUExBWV9JVEVNUyxcbiAgICAvLyAgICAgcGF5bG9hZDoge1xuICAgIC8vICAgICAgIGl0ZW1zOiBpdGVtcyxcbiAgICAvLyAgICAgICBjb29yZGluYXRlczogY29vcmRpbmF0ZXNcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfVxuICAgIC8vIH1cbiAgICAvLyBwdWJsaWMgaGlkZUl0ZW0oaXRlbTogSVRlcm0pOiBBY3Rpb24ge1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgdHlwZTogSElERV9JVEVNLFxuICAgIC8vICAgICBwYXlsb2FkOiBpdGVtXG4gICAgLy8gICB9XG4gICAgLy8gfVxuICAgIC8vIHB1YmxpYyBpdGVtUHJvcGVydHkoaXRlbTogSU5vZGUsIHByb3BlcnRpZXNUb0FkZDogSVByb3BlcnR5QW5kVmFsdWVbXSwgcHJvcGVydGllc1RvUmVtb3ZlPzogSVByb3BlcnR5QW5kVmFsdWVbXSkge1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgdHlwZTogSVRFTV9QUk9QRVJUSUVTLFxuICAgIC8vICAgICBwYXlsb2FkOiB7XG4gICAgLy8gICAgICAgaXRlbTogaXRlbSxcbiAgICAvLyAgICAgICBwcm9wZXJ0aWVzVG9BZGQ6IHByb3BlcnRpZXNUb0FkZCxcbiAgICAvLyAgICAgICBwcm9wZXJ0aWVzVG9SZW1vdmU6IHByb3BlcnRpZXNUb1JlbW92ZVxuICAgIC8vICAgICB9XG4gICAgLy8gICB9XG4gICAgLy8gfVxuICAgIC8vIHB1YmxpYyBjcmVhdGVJdGVtKGl0ZW0/OiBJTm9kZSwgdHlwPzogc3RyaW5nKTpBY3Rpb24ge1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgdHlwZTogQ1JFQVRFX0lURU1TLFxuICAgIC8vICAgICBwYXlsb2FkOiB7XG4gICAgLy8gICAgICAgaXRlbXM6IFtpdGVtXSxcbiAgICAvLyAgICAgICB0eXBlOiB0eXBcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfVxuICAgIC8vIH1cbiAgICAvLyBwdWJsaWMgY3JlYXRlSXRlbXMoaXRlbXM6IElOb2RlW10sIHR5cD86IHN0cmluZyk6IEFjdGlvbiB7XG4gICAgLy8gICByZXR1cm4ge1xuICAgIC8vICAgICB0eXBlOiBDUkVBVEVfSVRFTVMsXG4gICAgLy8gICAgIHBheWxvYWQ6IHtcbiAgICAvLyAgICAgICBpdGVtczogaXRlbXMsXG4gICAgLy8gICAgICAgdHlwZTogdHlwXG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH1cbiAgICAvLyB9XG4gICAgLy8gcHVibGljIGNyZWF0ZURpc3BsYXlJdGVtKGl0ZW0/OiBJTm9kZSwgdHlwPzogc3RyaW5nKTogQWN0aW9uIHtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHR5cGU6IENSRUFURV9ESVNQTEFZX0lURU1TLFxuICAgIC8vICAgICBwYXlsb2FkOiB7XG4gICAgLy8gICAgICAgaXRlbXM6IFtpdGVtXSxcbiAgICAvLyAgICAgICB0eXBlOiB0eXBcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfVxuICAgIC8vIH1cbiAgICAvLyBwdWJsaWMgY3JlYXRlRGlzcGxheUl0ZW1zKGl0ZW1zOiBJTm9kZVtdLCB0eXA/OiBzdHJpbmcpOiBBY3Rpb24ge1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgdHlwZTogQ1JFQVRFX0RJU1BMQVlfSVRFTVMsXG4gICAgLy8gICAgIHBheWxvYWQ6IHtcbiAgICAvLyAgICAgICBpdGVtczogaXRlbXMsXG4gICAgLy8gICAgICAgdHlwZTogdHlwXG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH1cbiAgICAvLyB9XG4gICAgLy8gcHVibGljIGRlbGV0ZUl0ZW0oaXRlbTogSU5vZGUpOiBBY3Rpb24ge1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgdHlwZTogREVMRVRFX0lURU1TLFxuICAgIC8vICAgICBwYXlsb2FkOiBbaXRlbV1cbiAgICAvLyAgIH1cbiAgICAvLyB9XG4gICAgLy8gcHVibGljIGNsZWFyVHlwZXMoKTogQWN0aW9uIHtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHR5cGU6IENMRUFSX1RZUEVTLFxuICAgIC8vICAgICBwYXlsb2FkOiB1bmRlZmluZWRcbiAgICAvLyAgIH1cbiAgICAvLyB9XG4gICAgLy8gcHVibGljIHNldE9yZGVyZWRUeXBlcyh0eXBlczogVHJlZU5vZGVbXSk6IEFjdGlvbiB7XG4gICAgLy8gICByZXR1cm4ge1xuICAgIC8vICAgICB0eXBlOiBTRVRfT1JERVJFRF9UWVBFUyxcbiAgICAvLyAgICAgcGF5bG9hZDogdHlwZXNcbiAgICAvLyAgIH1cbiAgICAvLyB9XG4gICAgLy8gcHVibGljIGNyZWF0ZVR5cGUobGFiZWw6IHN0cmluZyk6IEFjdGlvbiB7XG4gICAgLy8gICByZXR1cm4ge1xuICAgIC8vICAgICB0eXBlOiBDUkVBVEVfVFlQRSxcbiAgICAvLyAgICAgcGF5bG9hZDogbGFiZWxcbiAgICAvLyAgIH1cbiAgICAvLyB9XG4gICAgLy8gUmVkdWNlcnNcbiAgICBGaWJyYVNlcnZpY2UucHJvdG90eXBlLml0ZW1SZWR1Y2VyID0gZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcbiAgICAgICAgaWYgKHN0YXRlID09PSB2b2lkIDApIHsgc3RhdGUgPSBJTklUSUFMX1NUQVRFOyB9XG4gICAgICAgIGlmIChhY3Rpb24gPT09IHZvaWQgMCkgeyBhY3Rpb24gPSBERUZBVUxUX0FDVElPTjsgfVxuICAgICAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgICAgICAvLyBjYXNlIERJU1BMQVlfSVRFTVM6XG4gICAgICAgICAgICAvLyAgIGFjdGlvbi5wYXlsb2FkLml0ZW1zLmZvckVhY2goKGl0ZW0sIGkpID0+IHtcbiAgICAgICAgICAgIC8vICAgICBpZighc3RhdGUuY29uc3RydWN0Lml0ZW1JbmRleFtpdGVtLnZhbHVlXSkge1xuICAgICAgICAgICAgLy8gICAgICAgc3RhdGUuY29uc3RydWN0Lml0ZW1zLnB1c2goaXRlbSlcbiAgICAgICAgICAgIC8vICAgICAgIHN0YXRlLmNvbnN0cnVjdC5pdGVtSW5kZXhbaXRlbS52YWx1ZV0gPSBpdGVtXG4gICAgICAgICAgICAvLyAgICAgICAvLyBJZiBjb29yZGluYXRlcyBhcmUgcHJvdmlkZWQsIGFwcGx5IHRoZW1cbiAgICAgICAgICAgIC8vICAgICAgIGlmKGFjdGlvbi5wYXlsb2FkLmNvb3JkaW5hdGVzICYmIGFjdGlvbi5wYXlsb2FkLmNvb3JkaW5hdGVzW2ldICYmIGFjdGlvbi5wYXlsb2FkLmNvb3JkaW5hdGVzW2ldWzBdICYmIGFjdGlvbi5wYXlsb2FkLmNvb3JkaW5hdGVzW2ldWzFdKSB7XG4gICAgICAgICAgICAvLyAgICAgICAgIHN0YXRlLmNvbnN0cnVjdC5pdGVtSW5kZXhbaXRlbS52YWx1ZV0ueCA9IGFjdGlvbi5wYXlsb2FkLmNvb3JkaW5hdGVzW2ldWzBdXG4gICAgICAgICAgICAvLyAgICAgICAgIHN0YXRlLmNvbnN0cnVjdC5pdGVtSW5kZXhbaXRlbS52YWx1ZV0ueSA9IGFjdGlvbi5wYXlsb2FkLmNvb3JkaW5hdGVzW2ldWzFdXG4gICAgICAgICAgICAvLyAgICAgICB9XG4gICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgLy8gICB9KVxuICAgICAgICAgICAgLy8gICB0aGlzLmRpc3BhdGNoKCdjaGFuZ2UnKVxuICAgICAgICAgICAgLy8gICByZXR1cm4gdGhpcy4kcS5yZXNvbHZlKHN0YXRlKVxuICAgICAgICAgICAgLy8gY2FzZSBISURFX0lURU06XG4gICAgICAgICAgICAvLyAgIGxldCBpdCA9IHN0YXRlLmNvbnN0cnVjdC5pdGVtSW5kZXhbYWN0aW9uLnBheWxvYWQudmFsdWVdXG4gICAgICAgICAgICAvLyAgIGlmKGl0KSB7XG4gICAgICAgICAgICAvLyAgICAgc3RhdGUuY29uc3RydWN0Lml0ZW1zLnNwbGljZShzdGF0ZS5jb25zdHJ1Y3QuaXRlbXMuaW5kZXhPZihpdCksIDEpXG4gICAgICAgICAgICAvLyAgICAgZGVsZXRlIHN0YXRlLmNvbnN0cnVjdC5pdGVtSW5kZXhbYWN0aW9uLnBheWxvYWQudmFsdWVdXG4gICAgICAgICAgICAvLyAgIH1cbiAgICAgICAgICAgIC8vICAgdGhpcy5kaXNwYXRjaCgnY2hhbmdlJylcbiAgICAgICAgICAgIC8vICAgcmV0dXJuIHRoaXMuJHEucmVzb2x2ZShzdGF0ZSlcbiAgICAgICAgICAgIC8vIGNhc2UgQ1JFQVRFX0xPQ0FMX0lURU06XG4gICAgICAgICAgICAvLyAgIGxldCBpdGVtOiBJR3JpZE5vZGUgPSBhY3Rpb24ucGF5bG9hZFxuICAgICAgICAgICAgLy8gICBzdGF0ZS5jb25zdHJ1Y3QubG9jYWxJdGVtcy5wdXNoKGl0ZW0pXG4gICAgICAgICAgICAvLyAgIHJldHVybiB0aGlzLiRxLnJlc29sdmUoc3RhdGUpXG4gICAgICAgICAgICAvLyBjYXNlIENSRUFURV9JVEVNUzpcbiAgICAgICAgICAgIC8vICAgcmV0dXJuIHRoaXMuY3JlYXRlSXRlbXNJbnRlcm5hbChhY3Rpb24sIHN0YXRlKS50aGVuKChub2RlcykgPT4ge1xuICAgICAgICAgICAgLy8gICAgIHJldHVybiBzdGF0ZVxuICAgICAgICAgICAgLy8gICB9KVxuICAgICAgICAgICAgLy8gY2FzZSBDUkVBVEVfRElTUExBWV9JVEVNUzpcbiAgICAgICAgICAgIC8vICAgcmV0dXJuIHRoaXMuY3JlYXRlSXRlbXNJbnRlcm5hbChhY3Rpb24sIHN0YXRlKS50aGVuKChub2RlcykgPT4ge1xuICAgICAgICAgICAgLy8gICAgIHJldHVybiB0aGlzLmRpc3BhdGNoQWN0aW9uKHRoaXMuZGlzcGxheUl0ZW1zKG5vZGVzKSlcbiAgICAgICAgICAgIC8vICAgfSlcbiAgICAgICAgICAgIC8vIGNhc2UgREVMRVRFX0lURU1TOlxuICAgICAgICAgICAgLy8gICByZXR1cm4gdGhpcy4kcS5hbGwoYWN0aW9uLnBheWxvYWQubWFwKChpdGVtOiBJTm9kZSkgPT4ge1xuICAgICAgICAgICAgLy8gICAgIHJldHVybiB0aGlzLnNwYXJxbEl0ZW1TZXJ2aWNlLmRlbGV0ZUl0ZW0oaXRlbSlcbiAgICAgICAgICAgIC8vICAgfSkpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy8gICAgIHRoaXMuZGlzcGF0Y2goJ2NoYW5nZScpXG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuIHRoaXMuc3RhdGVcbiAgICAgICAgICAgIC8vICAgfSlcbiAgICAgICAgICAgIC8vIGNhc2UgSVRFTV9QUk9QRVJUSUVTOlxuICAgICAgICAgICAgLy8gICByZXR1cm4gdGhpcy5zcGFycWxJdGVtU2VydmljZS5hbHRlckl0ZW0oYWN0aW9uLnBheWxvYWQuaXRlbSwgYWN0aW9uLnBheWxvYWQucHJvcGVydGllc1RvQWRkLCBhY3Rpb24ucGF5bG9hZC5wcm9wZXJ0aWVzVG9SZW1vdmUpLnRoZW4oKHN0cikgPT4ge1xuICAgICAgICAgICAgLy8gICAgIHJldHVybiB0aGlzLnN0YXRlXG4gICAgICAgICAgICAvLyAgIH0pXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRxLnJlc29sdmUoc3RhdGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWJyYVNlcnZpY2UucHJvdG90eXBlLnNlc3Npb25SZWR1Y2VyID0gZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcbiAgICAgICAgaWYgKHN0YXRlID09PSB2b2lkIDApIHsgc3RhdGUgPSBJTklUSUFMX1NUQVRFOyB9XG4gICAgICAgIGlmIChhY3Rpb24gPT09IHZvaWQgMCkgeyBhY3Rpb24gPSBERUZBVUxUX0FDVElPTjsgfVxuICAgICAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFNFVF9MQU5HVUFHRTpcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYW5ndWFnZSA9IGFjdGlvbi5wYXlsb2FkO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRxLnJlc29sdmUoc3RhdGUpO1xuICAgICAgICAgICAgY2FzZSBTRVRfUFJPSkVDVDpcbiAgICAgICAgICAgICAgICBzdGF0ZS5wcm9qZWN0ID0gYWN0aW9uLnBheWxvYWQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEucmVzb2x2ZShzdGF0ZSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRxLnJlc29sdmUoc3RhdGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWJyYVNlcnZpY2UucHJvdG90eXBlLmNvbnN0cnVjdFJlZHVjZXIgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuICAgICAgICBpZiAoc3RhdGUgPT09IHZvaWQgMCkgeyBzdGF0ZSA9IElOSVRJQUxfU1RBVEU7IH1cbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gdm9pZCAwKSB7IGFjdGlvbiA9IERFRkFVTFRfQUNUSU9OOyB9XG4gICAgICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgUExBQ0VIT0xERVI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbi5wYXlsb2FkLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjYXNlIENMRUFSX1RZUEVTOlxuICAgICAgICAgICAgLy8gICBzdGF0ZS5jb25zdHJ1Y3QudHlwZXMgPSBbXVxuICAgICAgICAgICAgLy8gICByZXR1cm4gdGhpcy4kcS5yZXNvbHZlKHN0YXRlKVxuICAgICAgICAgICAgLy8gY2FzZSBTRVRfT1JERVJFRF9UWVBFUzpcbiAgICAgICAgICAgIC8vICAgc3RhdGUuY29uc3RydWN0LmRpc3BsYXlUeXBlcyA9IGFjdGlvbi5wYXlsb2FkXG4gICAgICAgICAgICAvLyAgIHJldHVybiB0aGlzLiRxLnJlc29sdmUoc3RhdGUpXG4gICAgICAgICAgICAvLyBjYXNlIENSRUFURV9UWVBFOlxuICAgICAgICAgICAgLy8gICByZXR1cm4gdGhpcy5zcGFycWxJdGVtU2VydmljZS5jcmVhdGVOZXdJdGVtKFtuZXcgUHJvcGVydHlBbmRWYWx1ZShTS09TLnByZWZMYWJlbCwgRGF0YUZhY3RvcnkuaW5zdGFuY2UubGl0ZXJhbChhY3Rpb24ucGF5bG9hZCkpLCBuZXcgUHJvcGVydHlBbmRWYWx1ZShSREYudHlwZSwgT1dMLkNsYXNzKV0pLnRoZW4oKG5vZGUpID0+IHtcbiAgICAgICAgICAgIC8vICAgICBsZXQgdG46IFRyZWVOb2RlID0gbmV3IFRyZWVOb2RlKG5vZGUudmFsdWUsIGFjdGlvbi5wYXlsb2FkKVxuICAgICAgICAgICAgLy8gICAgIHRoaXMuc3RhdGUuY29uc3RydWN0LnVzZXJUeXBlcy5wdXNoKHRuKVxuICAgICAgICAgICAgLy8gICAgIHJldHVybiB0aGlzLnN0YXRlXG4gICAgICAgICAgICAvLyAgIH0pXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRxLnJlc29sdmUoc3RhdGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvLyBwcml2YXRlIGNyZWF0ZUl0ZW1zSW50ZXJuYWwoYWN0aW9uLCBzdGF0ZSk6IGFuZ3VsYXIuSVByb21pc2U8SU5vZGVbXT4ge1xuICAgIC8vICAgbGV0IGl0ZW1zOiBJdGVtW10gPSBhY3Rpb24ucGF5bG9hZC5pdGVtc1xuICAgIC8vICAgbGV0IHR5cGVOb2RlOiBJTmFtZWROb2RlID0gYWN0aW9uLnBheWxvYWQudHlwZSA/IERhdGFGYWN0b3J5Lmluc3RhbmNlLm5hbWVkTm9kZShhY3Rpb24ucGF5bG9hZC50eXBlKSA6IE9XTC5UaGluZ1xuICAgIC8vICAgaWYgKGl0ZW1zWzBdKSB7XG4gICAgLy8gICAgIGxldCBwcm9tcyA9IGl0ZW1zLm1hcCgobm9kZSkgPT4ge1xuICAgIC8vICAgICAgIGlmIChub2RlLnZhbHVlKSB7XG4gICAgLy8gICAgICAgICByZXR1cm4gdGhpcy5zcGFycWxJdGVtU2VydmljZS5jcmVhdGVOZXdJdGVtKFtuZXcgUHJvcGVydHlBbmRWYWx1ZShTS09TLnByZWZMYWJlbCwgRGF0YUZhY3RvcnkuaW5zdGFuY2UubGl0ZXJhbChub2RlLnZhbHVlKSksIG5ldyBQcm9wZXJ0eUFuZFZhbHVlKFJERi50eXBlLCB0eXBlTm9kZSldKVxuICAgIC8vICAgICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICByZXR1cm4gdGhpcy5zcGFycWxJdGVtU2VydmljZS5jcmVhdGVOZXdJdGVtKFtuZXcgUHJvcGVydHlBbmRWYWx1ZShSREYudHlwZSwgdHlwZU5vZGUpXSlcbiAgICAvLyAgICAgICB9XG4gICAgLy8gICAgICAgLy8gcmV0dXJuIHRoaXMuc3BhcnFsSXRlbVNlcnZpY2UuZ2V0SXRlbShub2RlKS50aGVuKChpdGVtKSA9PiB7XG4gICAgLy8gICAgICAgLy8gICBsZXQgcHJlZkxhYmVsUHJvcCA9IGl0ZW0ubG9jYWxQcm9wZXJ0aWVzLmNvbmNhdChpdGVtLnJlbW90ZVByb3BlcnRpZXMpLmZpbHRlcigocHIpID0+IHtcbiAgICAvLyAgICAgICAvLyAgICAgcmV0dXJuIHByLnZhbHVlID09PSAnaHR0cDovL3d3dy53My5vcmcvMjAwNC8wMi9za29zL2NvcmUjcHJlZkxhYmVsJ1xuICAgIC8vICAgICAgIC8vICAgfSlcbiAgICAvLyAgICAgICAvLyAgIGxldCB0eXBlOiBQcm9wZXJ0eVRvVmFsdWVzPElOb2RlPiA9IG5ldyBQcm9wZXJ0eVRvVmFsdWVzKFJERi50eXBlKVxuICAgIC8vICAgICAgIC8vICAgbGV0IHR5cGVQcm9wID0gaXRlbS5sb2NhbFByb3BlcnRpZXMuY29uY2F0KGl0ZW0ucmVtb3RlUHJvcGVydGllcykuZmlsdGVyKChwcikgPT4ge1xuICAgIC8vICAgICAgIC8vICAgICByZXR1cm4gcHIudmFsdWUgPT09ICdodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjdHlwZSdcbiAgICAvLyAgICAgICAvLyAgIH0pXG4gICAgLy8gICAgICAgLy8gICBpZih0eXBlUHJvcFswXSkge1xuICAgIC8vICAgICAgIC8vICAgICBsZXQgdHlwZVdpdGhMYWJlbDogSU5vZGVQbHVzTGFiZWwgPSBuZXcgU291cmNlZE5vZGVQbHVzTGFiZWwodHlwZVByb3BbMF0pXG4gICAgLy8gICAgICAgLy8gICAgIHR5cGUudmFsdWVzLnB1c2godHlwZVdpdGhMYWJlbClcbiAgICAvLyAgICAgICAvLyAgIH1cbiAgICAvLyAgICAgICAvLyAgIHJldHVybiB0aGlzLnNwYXJxbEl0ZW1TZXJ2aWNlLmNyZWF0ZU5ld0l0ZW0oW2l0ZW1dLCBbdHlwZSwgcHJlZkxhYmVsUHJvcFswXV0pXG4gICAgLy8gICAgICAgLy8gfSkudGhlbigobm9kZSkgPT4ge1xuICAgIC8vICAgICAgIC8vICAgLy8gRGlzcGxheSB0aGUgaXRlbVxuICAgIC8vICAgICAgIC8vICAgcmV0dXJuIHRoaXMuZGlzcGF0Y2hBY3Rpb24odGhpcy5kaXNwbGF5SXRlbShub2RlKSlcbiAgICAvLyAgICAgICAvLyB9KVxuICAgIC8vICAgICB9KVxuICAgIC8vICAgICByZXR1cm4gdGhpcy4kcS5hbGwocHJvbXMpXG4gICAgLy8gICB9IGVsc2Uge1xuICAgIC8vICAgICByZXR1cm4gdGhpcy5zcGFycWxJdGVtU2VydmljZS5jcmVhdGVOZXdJdGVtKFtuZXcgUHJvcGVydHlBbmRWYWx1ZShSREYudHlwZSwgdHlwZU5vZGUpLCBuZXcgUHJvcGVydHlBbmRWYWx1ZShTS09TLnByZWZMYWJlbCwgRGF0YUZhY3RvcnkuaW5zdGFuY2UubGl0ZXJhbCgnJykpXSkudGhlbigobm9kZSkgPT4ge1xuICAgIC8vICAgICAgIHJldHVybiBbbm9kZV1cbiAgICAvLyAgICAgfSlcbiAgICAvLyAgIH1cbiAgICAvLyB9XG4gICAgLy8gUHVibGljIEFQSVxuICAgIEZpYnJhU2VydmljZS5wcm90b3R5cGUuZGlzcGF0Y2hBY3Rpb24gPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3RhdGUuYWN0aW9uc1J1bm5pbmcgPSB0aGlzLnN0YXRlLmFjdGlvbnNSdW5uaW5nICsgMTtcbiAgICAgICAgY29uc29sZS5sb2coYWN0aW9uLnR5cGUsIHRoaXMuc3RhdGUuYWN0aW9uc1J1bm5pbmcpO1xuICAgICAgICB0aGlzLmRpc3BhdGNoKCdhY3Rpb24nKTtcbiAgICAgICAgdmFyIG9sZENvbW1vblN0YXRlID0gdGhpcy5zdGF0ZS50b0NvbW1vblN0YXRlKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdFJlZHVjZXIodGhpcy5zdGF0ZSwgYWN0aW9uKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHN0YXRlKSB7IHJldHVybiBfdGhpcy5pdGVtUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTsgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChzdGF0ZSkgeyByZXR1cm4gX3RoaXMuc2Vzc2lvblJlZHVjZXIoc3RhdGUsIGFjdGlvbik7IH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgICAgIGlmIChzdGF0ZS5sYW5ndWFnZSAhPT0gb2xkQ29tbW9uU3RhdGUubGFuZ3VhZ2UgfHwgc3RhdGUucHJvamVjdCAhPT0gb2xkQ29tbW9uU3RhdGUucHJvamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciB3c3RhdGUgPSBzdGF0ZS50b0NvbW1vblN0YXRlKCk7XG4gICAgICAgICAgICAgICAgV29ya2VyU2VydmljZS5zYXZlUHJvdG90eXBlcyh3c3RhdGUpO1xuICAgICAgICAgICAgICAgIF90aGlzLndvcmtlclNlcnZpY2UuY2FsbEFsbCgnc3RhdGVXb3JrZXJTZXJ2aWNlJywgJ3NldFN0YXRlJywgW3dzdGF0ZV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgICAgIF90aGlzLnN0YXRlLmFjdGlvbnNSdW5uaW5nID0gX3RoaXMuc3RhdGUuYWN0aW9uc1J1bm5pbmcgLSAxO1xuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEZpYnJhU2VydmljZS5wcm90b3R5cGUuZ2V0U3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRlO1xuICAgIH07XG4gICAgRmlicmFTZXJ2aWNlLnByb3RvdHlwZS51bmRvID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgcmV0dXJuIEZpYnJhU2VydmljZTtcbn0oKSk7XG5leHBvcnQgeyBGaWJyYVNlcnZpY2UgfTtcbmFuZ3VsYXIubW9kdWxlKCdmaWJyYS5zZXJ2aWNlcy5maWJyYS1zZXJ2aWNlJywgW10pXG4gICAgLmNvbmZpZyhmdW5jdGlvbiAoJHByb3ZpZGUpIHtcbiAgICAkcHJvdmlkZS5zZXJ2aWNlKCdmaWJyYVNlcnZpY2UnLCBGaWJyYVNlcnZpY2UpO1xufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXBwL3NlcnZpY2VzL2ZpYnJhLXNlcnZpY2UudHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEvQ0E7QUFpREE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBVUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbEJBO0FBb0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ })

})